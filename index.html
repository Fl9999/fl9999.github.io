<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222" media="(prefers-color-scheme: light)">
<meta name="theme-color" content="#222" media="(prefers-color-scheme: dark)"><meta name="generator" content="Hexo 6.2.0">

  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="css/main.css">



<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.2.1/css/all.min.css" integrity="sha256-Z1K5uhUaJXA7Ll0XrZ/0JhX4lAtZFpT6jkKrEDT0drU=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pace/1.2.4/themes/blue/pace-theme-minimal.css">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/pace/1.2.4/pace.min.js" integrity="sha256-gqd7YTjg/BtfqWSwsJOvndl0Bxc8gFImLEkXQT8+qj0=" crossorigin="anonymous"></script>

<script class="next-config" data-name="main" type="application/json">{"hostname":"csms.tech","root":"/","images":"images","scheme":"Gemini","darkmode":true,"version":"8.14.2","exturl":false,"sidebar":{"position":"left","display":"always","padding":18,"offset":12},"copycode":{"enable":true,"style":null},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":"gitalk","storage":true,"lazyload":true,"nav":null,"activeClass":"gitalk"},"stickytabs":false,"motion":{"enable":true,"async":true,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeIn","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"搜索...","empty":"没有找到任何搜索结果：${query}","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","hits":"找到 ${hits} 个搜索结果"},"path":"search.xml","localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false}}</script><script src="js/config.js"></script>

    <meta name="description" content="得 能 莫 忘">
<meta property="og:type" content="website">
<meta property="og:title" content="L B T">
<meta property="og:url" content="http://csms.tech/index.html">
<meta property="og:site_name" content="L B T">
<meta property="og:description" content="得 能 莫 忘">
<meta property="og:locale" content="zh_CN">
<meta property="article:author" content="COSMOS">
<meta property="article:tag" content="博客, 记录，技术">
<meta name="twitter:card" content="summary">


<link rel="canonical" href="http://csms.tech/">



<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":true,"isPost":false,"lang":"zh-CN","comments":"","permalink":"","path":"index.html","title":""}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>L B T</title>
  








  <noscript>
    <link rel="stylesheet" href="css/noscript.css">
  </noscript>
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <div class="column">
      <header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <h1 class="site-title">L B T</h1>
      <i class="logo-line"></i>
    </a>
      <p class="site-subtitle" itemprop="description">记 录 过 去 的 经 验</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger" aria-label="搜索" role="button">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="index.html" rel="section"><i class="fa fa-earth-americas fa-fw"></i>首页</a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-folder-tree fa-fw"></i>总目录<span class="badge">49</span></a></li><li class="menu-item menu-item-linux"><a href="/categories/Linux" rel="section"><i class="fa fa-brands fa-linux fa-fw"></i>Linux</a></li><li class="menu-item menu-item-python"><a href="/categories/Python" rel="section"><i class="fa fa-brands fa-python fa-fw"></i>Python</a></li><li class="menu-item menu-item-docker"><a href="/categories/Docker" rel="section"><i class="fa fa-brands fa-docker fa-fw"></i>Docker</a></li><li class="menu-item menu-item-kubernetes"><a href="/categories/Kubernetes" rel="section"><i class="fa fa-dharmachakra fa-fw"></i>Kubernetes</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tornado fa-fw"></i>标签<span class="badge">78</span></a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-rectangle-list fa-fw"></i>列表<span class="badge">240</span></a></li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup"><div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off" maxlength="80"
           placeholder="搜索..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close" role="button">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div class="search-result-container no-result">
  <div class="search-result-icon">
    <i class="fa fa-spinner fa-pulse fa-5x"></i>
  </div>
</div>

    </div>
  </div>

</header>
        
  
  <aside class="sidebar">

    <div class="sidebar-inner sidebar-overview-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          文章总目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">COSMOS</p>
  <div class="site-description" itemprop="description">得 能 莫 忘</div>
</div>
<div class="site-state-wrap animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">240</span>
          <span class="site-state-item-name">文章</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
          <a href="/categories/">
        <span class="site-state-item-count">49</span>
        <span class="site-state-item-name">目录</span></a>
      </div>
      <div class="site-state-item site-state-tags">
          <a href="/tags/">
        <span class="site-state-item-count">78</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>

        </div>
      </div>
        <div class="back-to-top animated" role="button" aria-label="返回顶部">
          <i class="fa fa-arrow-up"></i>
          <span>0%</span>
        </div>
    </div>

    
  </aside>


    </div>

    <div class="main-inner index posts-expand">

    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://csms.tech/20241028135437/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="images/avatar.gif">
      <meta itemprop="name" content="COSMOS">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="L B T">
      <meta itemprop="description" content="得 能 莫 忘">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | L B T">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="20241028135437/" class="post-title-link" itemprop="url">linux modules 及 library 相关操作</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2024-10-28 13:10:00" itemprop="dateCreated datePublished" datetime="2024-10-28T13:10:00+08:00">2024-10-28</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">上层目录</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="categories/Linux/" itemprop="url" rel="index"><span itemprop="name">Linux</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css"><h1 id="检查命令依赖的共享库"><a href="#检查命令依赖的共享库" class="headerlink" title="检查命令依赖的共享库"></a>检查命令依赖的共享库</h1><p>以下命令检查 <code>crontab</code> 命令依赖的共享库</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">ldd `<span class="built_in">which</span> crontab`</span></span><br><span class="line">	linux-vdso.so.1 (0x00007ffe2db17000)</span><br><span class="line">	libc.so.6 =&gt; /lib/x86_64-linux-gnu/libc.so.6 (0x00007063f4c00000)</span><br><span class="line">	/lib64/ld-linux-x86-64.so.2 (0x00007063f4fc3000)</span><br><span class="line"></span><br></pre></td></tr></table></figure>
      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://csms.tech/20241028140006/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="images/avatar.gif">
      <meta itemprop="name" content="COSMOS">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="L B T">
      <meta itemprop="description" content="得 能 莫 忘">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | L B T">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="20241028140006/" class="post-title-link" itemprop="url">Linux PAM</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2024-10-28 13:10:00" itemprop="dateCreated datePublished" datetime="2024-10-28T13:10:00+08:00">2024-10-28</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">上层目录</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="categories/Linux/" itemprop="url" rel="index"><span itemprop="name">Linux</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>PAM（Pluggable Authentication Modules） 由 Sun Microsystems 发明并最初在 Solarise OS 上实现，Linux 于 1997 年实现了 Linux-PAM.</p>
<p>PAM 简化了系统认证管理的过程，使用 PAM 提供了以下好处：</p>
<ul>
<li>使用中心化的方式简化了用户身份认证过程以及系统管理员的视角</li>
<li>简化了应用在认证相关功能方面的开发，开发者无需重复写认证相关代码，只需要直接使用已有的认证模块即可</li>
<li>认证灵活性<ul>
<li>可以根据用户身份或者是特定的时间，或者是对特定资源的使用进行允许&#x2F;拒绝操作</li>
</ul>
</li>
</ul>
<p><strong>包含 PAM 的应用中 PAM 使用流程大体如下</strong> ：</p>
<ul>
<li>一个主体（用户或者进程）请求访问（通过认证）一个应用</li>
<li>此应用读取其 PAM 配置文件，其 PAM 配置文件中配置了认证策略，认证策略中一般包含要进行认证的 PAM 模块的列表，这个列表也称为 <em>Stack</em></li>
<li>Stack 中配置的 PAM 模块被依次调用</li>
<li>每个 PAM 模块会根据其配置返回 <strong>成功（Success）</strong> 或者 <strong>失败（Failure）</strong> 状态</li>
<li>最后是否认证成功，由所有的 PAM 模块返回的结果组合得到 <strong>成功（Success）</strong> 或者 <strong>失败（Failure）</strong> ，具体组合方式取决于配置文件中的配置。</li>
</ul>
<p>Linux 中，大多数包含 PAM 的应用的配置文件位于 <code>/etc/pam.d/</code>，通用的 PAM 配置文件格式使用：</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">context &#x27;control flag&#x27; &#x27;PAM module&#x27; [module options]</span><br></pre></td></tr></table></figure>

<p>Linux 中，系统安全（如资源限制，用户登陆等）相关的 PAM 配置文件位于 <code>/etc/security/*.conf</code></p>
<h1 id="PAM-Contexts"><a href="#PAM-Contexts" class="headerlink" title="PAM Contexts"></a>PAM Contexts</h1><p>PAM 模块为不同的认证服务提供了标准的函数，这些 PAM 模块中的标准函数根据其函数类型称为 <code>Contexts</code>，也可以叫做 <code>Module Interfaces</code> 或者 <code>Types</code>，下列出了不同的 PAM Contexts 及其对应的 认证服务（Authentication Service）</p>
<table>
<thead>
<tr>
<th>Context</th>
<th>Service Description</th>
</tr>
</thead>
<tbody><tr>
<td><code>auth</code></td>
<td>提供认证管理服务（Authentication Management Services），如验证帐号密码</td>
</tr>
<tr>
<td><code>account</code></td>
<td>帐号验证服务（Account Validation Services），例如只允许特定时间登陆</td>
</tr>
<tr>
<td><code>password</code></td>
<td>管理帐号密码（Manages Account Passwords），如限制帐号密码长度</td>
</tr>
</tbody></table>
<h1 id="PAM-Control-Flags"><a href="#PAM-Control-Flags" class="headerlink" title="PAM Control Flags"></a>PAM Control Flags</h1><p>PAM 中的 Control Flags 用于决定返回什么样的状态。下表列出了 PAM 配置中的相关的 Control Flags 及其响应</p>
<table>
<thead>
<tr>
<th>Control Flag</th>
<th>Response Handle</th>
</tr>
</thead>
<tbody><tr>
<td><code>required</code></td>
<td>If failed, returns a failure status to the application, after the rest of the contexts have been run in the stack.<br/>For example, a <code>requisite control</code> might cause a login to fail if someone types in an invalid user. But the user might not be told of the failure until after entering a password, hiding the fact that it was the bad username that caused the failure</td>
</tr>
<tr>
<td><code>requisite</code></td>
<td>If failed, returns a failure status to the application immediately <strong>without running the rest of the stack</strong> 。 <strong>(Be careful where you place this control in the stack.)</strong> <br/> For example, a <code>requisite control</code> might require key-based authentication and <strong>fail immediately when a valid key is not provided</strong> . In that case, it could fail before even prompting for a username&#x2F;password.</td>
</tr>
<tr>
<td><code>sufficient</code></td>
<td>- If failed, the module status is ignored. <br/> - If successful, then a success status is immediately returned to the application without running the rest of the stack.<br/> <strong>(Be careful where you place this control in the stack.)</strong></td>
</tr>
<tr>
<td><code>optional</code></td>
<td><strong>This control flag is important only for the final overall return status of success or failure</strong> . Think of it as a tiebreaker. When the other modules in the configuration file stack return statuses that are neither clear-cut failure nor success statuses, this optional module’s status is used to determine the final status or break the tie. In cases where the other modules in the stack are returning a clear-cut path of failure or success, this status is ignored.</td>
</tr>
<tr>
<td><code>include</code></td>
<td>Get all the return statuses from this particular PAM configuration file’s stack to include in this stack’s overall return status. It’s as if the entire stack from the named configuration file is now in this configuration file</td>
</tr>
<tr>
<td><code>substack</code></td>
<td>Similar to the include control flag, except for how certain errors and evaluations affect the main stack. This forces the included configuration file stack to act as a substack to the main stack. Thus, certain errors and evaluations affect only the substack and not the main stack.</td>
</tr>
</tbody></table>
<h1 id="PAM-Modules"><a href="#PAM-Modules" class="headerlink" title="PAM Modules"></a>PAM Modules</h1><p>Linux 中，PAM Modules 其实是系统共享库（Shared Library Module）文件，RHEL 默认位于 <code> /usr/lib64/security/pam*.so</code>， Ubuntu 位于 <code>/usr/lib/x86_64-linux-gnu/security/pam*.so</code></p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="built_in">ls</span> /usr/lib/x86_64-linux-gnu/security/</span></span><br><span class="line">pam_access.so           pam_exec.so        pam_gdm.so            pam_listfile.so   pam_nologin.so           pam_securetty.so  pam_stress.so      pam_unix.so</span><br><span class="line">pam_cap.so              pam_extrausers.so  pam_gnome_keyring.so  pam_localuser.so  pam_oddjob_mkhomedir.so  pam_selinux.so    pam_succeed_if.so  pam_userdb.so</span><br><span class="line">pam_dcvgraphicalsso.so  pam_faildelay.so   pam_group.so          pam_loginuid.so   pam_permit.so            pam_sepermit.so   pam_systemd.so     pam_usertype.so</span><br><span class="line">pam_debug.so            pam_faillock.so    pam_issue.so          pam_mail.so       pam_pwhistory.so         pam_setquota.so   pam_time.so        pam_warn.so</span><br><span class="line">pam_deny.so             pam_filter.so      pam_keyinit.so        pam_mkhomedir.so  pam_pwquality.so         pam_shells.so     pam_timestamp.so   pam_wheel.so</span><br><span class="line">pam_echo.so             pam_fprintd.so     pam_lastlog.so        pam_motd.so       pam_rhosts.so            pam_sss_gss.so    pam_tty_audit.so   pam_xauth.so</span><br><span class="line">pam_env.so              pam_ftp.so         pam_limits.so         pam_namespace.so  pam_rootok.so            pam_sss.so        pam_umask.so</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>要查看 PAM Module 的帮助文档，可以使用 <code>man</code> 手册，如 <code>man pam_access</code>。</p>
<p>使用 PAM 的应用可以大概分为以下 2 类：</p>
<ul>
<li><p><strong>普通程序（Application）</strong> 。默认使用 PAM 的应用的配置位于 <code>/etc/pam.d</code>，每个使用 PAM Module 的应用程序都应该有其自己的配置文件来定义它如何使用 PAM 模块。如果没有，这将是一个漏洞，为了防止这种情况出现，系统内置了一个 <code>other</code> 的配置（<code>/etc/pam.d/other</code>），所有使用了 PAM 但是没有指定其配置文件的应用都将使用此配置。 <strong><code>other</code> 配置默认拒绝（Implicit Deny）所有的请求</strong></p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="built_in">ls</span> /etc/pam.d/</span></span><br><span class="line">chfn            common-auth                    cron               gdm-autologin           gdm-smartcard                   login     polkit-1   samba             sudo</span><br><span class="line">chpasswd        common-password                cups               gdm-fingerprint         gdm-smartcard-pkcs11-exclusive  newusers  ppp        sshd              sudo-i</span><br><span class="line">chsh            common-session                 dcv                gdm-launch-environment  gdm-smartcard-sssd-exclusive    other     runuser    sssd-shadowutils  su-l</span><br><span class="line">common-account  common-session-noninteractive  dcv-graphical-sso  gdm-password            gdm-smartcard-sssd-or-password  passwd    runuser-l  su                vmtoolsd</span><br><span class="line"></span><br></pre></td></tr></table></figure>
</li>
<li><p><strong>系统安全相关程序</strong> 。系统安全相关的 PAM 配置默认位于 <code> /etc/security</code>。</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="built_in">ls</span> /etc/security/</span></span><br><span class="line">access.conf      faillock.conf  limits.conf  namespace.conf  namespace.init  pam_env.conf    sepermit.conf</span><br><span class="line">capability.conf  group.conf     limits.d     namespace.d     opasswd         pwquality.conf  time.conf</span><br><span class="line"></span><br></pre></td></tr></table></figure></li>
</ul>
          <!--noindex-->
            <div class="post-button">
              <a class="btn" href="20241028140006/#more" rel="contents">
                阅读全文 &raquo;
              </a>
            </div>
          <!--/noindex-->
        
      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://csms.tech/20241026144120/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="images/avatar.gif">
      <meta itemprop="name" content="COSMOS">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="L B T">
      <meta itemprop="description" content="得 能 莫 忘">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | L B T">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="20241026144120/" class="post-title-link" itemprop="url">加密</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2024-10-26 13:10:00" itemprop="dateCreated datePublished" datetime="2024-10-26T13:10:00+08:00">2024-10-26</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">上层目录</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="categories/%E5%AE%89%E5%85%A8/" itemprop="url" rel="index"><span itemprop="name">安全</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p><strong>加密解密相关常用概念</strong> ：</p>
<ul>
<li><strong>Plain Text</strong> ： 明文，可以被人类或者激情理解的内容</li>
<li><strong>Ciphertext</strong> ： 密文，加密后的内容，一般不能直接被人类或者机器所理解，需要解密</li>
<li><strong>Encryption</strong> ： 将 <code>Plain Text</code> 转换为 <code>Ciphertext</code> 的过程，通常使用一种加密算法（Encrypt Algorithm）</li>
<li><strong>Decryption</strong>  ： 解密，将 <code>Ciphertext</code> 转换为 <code>Plain Text</code> 的过程，通常使用和加密算法（Encrypt Algorithm）相对应的解密算法（Decrypt Algorithms）</li>
<li><strong>Cipher</strong> ： 加密和解密过程中算法使用的密码。</li>
<li><strong>Block Cipher</strong> ： 在对数据进行加密之前，需要首先将其分割成块（Block）</li>
<li><strong>Stream Cipher</strong> ： 加密过程中无需将其分割成块（Block）</li>
<li><strong>Key</strong> ： 通常值密钥对（公钥&#x2F;私钥）</li>
</ul>
<p>以下是一些较为经典的加密算法</p>
<table>
<thead>
<tr>
<th>Algorithm</th>
<th>Description</th>
<th></th>
</tr>
</thead>
<tbody><tr>
<td><code>AES</code><br/>Advanced Encryption Standard, also called Rijndael</td>
<td>- <strong>Symmetric Cryptography</strong><br/>- <strong>Block Cipher</strong> 。encrypting data in <code>128-</code>, <code>192-</code>, <code>256-</code>, <code>512-</code> bit， blocks using a <code>128-</code>, <code>192-</code>, <code>256</code>, or <code>512</code>-bit key</td>
<td></td>
</tr>
<tr>
<td><code>Blowfish</code></td>
<td>- <strong>Symmetric Cryptography</strong><br/>- <strong>Block Cipher</strong> 。encrypting data in 64-bit blocks using the same 32-bit to 448-bit keys for encrypting&#x2F;decrypting.</td>
<td></td>
</tr>
<tr>
<td><code>CAST5</code></td>
<td>- <strong>Symmetric Cryptography</strong><br/> - <strong>Block Cipher</strong> 。    encrypting data in 64-bit blocks using the same up to 128-bit key for encrypting&#x2F;decrypting.</td>
<td></td>
</tr>
<tr>
<td><code>DES</code><br/>Data Encryption Standard</td>
<td><strong>已经被认为是不安全的<br/></strong> - <strong>Symmetric Cryptography</strong><br/>- <strong>Block Cipher</strong> 。encrypting data in 64-bit blocks using the same 56-bit key for encrypting&#x2F;decrypting.</td>
<td></td>
</tr>
<tr>
<td><code>3DES</code></td>
<td>增强的 DES 加密算法<br/> - <strong>Symmetric Cryptography</strong> <br/> Data is encrypted up to 48 times with three different 56-bit keys before the encryption process is completed.</td>
<td></td>
</tr>
<tr>
<td><code>IDEA</code></td>
<td>- <strong>Symmetric Cryptography</strong> <br/> - <strong>Block Cipher</strong> 。 encrypting data in 64-bit blocks using the same 128-bit key for encrypting&#x2F;decrypting</td>
<td></td>
</tr>
<tr>
<td><code>RC5</code></td>
<td>- <strong>Symmetric Cryptography</strong> <br/>  - <strong>Block Cipher</strong> 。  encrypting data in <code>32-</code>, 64-&#96;&#96;, or <code>128-</code> bit blocks ，using the same up to 2,048-bit keys for encrypting&#x2F;decrypting</td>
<td></td>
</tr>
<tr>
<td><code>RC6</code></td>
<td>- <strong>Symmetric Cryptography</strong> <br/> Same as RC5, but slightly faster</td>
<td></td>
</tr>
<tr>
<td><code>EI Gamal</code></td>
<td>- <strong>Asymmetric Cryptography</strong> <br/>  Uses two keys derived from a logarithm algorithm</td>
<td></td>
</tr>
<tr>
<td><code>Elliptic Curve Cryptosystems</code></td>
<td>- <strong>Asymmetric Cryptography</strong> <br/> Uses two keys derived from an algorithm containing two randomly chosen points on an elliptic curve.</td>
<td></td>
</tr>
<tr>
<td><code>RC4</code> <br/>    also called <code>ArcFour</code> or <code>ARC4</code></td>
<td>- <strong>Stream Cipher</strong> <br/>    encrypting data in 64-bit blocks using a variable key size for encrypting&#x2F;decrypting.</td>
<td></td>
</tr>
<tr>
<td><code>RSA</code></td>
<td><strong>最流行的非对称加密算法，使用 <code>Public/Private Key</code> 进行加解密</strong><br/>- <strong>Asymmetric Cryptography</strong></td>
<td></td>
</tr>
</tbody></table>
          <!--noindex-->
            <div class="post-button">
              <a class="btn" href="20241026144120/#more" rel="contents">
                阅读全文 &raquo;
              </a>
            </div>
          <!--/noindex-->
        
      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://csms.tech/20241026135656/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="images/avatar.gif">
      <meta itemprop="name" content="COSMOS">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="L B T">
      <meta itemprop="description" content="得 能 莫 忘">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | L B T">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="20241026135656/" class="post-title-link" itemprop="url">关于 Hash</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2024-10-26 13:10:00" itemprop="dateCreated datePublished" datetime="2024-10-26T13:10:00+08:00">2024-10-26</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">上层目录</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="categories/%E5%AE%89%E5%85%A8/" itemprop="url" rel="index"><span itemprop="name">安全</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css"><p><strong>Hash 不是加密（Encryption）</strong>，不像 <strong>加密（Encrypt）-解密（decrypt）</strong> ， <strong>对一个对象进行 Hash 操作后，不可能通过 Hash 后的值 dehash 回原来的对象</strong> 。</p>
<p>Hash 算法需要 <strong>Collision Free</strong> ，即对两个完全不同的输入，经过 Hash 算法后的值也必须 <strong>不同</strong> 。</p>
<p>在 Linux 系统中，用户名秘密验证就是使用 Hash 算法。<code>/etc/shadow</code> 中包含的是用户密码（加 Salt） Hash 后的值，而不是用户密码，当用户使用密码登陆系统时，会计算用户密码（加 Salt）的 Hash 值并和 <code>/etc/shadow</code> 中保存的内容进行对比以验证用户密码是否正确。</p>
<p>Hash 在 Linux 系统中，有以下用途：</p>
<ul>
<li>Passwords 验证</li>
<li>校验文件内容</li>
<li>数字签名</li>
<li>病毒签名</li>
</ul>
<p>Hash 也有以下叫法：</p>
<ul>
<li><code>Message Digest</code> ：  消息摘要，Linux 中常用的命令如 <code>md5sum</code>、<code>sha1sum</code>、<code>sha224sum</code>、<code>sha256sum</code>、<code>sha384sum</code>、<code>sha512sum</code>、<code>shasum</code> 等应用了不同的 Hash 算法 </li>
<li><code>Checksum</code> ： 校验和</li>
<li><code>Fingerprint</code>  ： 数字指纹</li>
<li><code>Signature</code>  ： 签名</li>
</ul>
<h1 id="Hash-常见用途示例"><a href="#Hash-常见用途示例" class="headerlink" title="Hash 常见用途示例"></a>Hash 常见用途示例</h1><h2 id="内容完整性校验"><a href="#内容完整性校验" class="headerlink" title="内容完整性校验"></a>内容完整性校验</h2><p>例如网上公开的 ISO 系统镜像，发布者会同时发布镜像的 SHA-256 Hash 算法摘要值，当你下载了此镜像后，可以在本地对其镜像同样的 Hash 计算（如 <code>sha256sum</code> 命令），如果计算出的值和发布者公布的值一致，说明其内容和发布者发布的镜像内容一致（未被篡改）</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="built_in">sha256sum</span> Fedora-Workstation-Live-x86_64-30-1.2.iso</span></span><br><span class="line">a4e2c49368860887f1cc1166b0613232d4d5de6b46f29c9756bc7cfd5e13f39f</span><br><span class="line"> Fedora-Workstation-Live-x86_64-30-1.2.iso</span><br></pre></td></tr></table></figure>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://csms.tech/20241025105226/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="images/avatar.gif">
      <meta itemprop="name" content="COSMOS">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="L B T">
      <meta itemprop="description" content="得 能 莫 忘">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | L B T">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="20241025105226/" class="post-title-link" itemprop="url">Linux auditd 服务</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2024-10-25 10:10:00" itemprop="dateCreated datePublished" datetime="2024-10-25T10:10:00+08:00">2024-10-25</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">上层目录</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="categories/Linux/" itemprop="url" rel="index"><span itemprop="name">Linux</span></a>
        </span>
          ，
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="categories/Linux/%E5%B8%B8%E7%94%A8%E6%9C%8D%E5%8A%A1/" itemprop="url" rel="index"><span itemprop="name">常用服务</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>Linux 审计系统提供了一种方式来跟踪系统上与安全相关的信息。根据预配置的规则，审计会生成日志条目，来尽可能多地记录系统上所发生的事件的相关信息。对于关键任务环境而言至关重要，可用来确定安全策略的违反者及其所执行的操作。审计不会为您的系统提供额外的安全，而是用于发现系统上使用的安全策略的违规。可以通过其他安全措施(如 SELinux)进一步防止这些违规。 <sup id="fnref:1"><a href="#fn:1" rel="footnote"><span class="hint--top hint--error hint--medium hint--rounded hint--bounce" aria-label="[第 7 章 系统审计](https://docs.redhat.com/zh_hans/documentation/red_hat_enterprise_linux/7/html/security_guide/chap-system_auditing#chap-system_auditing) ">[1]</span></a></sup></p>
<p>以下列表总结了审计可以在其日志文件中记录的一些信息：</p>
<ul>
<li>事件的日期、时间、类型和结果.</li>
<li>主题和对象的敏感度标签。</li>
<li>事件与触发事件的用户身份的关联。</li>
<li>对审计配置的所有修改，以及对访问审计日志文件的尝试。</li>
<li>所有身份验证机制的使用，如 SSH 和 Kerberos 等。</li>
<li>对任何受信任数据库的修改，如 &#x2F;etc&#x2F;passwd。</li>
<li>尝试将信息导入系统或从系统导出。</li>
<li>根据用户身份、主题和对象标签以及其他属性包含或排除事件。</li>
</ul>
<p><strong>使用案例</strong></p>
<ul>
<li><strong>监视文件访问</strong><br>  审计可以跟踪文件或目录是否已被访问、修改、执行或者文件的属性是否已改变。例如，这有助于检测对重要文件的访问，并在其中一个文件损坏时提供审计跟踪。</li>
<li><strong>监控系统调用</strong><br>  可将审计配置为在每次使用特定系统调用时生成日志条目。例如，这可用于通过监控 <code>settimeofday</code>、<code>clock_adjtime</code> 和其他与时间相关的系统调用来跟踪对系统时间的修改。</li>
<li><strong>记录用户运行的命令</strong><br>  审计可以跟踪文件是否已被执行，因此可以定义一个规则以记录每次特定命令的执行。例如，可以对 <code>/bin</code> 目录中的每个可执行文件定义一个规则。然后，可以按用户 ID 搜索生成的日志条目，以生成每个用户所执行的命令的审计跟踪。</li>
<li><strong>记录系统路径名称的执行</strong><br>  除了观察在规则调用时将路径转换为 inode 的文件访问之外，审计现在还可以观察路径的执行，即使路径在规则调用中不存在，或者在规则调用后文件被替换了。这允许规则在升级程序可执行文件后或甚至在其安装之前继续运行。</li>
<li><strong>记录安全事件</strong><br>  <code>pam_faillock</code> 认证模块能够记录失败的登录尝试。也可以将审计设置为记录失败的登录尝试，并提供有关试图登录的用户的附加信息。</li>
<li><strong>搜索事件</strong><br>  审计提供了 <code>ausearch</code> 工具，可用于过滤日志条目，并根据多个条件提供完整的审计跟踪。</li>
<li><strong>运行总结报告</strong><br>  <code>aureport</code> 实用程序可用于生成记录事件的日常报告等。然后，系统管理员可以分析这些报告，并进一步调查可疑的活动。</li>
<li><strong>监控网络访问</strong><br>  <code>iptables</code> 和 <code>ebtables</code> 工具可以配置为触发审计事件，允许系统管理员监控网络访问。<blockquote>
<p>系统性能可能会受到影响，具体取决于审计所收集的信息量。</p>
</blockquote>
</li>
</ul>
<h1 id="审计系统架构"><a href="#审计系统架构" class="headerlink" title="审计系统架构"></a>审计系统架构</h1><p>审计系统由两个主要部分组成： <strong>用户空间应用程序和工具</strong> ，以及 <strong>内核端系统调用处理</strong> 。内核组件接收用户空间应用程序的系统调用，并通过以下过滤器对其进行过滤： <code>user</code>、<code>task</code>、<code>fstype</code> 或 <code>exit</code> 。 <sup id="fnref:1"><a href="#fn:1" rel="footnote"><span class="hint--top hint--error hint--medium hint--rounded hint--bounce" aria-label="[第 7 章 系统审计](https://docs.redhat.com/zh_hans/documentation/red_hat_enterprise_linux/7/html/security_guide/chap-system_auditing#chap-system_auditing) ">[1]</span></a></sup></p>
<p><strong>用户空间审计守护进程</strong> 从内核收集信息，并在日志文件中创建条目。<strong>其他审计用户空间工具</strong> 与 <strong>审计守护进程</strong> 、 <strong>内核审计组件</strong> 或 <strong>审计日志文件</strong> 进行交互：</p>
<ul>
<li><code>audisp</code> - Audit 分配程序守护进程与 Audit 守护进程交互，并将事件发送到其他应用程序，以便进一步处理。此守护进程的目的是提供插件机制，以便实时分析程序可以与审计事件交互。</li>
<li><code>auditctl</code> - 审计控制实用程序与内核审计组件交互，以管理规则并控制事件生成进程的多个设置和参数。</li>
<li>其余的审计工具会将审计日志文件的内容作为输入，并根据用户的要求生成输出。例如，<code>aureport</code> 工具生成所有记录的事件的报告。</li>
</ul>
          <!--noindex-->
            <div class="post-button">
              <a class="btn" href="20241025105226/#more" rel="contents">
                阅读全文 &raquo;
              </a>
            </div>
          <!--/noindex-->
        
      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://csms.tech/20241018132717/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="images/avatar.gif">
      <meta itemprop="name" content="COSMOS">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="L B T">
      <meta itemprop="description" content="得 能 莫 忘">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | L B T">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="20241018132717/" class="post-title-link" itemprop="url">Linux 系统安全加固</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2024-10-18 13:10:00" itemprop="dateCreated datePublished" datetime="2024-10-18T13:10:00+08:00">2024-10-18</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2024-10-24 17:10:00" itemprop="dateModified" datetime="2024-10-24T17:10:00+08:00">2024-10-24</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">上层目录</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="categories/Linux/" itemprop="url" rel="index"><span itemprop="name">Linux</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css"><p>Linux 系统安全加固常用方法</p>
<h1 id="服务网络安全"><a href="#服务网络安全" class="headerlink" title="服务网络安全"></a>服务网络安全</h1><ul>
<li>启用防火墙，并确保入口流量都是必须的，禁止无关的 IP 访问目标主机上的服务（端口）</li>
</ul>
<h1 id="系统软件安全检测"><a href="#系统软件安全检测" class="headerlink" title="系统软件安全检测"></a>系统软件安全检测</h1><ul>
<li><p>定期扫描系统上安装的软件，确保关键系统命令未被篡改，例如使用 <code>rpm -Va</code> 对所有系统上的软件进行校验，检查是否有软件被篡改</p>
  <figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">rpm -Va</span></span><br><span class="line">.......T.    /usr/src/kernels/3.10.0-1160.114.2.el7.x86_64/virt/lib/Kconfig</span><br><span class="line">.......T.    /usr/src/kernels/3.10.0-1160.114.2.el7.x86_64/virt/lib/Makefile</span><br><span class="line">S.5....T.  c /root/.bash_profile</span><br><span class="line">S.5....T.  c /root/.bashrc</span><br><span class="line">.M.......    /var/run/supervisor</span><br><span class="line">missing     /etc/filebeat/fields.yml</span><br><span class="line">SM5....T.  c /etc/filebeat/filebeat.yml</span><br><span class="line">....L....  c /etc/pam.d/fingerprint-auth</span><br><span class="line">....L....  c /etc/pam.d/password-auth</span><br><span class="line">....L....  c /etc/pam.d/postlogin</span><br><span class="line">....L....  c /etc/pam.d/smartcard-auth</span><br><span class="line">....L....  c /etc/pam.d/system-auth</span><br></pre></td></tr></table></figure>
<p>  输出的每一行对应一个文件，前 9 个字符的字符串显示了该文件的属性状态。每个字符的位置代表了特定的属性检查结果。<code>rpm -Va</code> 对比的是当前系统中文件的状态与 RPM 数据库中记录的文件状态。</p>
<p>  每个字符的含义:</p>
<ul>
<li>第 1 位 ： 文件类型 (S).<br>  如果文件丢失了，则会显示 <code>S</code>（代表文件缺失，”File is missing”）。</li>
<li>第 2 位：文件大小 (5)<br>  如果文件大小与 RPM 数据库中的记录不一致，则会显示 <code>5</code>  </li>
<li>第 3 位：文件权限（模式&#x2F;权限位，M）<br>  如果文件的权限与 RPM 数据库记录的不一致，则会显示 <code>M</code>。  </li>
<li>第 4 位：文件的所有者 (U)<br>  如果文件的所有者与 RPM 数据库记录的不一致，则会显示 <code>U</code>  </li>
<li>第 5 位：文件所属的组 (G)<br>  如果文件的所属组与 RPM 数据库记录的不一致，则会显示 <code>G</code>  </li>
<li>第 6 位：文件的设备类型 (D)<br>  如果文件的设备类型（如块设备或字符设备）与 RPM 数据库记录的不一致，则会显示 <code>D</code>  </li>
<li>第 7 位：文件的时间戳 (T)<br>  如果文件的修改时间与 RPM 数据库中的记录不一致，则会显示 <code>T</code>。  </li>
<li>第 8 位：文件的校验和 (5)<br>  如果文件内容的校验和与 RPM 数据库记录的不一致，则会显示 <code>5</code>。</li>
<li>第 9 位：文件的符号链接 (L)<br>  如果文件是一个符号链接，并且符号链接目标发生变化，则会显示 <code>L</code>。</li>
<li>如果是配置文件，会被标记为 <code>c</code></li>
</ul>
</li>
</ul>
<h1 id="文件加固"><a href="#文件加固" class="headerlink" title="文件加固"></a>文件加固</h1><h2 id="文件系统加固"><a href="#文件系统加固" class="headerlink" title="文件系统加固"></a>文件系统加固</h2><p>Linux 操作系统中的很多目录都有约定的用途，可能会挂载单独的文件系统，不同用途的目录，对权限的要求不同，从安全角度考量，可以针对文件系统进行一定程度的安全加固。</p>
<p>文件系统的挂载，主要依赖配置文件 <code>/etc/fstab</code>，此配置会被 <code>mount</code>、<code>dump</code>、<code>fsck</code> 等命令使用，其权限应该设置为 <code>644</code>，属主和属组都应该是 <code>root</code>。在挂载不同用途的文件系统时，可以根据其用途配置权限限制。以下列出部分示例</p>
<blockquote>
<p><strong>可用的挂载选项可以查看 <code>man fatab</code>、<code>man mount</code>、<code>man 5 ext4</code> 等内容中的选项，不同的文件系统支持不同的挂载选项，通用的挂载选项（独立于文件系统）可以查看 <code>man mount</code> 中的 <code>FILESYSTEM-INDEPENDENT MOUNT OPTIONS</code> 部分</strong></p>
</blockquote>
<ul>
<li><code>/home/</code> 目录下通常是用户家目录，可能会挂载到单独的文件系统，根据其特性，可以配置以下限制<ul>
<li><code>nosuid</code> ： 禁止其中的文件&#x2F;目录配置 <a href="https://csms.tech/202306261438/#Set-UID">SUID 或 SGID 权限</a></li>
<li><code>nodev</code> : 禁止其中的设备被内核识别，放置在此目录下的设备可能都是恶意设备，应该被禁止识别并使用</li>
<li><code>noexec</code> ： 禁止此文件系统中的可执行文件执行。</li>
</ul>
</li>
<li><code>/tmp/</code> 目录也可以设置以下限制<ul>
<li><code>nosuid</code> </li>
<li><code>nodev</code></li>
<li><code>noexec</code></li>
</ul>
</li>
</ul>
<h2 id="关键文件审计及监控"><a href="#关键文件审计及监控" class="headerlink" title="关键文件审计及监控"></a>关键文件审计及监控</h2><h3 id="auditd-审计"><a href="#auditd-审计" class="headerlink" title="auditd 审计"></a>auditd 审计</h3><a href="/20241025105226/" title="可以使用 &#96;auditd&#96; 服务对系统上的关键文件进行审计日志记录">可以使用 &#96;auditd&#96; 服务对系统上的关键文件进行审计日志记录</a>

<h3 id="关键文件监控"><a href="#关键文件监控" class="headerlink" title="关键文件监控"></a>关键文件监控</h3><p>系统上的某些关键文件，如常用可执行文件（<code>/sbin/</code> 下的文件）、关键配置文件等，要监控其是否被恶意修改。可以参考以下方法</p>
<ul>
<li><p><code>find</code> 命令搜索文件修改时间<br>  <code>find</code> 命令的 <code>-mtime</code> 可以查找文件的 <strong>内容修改时间</strong></p>
<p>  <code>find</code> 命令的 <code>-ctime</code> 可以查找文件的 <strong>创建时间&#x2F;属性修改时间</strong>  </p>
<p>  如常用的系统命令不会出现内容的修改和属性的修改，如果出现这些现象，很可能属于恶意篡改，可以使用 <code>find</code> 命令查找或是监控这些变化</p>
  <figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">find /sbin -mtime -1</span></span><br><span class="line">/sbin</span><br><span class="line">/sbin/init</span><br><span class="line">/sbin/reboot</span><br></pre></td></tr></table></figure>
<p> 在发现关键文件被篡改后可以及时发送告警。可以使用 <code>stat</code> 命令检查文件变更的更详细信息</p>
  <figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="built_in">stat</span> /sbin/init</span></span><br><span class="line"> File: &#x27;/sbin/init&#x27; -&gt; &#x27;../bin/systemd&#x27;</span><br><span class="line"> Size: 14 Blocks: 0 IO Block: 4096 symbolic link</span><br><span class="line">Device: fd01h/64769d Inode: 9551 Links: 1</span><br><span class="line">Access: (0777/lrwxrwxrwx)</span><br><span class="line">Uid: ( 0/ root) Gid: ( 0/ root)</span><br><span class="line">Context: system_u:object_r:bin_t:s0</span><br><span class="line">Access: 2016-02-03 03:34:57.276589176 -0500</span><br><span class="line">Modify: 2016-02-02 23:40:39.139872288 -0500</span><br><span class="line">Change: 2016-02-02 23:40:39.140872415 -0500</span><br><span class="line"> Birth: -</span><br></pre></td></tr></table></figure>
<p> 为了更好的监控关键文件的篡改，可以在系统运行之初就为其创建一个包含关键文件的 <code>mtimes</code> 和 <code>ctimes</code> 信息的数据库，并在系统运行过程中通过脚本检测关键文件的 <code>mtimes</code> 和 <code>ctimes</code> 并和原始数据库中的信息进行对比已检测文件是否被篡改。通常的 <strong>Intrusion Detection System</strong> 基本都实现了类似的功能。</p>
<p> 通常需要关注的可以被 <code>find</code> 检查的其他特殊类型文件和特殊权限还可能包括以下事项：</p>
<table>
<thead>
<tr>
<th>File or Settings</th>
<th>Scan Command</th>
<th>Problem With File or Settings</th>
</tr>
</thead>
<tbody><tr>
<td><code>SUID</code></td>
<td><code>find / -perm -4000</code></td>
<td>Allows anyone to become the file’s owner temporarily while the file is being executed in memory</td>
</tr>
<tr>
<td><code>GID</code></td>
<td><code>find / -perm -2000</code></td>
<td>Allows anyone to become a group member of the file’s group temporarily while the file is being executed in memory.</td>
</tr>
<tr>
<td><code>rhost files</code></td>
<td><code>find /home -name .rhosts</code></td>
<td>Allows a system to trust another system completely. It should not be in <code>/home</code> directories.</td>
</tr>
<tr>
<td><code>Ownerless files</code></td>
<td><code>find / -nouser</code></td>
<td>Indicates files that are not associated with any username.</td>
</tr>
<tr>
<td><code>Groupless files</code></td>
<td><code>find / -nogroup</code></td>
<td>Indicates files that are not associated with any group name.</td>
</tr>
</tbody></table>
</li>
</ul>
<h1 id="Viruses"><a href="#Viruses" class="headerlink" title="Viruses"></a>Viruses</h1><h2 id="ClamAV"><a href="#ClamAV" class="headerlink" title="ClamAV"></a>ClamAV</h2><p>ClamAV 是一个开源并免费的 Linux 杀毒（Antivirus Software）软件。</p>
<h1 id="Rootkit"><a href="#Rootkit" class="headerlink" title="Rootkit"></a>Rootkit</h1><h2 id="chkrootkit"><a href="#chkrootkit" class="headerlink" title="chkrootkit"></a>chkrootkit</h2><p><code>chkrootkit</code> 是 Linux 上常用的检测 <code>rootkit</code> 的工具，这个工具的结果需要更深入的分析，它可能出错</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">chkrootkit | grep INFECTED</span></span><br><span class="line">Checking &#x27;du&#x27;... INFECTED</span><br><span class="line">Checking &#x27;find&#x27;... INFECTED</span><br><span class="line">Checking &#x27;ls&#x27;... INFECTED</span><br><span class="line">Checking &#x27;lsof&#x27;... INFECTED</span><br><span class="line">Checking &#x27;pstree&#x27;... INFECTED</span><br><span class="line">Searching for Suckit rootkit... Warning: /sbin/init INFECTED</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="Rootkit-Hunter"><a href="#Rootkit-Hunter" class="headerlink" title="Rootkit Hunter"></a>Rootkit Hunter</h2><p>Rootkit Hunter 是另一个比较出名的 <code>rootkit</code> 检测工具</p>
<h1 id="Intrusion-Detection-and-Prevention-System"><a href="#Intrusion-Detection-and-Prevention-System" class="headerlink" title="Intrusion Detection and Prevention System"></a>Intrusion Detection and Prevention System</h1><p><strong>入侵检测和防御系统</strong> 可以监控系统上的活动并找到潜在的恶意活动或者进程并报告相关活动。Linux 上常用的入侵检测系统有</p>
<ul>
<li><code>aide</code> ： Advanced Intrusion Detection Environment. </li>
<li><code>snort</code></li>
<li><code>tripwire</code></li>
</ul>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://csms.tech/202306021537/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="images/avatar.gif">
      <meta itemprop="name" content="COSMOS">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="L B T">
      <meta itemprop="description" content="得 能 莫 忘">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | L B T">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="202306021537/" class="post-title-link" itemprop="url">Linux 内存相关操作</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2023-06-02 15:37:57" itemprop="dateCreated datePublished" datetime="2023-06-02T15:37:57+08:00">2023-06-02</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2024-10-24 11:10:00" itemprop="dateModified" datetime="2024-10-24T11:10:00+08:00">2024-10-24</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">上层目录</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="categories/Linux/" itemprop="url" rel="index"><span itemprop="name">Linux</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="进程的内存分层结构"><a href="#进程的内存分层结构" class="headerlink" title="进程的内存分层结构"></a>进程的内存分层结构</h1><p>进程的内存结构一般被分成多个 <code>sections</code>，包括</p>
<ul>
<li><strong><code>Text section</code></strong> - 存放程序代码（the executable code）</li>
<li><strong><code>Data section</code></strong> - 存放全局变量（global variables）</li>
<li><strong><code>Heap section</code></strong> - 程序运行过程中动态分配的内存</li>
<li><strong><code>Stack section</code></strong> - 调用程序功能时的临时数据存储，如函数参数、返回地址、本地变量等。</li>
</ul>
<p><img src="https://i.csms.tech/img_239.png"></p>
<p>下图展示了 C 程序（Program）在内存中的分层结构(layout of a C program in memory)<br><img src="https://i.csms.tech/img_238.png"></p>
<blockquote>
<ul>
<li>其中， <strong><code>Data section</code></strong>  被分成了 2 部分，包括 <code>(a) initialized data</code> 和 <code>(b) uninitialized data</code></li>
</ul>
</blockquote>
<p>使用 GNU 工具 <code>size</code> 可以检查 <strong>Projram</strong> 在磁盘上的 <strong>内存布局</strong>。这些值在程序编译时确定，并不会在程序运行时变化，因此它们是固定不变的。</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">size /usr/sbin/sshd</span></span><br><span class="line">   text	   data	    bss	    dec	    hex	filename</span><br><span class="line"> 817397	  15460	  37664	 870521	  d4879	/usr/sbin/sshd</span><br></pre></td></tr></table></figure>
<p>输出信息中：</p>
<ul>
<li><code>text</code> : 代表 <code>Text section</code> 的大小</li>
<li><code>data</code> : 初始化数据段(<code>initialized data</code>)的大小，包含已初始化的全局和静态变量。</li>
<li><code>bss</code> : 未初始化数据段的大小，包含未初始化的全局和静态变量。</li>
<li><code>dec</code> : 上述所有部分的总大小，以十进制表示。</li>
<li><code>hex</code> : 上述所有部分的总大小，以十六进制表示。</li>
</ul>
          <!--noindex-->
            <div class="post-button">
              <a class="btn" href="202306021537/#more" rel="contents">
                阅读全文 &raquo;
              </a>
            </div>
          <!--/noindex-->
        
      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://csms.tech/202301171137/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="images/avatar.gif">
      <meta itemprop="name" content="COSMOS">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="L B T">
      <meta itemprop="description" content="得 能 莫 忘">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | L B T">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="202301171137/" class="post-title-link" itemprop="url">linux 系统状态查看</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2023-01-17 11:37:49" itemprop="dateCreated datePublished" datetime="2023-01-17T11:37:49+08:00">2023-01-17</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2024-10-24 10:10:00" itemprop="dateModified" datetime="2024-10-24T10:10:00+08:00">2024-10-24</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">上层目录</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="categories/Linux/" itemprop="url" rel="index"><span itemprop="name">Linux</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="环境信息"><a href="#环境信息" class="headerlink" title="环境信息"></a>环境信息</h1><ul>
<li>Centos 7 kernel 5.4.221</li>
</ul>
<h1 id="启动过程"><a href="#启动过程" class="headerlink" title="启动过程"></a>启动过程</h1><p>在 <code>systemd</code> 管理的系统中，提供了工具 <code>systemd-analyze</code> 用于分析具体的启动过程，使用 <code>systemd-analyze --help</code> 查看使用帮助</p>
<h2 id="检查系统启动时间"><a href="#检查系统启动时间" class="headerlink" title="检查系统启动时间"></a>检查系统启动时间</h2><p>使用 <code>systemd-analyze</code> 命令会显示系统启动所用的时间，等同于 <code>systemd-analyze time</code></p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">systemd-analyze</span> </span><br><span class="line">Startup finished in 1.830s (kernel) + 36.827s (userspace) = 38.657s </span><br><span class="line">graphical.target reached after 12.604s in userspace</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><code>systemd-analyze blame</code> 列出系统上各个 Unit 启动的时间</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">systemd-analyze blame</span></span><br><span class="line">          6.414s wazuh-agent.service</span><br><span class="line">          3.161s dracut-initqueue.service</span><br><span class="line">          2.473s network.service</span><br><span class="line">          1.004s watchdog.service</span><br><span class="line">          ...</span><br><span class="line">            45ms sysstat.service</span><br><span class="line">            14ms plymouth-switch-root.service</span><br><span class="line">            14ms systemd-journald.service</span><br><span class="line">             4ms systemd-logind.service</span><br><span class="line">             3ms sys-kernel-config.mount</span><br><span class="line">             3ms initrd-udevadm-cleanup-db.service</span><br><span class="line">             3ms systemd-random-seed.service</span><br><span class="line">             2ms google-shutdown-scripts.service</span><br></pre></td></tr></table></figure>

<p><strong>列出系统各个 Unit 启动消耗的时间</strong></p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">systemd-analyze critical-chain</span></span><br><span class="line">The time when unit became active or started is printed after the &quot;@&quot; character.</span><br><span class="line">The time the unit took to start is printed after the &quot;+&quot; character.</span><br><span class="line"></span><br><span class="line">graphical.target @12.604s</span><br><span class="line">└─multi-user.target @12.601s</span><br><span class="line">  └─skylight-agent.service @36.639s</span><br><span class="line">    └─network.target @9.073s</span><br><span class="line">      └─NetworkManager.service @8.795s +275ms</span><br><span class="line">        └─dbus.service @8.788s</span><br><span class="line">          └─basic.target @8.774s</span><br><span class="line">            └─sockets.target @8.772s</span><br><span class="line">              └─snapd.socket @8.766s +5ms</span><br><span class="line">                └─sysinit.target @8.669s</span><br><span class="line">                  └─cloud-init.service @6.850s +1.811s</span><br><span class="line">                    └─systemd-networkd-wait-online.service @4.970s +1.871s</span><br><span class="line">                      └─systemd-networkd.service @4.864s +91ms</span><br><span class="line">                        └─network-pre.target @4.850s</span><br><span class="line">                          └─cloud-init-local.service @3.228s +1.620s</span><br><span class="line">                            └─systemd-remount-fs.service @1.113s +93ms</span><br><span class="line">                              └─systemd-fsck-root.service @1.030s +69ms</span><br><span class="line">                                └─systemd-journald.socket @853ms</span><br><span class="line">                                  └─-.mount @692ms</span><br><span class="line">                                    └─-.slice @692ms</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h1 id="查看内存信息"><a href="#查看内存信息" class="headerlink" title="查看内存信息"></a>查看内存信息</h1><p>内存相关概念说明：</p>
<ul>
<li><strong>VSS ,Virtual Set Size , VIRT</strong> - 虚拟耗用内存（包含共享库占用的内存）， <strong>通常 VIRT 是系统承诺分配给应用的内存，不是实际使用的内存</strong></li>
<li><strong>RSS , Resident Set Size , RES</strong> - 实际使用物理内存（包含共享库占用的内存）</li>
<li><strong>PSS , Proportional Set Size</strong> - 实际使用的物理内存（比例分配共享库占用的内存）。 <strong><code>top</code> 命令中的 <code>SHR</code> 列展示的就是共享库按比例分配给进程的内存</strong></li>
<li><strong>USS , Unique Set Size</strong> - 进程独自占用的物理内存（不包含共享库占用的内存）</li>
</ul>
<h2 id="系统内存使用量统计"><a href="#系统内存使用量统计" class="headerlink" title="系统内存使用量统计"></a>系统内存使用量统计</h2><h3 id="free"><a href="#free" class="headerlink" title="free"></a>free</h3><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">free -h</span></span><br><span class="line">               total        used        free      shared  buff/cache   available</span><br><span class="line">Mem:            15Gi       7.8Gi       707Mi       449Mi       7.0Gi       6.9Gi</span><br><span class="line">Swap:           30Gi       1.0Gi        29Gi</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="ps"><a href="#ps" class="headerlink" title="ps"></a>ps</h3><p>例如查看使用内存排名前十的进程：</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">ps aux | sort -k4,4nr | head -n 10</span><br></pre></td></tr></table></figure>

<h3 id="sar-命令"><a href="#sar-命令" class="headerlink" title="sar 命令"></a>sar 命令</h3><p><a href="#sar-%E6%A3%80%E6%9F%A5%E7%B3%BB%E7%BB%9F%E5%86%85%E5%AD%98%E7%BB%9F%E8%AE%A1%E6%95%B0%E6%8D%AE">使用 <code>sar</code> 命令检查系统上的内存及 Swap 使用情况</a></p>
<h2 id="查看某个进程使用的内存量"><a href="#查看某个进程使用的内存量" class="headerlink" title="查看某个进程使用的内存量"></a>查看某个进程使用的内存量</h2><p>比如检查 <code>docker</code> 使用的内存量，首先通过 <code>ps</code> 命令查询到 <code>docker</code> 的 PID 信息</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">ps -elf | grep docker</span></span><br><span class="line">4 S root      1243     1  4  80   0 - 1067527 futex_ Jan03 ?      15:14:45 /usr/bin/dockerd -H fd:// --containerd=/run/containerd/containerd.sock</span><br></pre></td></tr></table></figure>
<p>例如此处的 <code>docker</code> 进程的 PID 为 1243</p>
<ul>
<li><p>使用 <code>top</code> 命令动态查看 <code>docker</code> 使用的内存信息</p>
  <figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">top -p 1243</span></span><br><span class="line">top - 11:47:40 up 14 days,  2:09,  3 users,  load average: 0.65, 1.42, 1.70</span><br><span class="line">Tasks:   1 total,   0 running,   1 sleeping,   0 stopped,   0 zombie</span><br><span class="line"><span class="meta prompt_">%</span><span class="language-bash">Cpu(s):  1.0 us,  0.6 sy,  0.0 ni, 98.3 <span class="built_in">id</span>,  0.0 wa,  0.0 hi,  0.0 si,  0.0 st</span></span><br><span class="line">KiB Mem : 32068748 total,  2494500 free, 18536188 used, 11038060 buff/cache</span><br><span class="line">KiB Swap:        0 total,        0 free,        0 used.  9586340 avail Mem </span><br><span class="line"></span><br><span class="line">  PID USER      PR  NI    VIRT    RES    SHR S  %CPU %MEM     TIME+ COMMAND                                                           </span><br><span class="line"> 1243 root      20   0 4270108   1.4g  53956 S   1.0  4.6 914:55.80 dockerd</span><br></pre></td></tr></table></figure>
</li>
<li><p>使用 <code>ps aux</code> 命令查看内存使用量</p>
  <figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">ps aux | grep 1243</span></span><br><span class="line">root      1243  4.5  4.6 4270108 1486460 ?     Ssl  Jan03 914:57 /usr/bin/dockerd -H fd:// --containerd=/run/containerd/containerd.sock</span><br></pre></td></tr></table></figure>

<p>  输出结果中</p>
<ul>
<li>第 3、4 列 (<code>4.5  4.6</code>) 分别表示 <code>cpu 使用率</code>、<code>内存使用率</code>。</li>
<li>第 5、6 列 (<code>4270108 1486460</code>) 分别表示 <code>虚拟内存使用量</code>、<code>物理内存使用量</code>，单位为 <code>k</code>。</li>
</ul>
</li>
<li><p>通过进程的 <code>status</code> 文件查看内存使用</p>
  <figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="built_in">cat</span> /proc/1243/status</span></span><br><span class="line">Name:	dockerd</span><br><span class="line">Umask:	0022</span><br><span class="line">State:	S (sleeping)</span><br><span class="line">Pid:	1243</span><br><span class="line">PPid:	1</span><br><span class="line">VmPeak:	 4270364 kB</span><br><span class="line">VmSize:	 4270108 kB</span><br><span class="line">VmLck:	       0 kB</span><br><span class="line">VmPin:	       0 kB</span><br><span class="line">VmHWM:	 1562204 kB</span><br><span class="line">VmRSS:	 1492340 kB</span><br><span class="line">...</span><br></pre></td></tr></table></figure>
<p>其中，<code>VmRSS</code> 为进程使用的物理内存</p>
</li>
<li><p>使用 <code>pmap</code> 命令查看进程使用的内存信息</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">pmap -x 1243</span><br><span class="line">pmap -p 1243</span><br></pre></td></tr></table></figure>
          <!--noindex-->
            <div class="post-button">
              <a class="btn" href="202301171137/#more" rel="contents">
                阅读全文 &raquo;
              </a>
            </div>
          <!--/noindex-->
        
      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://csms.tech/20241023162615/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="images/avatar.gif">
      <meta itemprop="name" content="COSMOS">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="L B T">
      <meta itemprop="description" content="得 能 莫 忘">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | L B T">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="20241023162615/" class="post-title-link" itemprop="url">BIOS 和 UEFI</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2024-10-23 16:10:00" itemprop="dateCreated datePublished" datetime="2024-10-23T16:10:00+08:00">2024-10-23</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">上层目录</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="categories/%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0/" itemprop="url" rel="index"><span itemprop="name">读书笔记</span></a>
        </span>
          ，
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="categories/%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0/OS/" itemprop="url" rel="index"><span itemprop="name">OS</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css"><p>计算机启动（上电）后，需要固件（firmware）程序来 <strong>初始化硬件</strong> 以及选择 <strong>需要启动的 Operating System</strong></p>
<p>曾经最流行的固件（firmware）程序是 BIOS（Basic Input Output System），最近 BIOS 正在逐渐被 UEFI（Unified Extensible Firmware Interface）取代。在同一个计算机上，他们只能使用一个（互斥）</p>
<p>UEFI 设计包含安全启动特性（Secure Boot Feature），他可以确保 <strong>只有所有组建都进行过有效签名的 OS 才能启动过程中被加载</strong> 。此特性也可以禁用以启动未经签名的 OS.</p>
<p>BIOS 或者 UEFI 的主要工作是 <strong>初始化硬件</strong> 和 <strong>并将计算机控制权移交给 Boot Loader</strong> ，之后 Boot Loader 会寻找并启动 Operating System.</p>
<p>BIOS 或者 UEFI 通常可以在计算机上电启动后进行配置，一般通过特定的按键（如 F1、F2、F12 等）进入设定界面。主要包含 2 部分内容</p>
<ul>
<li><strong>Bios&#x2F;UEFI 配置工具</strong> ： 可以修改 BIOS&#x2F;UEFI 设定，如启用&#x2F;禁止某些功能</li>
<li><strong>Boot Order</strong> ： 修改启动顺序，如从特定设备（CD、DVD、USB 等）启动</li>
</ul>
<h1 id="参考链接"><a href="#参考链接" class="headerlink" title="参考链接"></a>参考链接</h1><p><a target="_blank" rel="noopener" href="https://edu.anarcho-copy.org/Against%20Security%20-%20Self%20Security/linux-bible-christopher-negus-10th.pdf">Linux Bible v10</a></p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://csms.tech/20241018095609/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="images/avatar.gif">
      <meta itemprop="name" content="COSMOS">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="L B T">
      <meta itemprop="description" content="得 能 莫 忘">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | L B T">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="20241018095609/" class="post-title-link" itemprop="url">Linux 文件系统</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2024-10-18 09:10:00" itemprop="dateCreated datePublished" datetime="2024-10-18T09:10:00+08:00">2024-10-18</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">上层目录</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="categories/Linux/" itemprop="url" rel="index"><span itemprop="name">Linux</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css"><p>传统的 PC 架构计算机使用 <strong>Master Boot Record（MBR）分区表（Partition Tables）</strong> 来存储计算机上的 <strong>磁盘分区（Disks Partitions）</strong> 信息。MBR 有以下特点：</p>
<ul>
<li>MBR 的分区最大支持 2TB 的容量。</li>
</ul>
<p>最新的 UEFI 计算机架构使用 <strong>GUID（Globally Unique Identifier） Partition Tables（GPT）</strong> 标准来替代旧的 BIOS 方法启动计算机操作系统。相比于 MBR，GPT 有以下优势及特性：</p>
<ul>
<li>GPT 的分区最大能支持到 9.4ZB</li>
</ul>
<p><strong>传统的基于 MBR Partition Tables 的最重要的分区工具是 <code>fdisk</code>，但是它目前不支持 GPT Partitions</strong> ，新的工具 <code>parted</code> 正在顶替 <code>fdisk</code> 的功能。</p>
<h1 id="parted-用法"><a href="#parted-用法" class="headerlink" title="parted 用法"></a>parted 用法</h1><p>要查看 <code>parted</code> 常见用法，可以参考 <code>parted --help</code> 或在交互模式中使用 <code>help</code> 指令</p>
<h2 id="查看分区表信息"><a href="#查看分区表信息" class="headerlink" title="查看分区表信息"></a>查看分区表信息</h2><p>要查看系统上的分区信息，使用以下方式之一</p>
<ul>
<li><code>parted -l</code>  <figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">parted -l</span></span><br><span class="line">Model: Amazon Elastic Block Store (nvme)</span><br><span class="line">Disk /dev/nvme0n1: 85.9GB</span><br><span class="line">Sector size (logical/physical): 512B/512B</span><br><span class="line">Partition Table: gpt</span><br><span class="line">Disk Flags: </span><br><span class="line"></span><br><span class="line">Number  Start   End     Size    File system  Name  Flags</span><br><span class="line">14      1049kB  5243kB  4194kB                     bios_grub</span><br><span class="line">15      5243kB  116MB   111MB   fat32              boot, esp</span><br><span class="line"> 1      116MB   85.9GB  85.8GB  ext4</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Model: Amazon Elastic Block Store (nvme)</span><br><span class="line">Disk /dev/nvme1n1: 107GB</span><br><span class="line">Sector size (logical/physical): 512B/512B</span><br><span class="line">Partition Table: msdos</span><br><span class="line">Disk Flags: </span><br><span class="line"></span><br><span class="line">Number  Start   End     Size    Type     File system  Flags</span><br><span class="line"> 1      1049kB  53.7GB  53.7GB  primary  ext4</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Model: Unknown (unknown)</span><br><span class="line">Disk /dev/zram0: 33.2GB</span><br><span class="line">Sector size (logical/physical): 4096B/4096B</span><br><span class="line">Partition Table: loop</span><br><span class="line">Disk Flags: </span><br><span class="line"></span><br><span class="line">Number  Start  End     Size    File system     Flags</span><br><span class="line"> 1      0.00B  33.2GB  33.2GB  linux-swap(v1)</span><br><span class="line"></span><br></pre></td></tr></table></figure></li>
<li><code>parted</code> 交互模式，在交互模式中使用指令 <code>p</code>  <figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">parted</span> </span><br><span class="line">GNU Parted 3.4</span><br><span class="line">Using /dev/nvme0n1</span><br><span class="line">Welcome to GNU Parted! Type &#x27;help&#x27; to view a list of commands.</span><br><span class="line"></span><br><span class="line">(parted) p                                                                </span><br><span class="line">Model: Amazon Elastic Block Store (nvme)</span><br><span class="line">Disk /dev/nvme0n1: 85.9GB</span><br><span class="line">Sector size (logical/physical): 512B/512B</span><br><span class="line">Partition Table: gpt</span><br><span class="line">Disk Flags: </span><br><span class="line"></span><br><span class="line">Number  Start   End     Size    File system  Name  Flags</span><br><span class="line">14      1049kB  5243kB  4194kB                     bios_grub</span><br><span class="line">15      5243kB  116MB   111MB   fat32              boot, esp</span><br><span class="line"> 1      116MB   85.9GB  85.8GB  ext4</span><br><span class="line"></span><br><span class="line">(parted)                                                              </span><br></pre></td></tr></table></figure></li>
</ul>
<h2 id="创建-GPT-分区格式的硬盘"><a href="#创建-GPT-分区格式的硬盘" class="headerlink" title="创建 GPT 分区格式的硬盘"></a>创建 GPT 分区格式的硬盘</h2><p>要使用 <code>parted</code> 对硬盘指定其分区表类型，假设硬盘为 <code>/dev/nvme1n1</code> (默认表示第二个 NVM（NVMe, NonVolatile Memory Disks express, NVM 磁盘设备专用的通信接口协议） 硬盘的第一个 Namespace)，参考以下步骤：</p>
<ol>
<li><code>parted /dev/nvme1n1</code> ，进入交互模式并对指定的硬盘进行分区操作， <strong>以下步骤会导致硬盘上所有的分区及数据丢失</strong></li>
<li>在交互模式中使用 <code>mklabel gpt</code> 命令，配置硬盘使用 GPT 类型的分区表，而不是 MBR <figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">(parted) mklabel gpt</span><br><span class="line">Warning: The existing disk label on /dev/nvme1n1 will be destroyed and all data</span><br><span class="line">on this disk will be lost. Do you want to continue?</span><br><span class="line">Yes/No? Yes</span><br><span class="line">(parted) </span><br></pre></td></tr></table></figure></li>
<li>在交互模式中使用 <code>mkpart</code> 命令进行分区操作，分区完成后使用 <code>p</code> 指令检查分区 <figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">(parted) mkpart</span><br><span class="line">Partition name? []? alldisk</span><br><span class="line">File system type? [ext2]? xfs</span><br><span class="line">Start? 1</span><br><span class="line">End? 123GB</span><br><span class="line"></span><br><span class="line">(parted) p</span><br><span class="line">Model: SanDisk Ultra (scsi)</span><br><span class="line">Disk /dev/nvme1n1: 123GB</span><br><span class="line">Sector size (logical/physical): 512B/512B</span><br><span class="line">Partition Table: gpt</span><br><span class="line">Disk Flags:</span><br><span class="line">Number Start End Size File system Name Flags</span><br><span class="line">1 1049kB 123GB 123GB xfs alldisk </span><br></pre></td></tr></table></figure></li>
<li>使用 <code>quit</code> 指令退出 <code>parted</code> 交互模式。<blockquote>
<p><strong><code>fdisk</code> 交互模式中，只有最终执行了 <code>w</code> 命令保存，对硬盘的操作才会最终生效，和 <code>fdisk</code> 不同，<code>parted</code> 命令对硬盘的更改立即生效</strong></p>
</blockquote>
</li>
<li>对分区进行格式化并挂载使用，如果需要持久化挂载（系统重启后依然生效），可以将挂载信息写入 <code>/etc/fstab</code> <figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">mkfs -t xfs /dev/nvme1n1p1</span><br><span class="line">mount /dev/nvme1n1p1 /mnt/</span><br></pre></td></tr></table></figure></li>
</ol>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://csms.tech/202306261438/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="images/avatar.gif">
      <meta itemprop="name" content="COSMOS">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="L B T">
      <meta itemprop="description" content="得 能 莫 忘">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | L B T">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="202306261438/" class="post-title-link" itemprop="url">Linux 文件相关操作</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2023-06-26 14:39:00" itemprop="dateCreated datePublished" datetime="2023-06-26T14:39:00+08:00">2023-06-26</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2024-10-17 13:10:00" itemprop="dateModified" datetime="2024-10-17T13:10:00+08:00">2024-10-17</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">上层目录</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="categories/Linux/" itemprop="url" rel="index"><span itemprop="name">Linux</span></a>
        </span>
          ，
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="categories/Linux/%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4/" itemprop="url" rel="index"><span itemprop="name">常用命令</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="文件权限"><a href="#文件权限" class="headerlink" title="文件权限"></a>文件权限</h1><p>在 Linux 系统中，普通的文件权限控制通过关联身份三元组 (<code>user</code>, <code>group</code>,<code>other</code>) 和权限三元组 (<code>r</code>, <code>w</code>, <code>x</code>) 来实现访问控制。</p>
<p>系统存在一个 <code>umask</code> 值（针对用户），<code>umask</code> 是一个权限掩码，它决定了新建的文件或者目录的默认权限，使用 <code>umask</code> 命令可以查看当前(用户) 的  <code>umask</code> 值</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="built_in">umask</span></span></span><br><span class="line">0022</span><br></pre></td></tr></table></figure>
<p>比如如上所示的 <code>umask</code> 值，决定了当前(用户)创建的文件和目录的默认权限</p>
<ul>
<li><code>目录</code> - 默认权限为 <code>0755</code> （<code>777-022</code>），即 <code>rwxr-xr-x</code></li>
<li><code>文件</code> - 默认权限为 <code>644</code> (<code>666-022</code>)，即 <code>rw-r--r--</code></li>
</ul>
<p>因此要配置当前(用户)创建的文件或者目录的默认权限，只需要配置合适的 <code>umask</code> 值即可。配置 <code>umask</code> 值可以通过以下方法</p>
<ul>
<li>临时方法  <figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">umask 027</span><br></pre></td></tr></table></figure></li>
<li>永久方法<br>  根据需求将 <code>umask 027</code> 配置添加到配置文件中，如 <code>/etc/profile</code>、<code>~/.bashrc</code>、<code>~/.bash_profile</code> 等</li>
</ul>
<p>如果需要更进一步的权限控制，需要使用到 <code>Sticky Bit</code> 和 ACL，更细力度的控制还包括 SELinux. 相关扩展权限标志如下：</p>
<ul>
<li><strong>文件&#x2F;目录 权限最后会包含一个 <code>.</code></strong> ： 表示 SELinux （Security Enhanced Linux）扩展权限。可以使用命令 <code>ls -l -Z</code> 查看具体权限。</li>
<li><strong>文件&#x2F;目录 权限最后会包含一个 <code>+</code></strong> ： 表示 <strong>文件&#x2F;目录</strong> 有 <strong>ACL（Access Control List）</strong> 扩展权限，<a href="#ACL">相关操作及命令参考</a></li>
<li><strong>目录 权限最后会包含一个 <code>t</code></strong> ： 表示此 <strong>目录</strong> 有 <strong>Sticky Bit</strong> 扩展权限，<a href="#Sticky-Bit">相关操作及命令参考</a></li>
<li><strong>可执行文件 权限中属主（Owner）的 <code>x</code> 位变为 <code>s</code></strong> ： 表示此 <strong>可执行文件</strong> 配置了 <a href="#Set-UID"> <strong>Set UID</strong> 扩展权限</a></li>
<li><strong>可执行文件&#x2F;目录 权限中属组（Group）的 <code>x</code> 位变为 <code>s</code></strong> ： 表示此 <strong>目录</strong> 配置了 <a href="#Set-GID"> <strong>Set GID</strong> 扩展权限</a></li>
</ul>
<h2 id="Set-UID"><a href="#Set-UID" class="headerlink" title="Set UID"></a>Set UID</h2><ul>
<li>只有 <strong>可执行的二进制程序和可执行的代码</strong> 才能设定 SUID 权限。</li>
<li>命令执行者首先要对该程序拥有 <code>x</code>（执行）权限。</li>
<li>命令执行者在执行该程序时获得该程序文件 <strong>属主（Owner）</strong> 的身份。</li>
<li>SetUID 权限只在该程序 <strong>执行过程中</strong> 有效，也就是说身份改变只在执行过程中有效。</li>
</ul>
<p>设定 SUID 和 SGID 时，传统的 3 元组权限方式（如 <code>rwxrwxrwx</code> &#x3D; <code>777</code>） 变为 4 元组（<code>Srwxrwxrwx</code>），其中的 <code>S</code> 选项包括： </p>
<ul>
<li><code>4</code> 代表 SUID，如 <code>4777</code></li>
<li><code>2</code> 代表 GID，如 <code>2777</code></li>
<li><code>1</code> 代表 Sticky BIT，如 <code>1777</code></li>
<li><code>7</code> 代表全部设置， 如 <code>7777</code></li>
</ul>
<p>SUID 设定命令格式：</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">chmod 4777 可执行文件名</span><br><span class="line"></span><br><span class="line">chmod u+s 可执行文件名</span><br></pre></td></tr></table></figure>

<p>取消 SUID 设置：</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">chmod 777 可执行文件名</span><br></pre></td></tr></table></figure>

<blockquote>
<p>假如某个可执行文件的属主为 <code>root</code>，其设置了 SUID，普通用户运行此可执行文件时会暂时拥有 <code>root</code> 的权限，有一定的风险存在，因此要谨慎设置，为系统安全考虑，要定期查找系统上拥有 SUID 权限的可执行文件并核对其是否存在风险。</p>
</blockquote>
<h2 id="Set-GID"><a href="#Set-GID" class="headerlink" title="Set GID"></a>Set GID</h2><p>对 <strong>可执行文件</strong> 来说，SGID 拥有和 SUID 同样的作用，只不过 **命令执行者在执行该程序时获得该程序文件 <strong>属组（Group）</strong> 的身份。</p>
<p>SGID 设定方法：</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">chmod 2777 可执行文件名</span><br><span class="line"></span><br><span class="line">chmod g+s  可执行文件名</span><br></pre></td></tr></table></figure>


<h2 id="Sticky-Bit"><a href="#Sticky-Bit" class="headerlink" title="Sticky Bit"></a>Sticky Bit</h2><p>粘滞位 (<code>Sticky Bit</code>) 只能用于目录，并对其中的文件有特殊的权限控制。他的主要作用是确保只有文件的所有者才能够删除或者修改文件。要给某个目录配置 <strong>粘滞位 (<code>Sticky Bit</code>)</strong> ，使用以下命令</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">chmod +t directoryname</span><br></pre></td></tr></table></figure>
<p>这将为目录 <code>directoryname</code> 配置粘滞位 (<code>Sticky Bit</code>)，以下命令可以验证 粘滞位 (<code>Sticky Bit</code>)是否存在。如果目录的权限列表中有 <code>t</code> 标志，表示目录设置了 粘滞位 (<code>Sticky Bit</code>)</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="built_in">ls</span> -l directoryname</span></span><br><span class="line">drwxrwxrwt  2 owner group   4096 Jun 26 10:15 directoryname</span><br></pre></td></tr></table></figure>

<p><strong>设置粘滞位后，只有文件的所有者才能删除或修改该文件。其他用户即使有写权限（<code>w</code>），也无法删除其他用户的文件。</strong></p>
          <!--noindex-->
            <div class="post-button">
              <a class="btn" href="202306261438/#more" rel="contents">
                阅读全文 &raquo;
              </a>
            </div>
          <!--/noindex-->
        
      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://csms.tech/20241017100414/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="images/avatar.gif">
      <meta itemprop="name" content="COSMOS">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="L B T">
      <meta itemprop="description" content="得 能 莫 忘">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | L B T">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="20241017100414/" class="post-title-link" itemprop="url">Linux GRUB2</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2024-10-17 10:10:00" itemprop="dateCreated datePublished" datetime="2024-10-17T10:10:00+08:00">2024-10-17</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">上层目录</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="categories/Linux/" itemprop="url" rel="index"><span itemprop="name">Linux</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css"><p><code>boot loader</code> 在计算机启动的时候决定如何运行（启动）安装于硬盘上的操作系统，GRand Unified Bootloader（GRUB）是 Linux 中最流行的 Bootloader 程序。目前主要有 2 个 GRUB 版本：</p>
<ul>
<li>GRUB ： 遗留版本 GRUB v1，在较旧的 Linux 发行版中使用</li>
<li>GRUB 2 ： 当前最新版本，较新的 Linux 发行版中默认的 Bootloader. GRUB 2 的主要功能依旧是 <strong>查找并启动已安装在计算机上的操作系统</strong> 。同时 <strong>通过内嵌了一些工具和配置文件提供了更强大的功能以及灵活性</strong> 。</li>
</ul>
<p>GRUB 2 的配置文件是 <code>/boot/grub/grub.cfg</code> 或者 <code>/boot/grub2/grub.cfg</code>，关于其配置文件，要注意以下事项：</p>
<ul>
<li><code>grub.cfg</code> 的内容是由工具 <code>grub-mkconfig</code> 根据 <code>/etc/default/grub</code> 和 <code>/etc/grub.d/</code> 中的内容自动生成，最好不要手动改动</li>
<li><code>grub.cfg</code> 中可以包含 Shell 脚本语法，如 函数，循环，变量等</li>
<li>用于定位内核（Kernels）和 <code>Initial RAM</code> 位置的设备名称，最好是使用更加可靠的 <strong>标签（Labels）</strong> 或者是 <strong>UUIDs（Universally Unique Identifiers）</strong> ，而不是类似于 <code>/dev/sda</code> 的设备名称，这可以防止计算机系统新增硬盘后，<code>/dev/sda</code> 变成了 <code>/dev/sdb</code> 而导致系统启动时内核无法找到。</li>
</ul>
<h1 id="GRUB-2-常用指令说明"><a href="#GRUB-2-常用指令说明" class="headerlink" title="GRUB 2 常用指令说明"></a>GRUB 2 常用指令说明</h1><p>下表列出了 GRUB 2 Boot Menu 中常用的指令说明，更详细信息可以参考 <code>info grub</code> 或者 <code>info grub2</code></p>
<table>
<thead>
<tr>
<th>Command</th>
<th>Description</th>
<th>Examples</th>
</tr>
</thead>
<tbody><tr>
<td><code>linux file ...</code></td>
<td>从指定的文件中加载 Linux 内核镜像（Linux Kernel Image）<br/>后面跟随的内容会被当作内核指令（Kernel Command）一字不差的传递给内核</td>
<td><code>linux	/boot/vmlinuz-6.8.0-1016-aws root=PARTUUID=00c91e58-1b26-492f-a75f-c5159138dd1a ro  console=tty1 console=ttyS0</code></td>
</tr>
<tr>
<td><code>initrd file [file ...]</code></td>
<td>仅用于 <code>linux</code> 指令之后。为 Linux Kernel Image 按顺序加载 <code>initial RAM Disks</code>，并在其中设置合适的参数</td>
<td><code>initrd	/boot/microcode.cpio /boot/initrd.img-6.8.0-1016-aws</code></td>
</tr>
</tbody></table>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://csms.tech/202211211437/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="images/avatar.gif">
      <meta itemprop="name" content="COSMOS">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="L B T">
      <meta itemprop="description" content="得 能 莫 忘">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | L B T">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="202211211437/" class="post-title-link" itemprop="url">Linux systemd-journald 服务说明</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2022-11-21 14:37:46" itemprop="dateCreated datePublished" datetime="2022-11-21T14:37:46+08:00">2022-11-21</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2024-10-16 13:10:00" itemprop="dateModified" datetime="2024-10-16T13:10:00+08:00">2024-10-16</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">上层目录</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="categories/Linux/" itemprop="url" rel="index"><span itemprop="name">Linux</span></a>
        </span>
          ，
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="categories/Linux/%E5%B8%B8%E7%94%A8%E6%9C%8D%E5%8A%A1/" itemprop="url" rel="index"><span itemprop="name">常用服务</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="systemd-journald-服务简介"><a href="#systemd-journald-服务简介" class="headerlink" title="systemd-journald 服务简介"></a>systemd-journald 服务简介</h1><p><code>systemd-journald</code> 服务是 <code>systemd init</code> 系统提供的收集系统日志的服务。它会根据从内核、用户进程、标准输入和系统服务错误收到的日志记录信息，维护结构化的索引日记，并以此方式来收集和储存日志记录数据。<code>systemd-journald</code> 服务默认处于启用状态。</p>
<p>默认情况下，<code>systemd-journald</code> 在 <code>/run/log/journal/</code> 中储存日志数据。由于 <code>/run/</code> 目录具有易失本性，因此，在重引导时会丢失日志数据。要永久保存日志数据，<code>/var/log/journal/</code> 目录必须存在且具有正确的所有权和权限，如此，<code>systemd-journald</code> 服务便可在其中储存其数据。</p>
<p>要在终端中查看日志信息，可以使用命令 <code>journalctl</code></p>
<h1 id="systemd-journald-服务常用配置"><a href="#systemd-journald-服务常用配置" class="headerlink" title="systemd-journald 服务常用配置"></a>systemd-journald 服务常用配置</h1><h2 id="持久化日志存储"><a href="#持久化日志存储" class="headerlink" title="持久化日志存储"></a>持久化日志存储</h2><p>默认情况下，日志位于 <code>/run/log/journal/</code>，重启后日志会丢失，为了持久化日志，可按照以下 2 种方法之一配置</p>
<ul>
<li><p>方法 1</p>
<ol>
<li>以 <code>root</code> 身份打开 <code>/etc/systemd/journald.conf</code> 进行编辑 <figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">vi /etc/systemd/journald.conf</span><br></pre></td></tr></table></figure></li>
<li>将包含 <code>Storage=</code> 的行取消注释，并将它更改为 <code>Storage=persistent</code><figure class="highlight shell"><figcaption><span>/etc/systemd/journald.conf</span></figcaption><table><tr><td class="code"><pre><span class="line">[Journal]</span><br><span class="line">Storage=persistent</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">Compress=<span class="built_in">yes</span></span></span><br><span class="line">SystemMaxUse=50M</span><br><span class="line">[...]</span><br></pre></td></tr></table></figure></li>
<li>重启 <code>systemd-journald</code> <figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">systemctl restart systemd-journald</span><br></pre></td></tr></table></figure>
之后日志会持久化存储于 <code>/var/log/journal</code>。这些数据最多会占用 <code>/var/log/journal</code> 所在文件系统空间的 10%，要更改此限制，可以修改选项 <code>SystemMaxUse=50M</code></li>
</ol>
</li>
</ul>
          <!--noindex-->
            <div class="post-button">
              <a class="btn" href="202211211437/#more" rel="contents">
                阅读全文 &raquo;
              </a>
            </div>
          <!--/noindex-->
        
      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://csms.tech/202406260952/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="images/avatar.gif">
      <meta itemprop="name" content="COSMOS">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="L B T">
      <meta itemprop="description" content="得 能 莫 忘">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | L B T">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="202406260952/" class="post-title-link" itemprop="url">Linux 进程管理</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2024-06-26 09:52:30" itemprop="dateCreated datePublished" datetime="2024-06-26T09:52:30+08:00">2024-06-26</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2024-10-15 16:10:00" itemprop="dateModified" datetime="2024-10-15T16:10:00+08:00">2024-10-15</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">上层目录</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="categories/Linux/" itemprop="url" rel="index"><span itemprop="name">Linux</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css"><p><strong><code>Program</code></strong> 是一个静态实体，只是存储在操作系统中的文件（集合）</p>
<p><strong><code>Process</code></strong> 是操作系统上的活动（Active）实体，是 <strong><code>Program</code></strong> 由操作系统加载到内存并运行之后的实体。</p>
<p><strong><code>Process</code></strong> 运行过程中需要操作系统为其分配各种资源，如 CPU、Memory、Files、IO 等来完成其运行。</p>
<p>如果一个 <strong><code>Program</code></strong> 被操作系统运行（启动）了多次，那么其产生的多个 <strong><code>Process</code></strong>  属于分割（单独）的实体。</p>
<p>Linux 系统中调度的进程&#x2F;线程，通常被称为任务（Task）</p>
<p>Linux 中常见的进程状态如下表：</p>
<table>
<thead>
<tr>
<th>状态标识</th>
<th>状态名称</th>
<th>状态说明</th>
<th>示例</th>
</tr>
</thead>
<tbody><tr>
<td><code>R</code></td>
<td>task_running</td>
<td>进程处于运行或就绪状态</td>
<td></td>
</tr>
<tr>
<td><code>S</code></td>
<td>task_interruptible<br/> sleeping</td>
<td>可中断的睡眠状态</td>
<td></td>
</tr>
<tr>
<td><code>D</code></td>
<td>task_uninterruptible</td>
<td>不可中断的睡眠状态<br/>1. 它是一种睡眠状态，意味着处于此状态的进程不会消耗 CPU<br/>2. 睡眠的原因是等待某些资源（比如锁或者磁盘 IO），这也是非常多 D 状态的进程都处在处理 IO 操作的原因<br/>3. 是它不能被中断，这个要区别于 <code>硬件中断</code> 的中断，是指不希望在其获取到资源或者超时前被终止。因此他不会被信号唤醒，也就不会响应 <code>kill -9</code> 这类信号。这也是它跟 <code>S（可中断睡眠）</code>状态的区别</td>
<td></td>
</tr>
<tr>
<td><code>T</code></td>
<td>task_stopped <br/> task_traced<br/>Traced</td>
<td>暂停状态或跟踪状态</td>
<td></td>
</tr>
<tr>
<td><code>Z</code></td>
<td>task_dead <br/> exit_zombie<br/>zombie</td>
<td>退出状态，进程成为僵尸进程</td>
<td></td>
</tr>
<tr>
<td><code>X</code></td>
<td>task_dead <br/> exit_dead</td>
<td>退出状态，进程即将被销毁</td>
<td></td>
</tr>
<tr>
<td><code>I</code></td>
<td>idle</td>
<td>空闲状态</td>
<td></td>
</tr>
<tr>
<td><code>+</code></td>
<td></td>
<td>表示关联了前台操作（Foreground Operation），比如前台运行的进程</td>
<td></td>
</tr>
</tbody></table>
<h1 id="进程调度"><a href="#进程调度" class="headerlink" title="进程调度"></a>进程调度</h1><p>Linux 中任务（Task）调度算法默认使用 CFS（Completely Fair Scheduler，内核版本 &gt;&#x3D; 2.6.23）.</p>
<p>CFS 调度算法没有使用固定的进程（此处的进程可能是进程或者线程，Linux 中统称为 Task）优先级（Priority），而是根据进程的 <code>nice value</code> 为进程分配一定比例的（Proportional） CPU 计算时间。 <sup id="fnref:1"><a href="#fn:1" rel="footnote"><span class="hint--top hint--error hint--medium hint--rounded hint--bounce" aria-label="[Operating System Concepts v10 Online](https://os.ecci.ucr.ac.cr/slides/Abraham-Silberschatz-Operating-System-Concepts-10th-2018.pdf)  5.7.1 Example: Linux Scheduling">[1]</span></a></sup></p>
<p><strong><code>nice</code> 的取值从 <code>-20</code> - <code>+19</code>，值越小，优先级越高，默认值为 <code>0</code></strong> 。优先级高的进程会被分配到更高比例的 CPU 处理时间。</p>
<p>在 Linux 内核中，优先级分为两种：静态优先级和动态优先级。CFS 使用的是动态优先级，它是根据 <code>nice</code> 值计算出来的。</p>
<p>CFS Scheduler 不会直接设定 Priorities，而是为每个 Task 维护变量 <code>vruntime（virtual runtime）</code>（可以检查系统 <code>/proc/&lt;PID&gt;/sched</code>），这个值记录了每个 task 使用了多少 CPU 时间。</p>
<p>CFS 通过将进程的虚拟运行时间（<code>vruntime</code>）与其他进程的虚拟运行时间进行比较来决定调度优先级。权重越大，<code>vruntime</code> 增长越慢，意味着进程的优先级越高，能够更频繁地被调度。</p>
<p>假入一个任务有默认的 Priority（<code>nice=0</code>），那么他的 <code>vruntime</code> 和实际使用的 CPU 时间相同。例如一个 <code>nice=0</code> 的进程使用了 CPU 200ms，那么他的 <code>vruntime=200ms</code>。<strong>低优先级（low priority，<code>nice&gt;0</code>）</strong> 的任务在 CPU 上运行了 200ms，那么他的 <code>vruntime&gt;200ms</code>，相反的，一个 <strong>高优先级（high priority,<code>nice&lt;0</code>）</strong> 的任务在 CPU 上运行了 200ms，那么他的 <code>vruntime&lt;200ms</code>。<strong>基于此，CFS Scheduler 在选择下一个要执行的任务时，会选择 <code>vruntime</code> 最小的任务来运行</strong>。如果有高优先级的任务就绪（可执行），它会抢占（preemptive）正在执行的低优先级的任务。</p>
<p>假如 Linux 中有 2 个优先级一样的任务（<code>nice=0</code>），一个进程为 I&#x2F;O-bound，另一个为 CPU-bound。通常情况下，在一个 CPU 周期内，I&#x2F;O-bound 的任务会使用很少的 CPU 时间就会因等待 IO 而中断在 CPU 上的执行并进入 CPU 的等待调度队列（schedule queue），而 CPU-bound 的任务会用尽分配给它的整个 CPU 周期。执行一段时间之后， I&#x2F;O-bound 的任务的 <code>vruntime</code> 的值会显著的小于 CPU-bound 的任务的 <code>vruntime</code>，导致 I&#x2F;O-bound 的任务拥有比 CPU-bound 的任务更高的优先级，当 I&#x2F;O-bound 的任务就绪（IO 返回数据）时，它会立即抢占 CPU 开始执行。</p>
<blockquote>
<p><code>nice</code> 只能针对单一的进程调整优先级，无法同时将优先级配置关联到相关进程，如 子进程或者同一个服务中的其他进程</p>
</blockquote>
<h2 id="修改-nice-的值"><a href="#修改-nice-的值" class="headerlink" title="修改 nice 的值"></a>修改 nice 的值</h2><p>在 Linux 中，<code>nice</code> 值用于调整进程的优先级，数值范围从 <code>-20</code>（ <strong>最高优先级</strong> ）到 <code>19</code>（ <strong>最低优先级</strong> ）。较低的 <code>nice</code> 值表示进程有更高的优先级，会更频繁地获得 CPU 时间，而较高的 <code>nice</code> 值表示进程有较低的优先级。</p>
<p>你可以使用 <code>nice</code> 和 <code>renice</code> 命令来修改进程的 <code>nice</code> 值</p>
<blockquote>
<p>普通用户（<code>root</code> 之外的用户）启动应用程序时默认只能配置初始 <code>nice</code> 值 <code>0-19</code></p>
<p>普通用户（<code>root</code> 之外的用户）修改正在运行的应用程序的 <code>nice</code> 值，只能改大，不能改小。比如进程启动时，其 <code>nice</code> 为 <code>10</code>，拥有权限的普通用户只能将其 <code>nice</code> 值改为大于 <code>10</code> 的值。 </p>
</blockquote>
<h3 id="nice-命令"><a href="#nice-命令" class="headerlink" title="nice 命令"></a>nice 命令</h3><p><strong><code>nice</code> 命令用于在启动进程时指定 <code>nice</code> 值</strong> 。如果不指定，默认 <code>nice</code> 值为 <code>0</code>。</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">nice -n 10 command</span><br></pre></td></tr></table></figure>

<h3 id="renice-命令"><a href="#renice-命令" class="headerlink" title="renice 命令"></a>renice 命令</h3><p><code>renice</code> 命令可以修改已经在运行的进程的 <code>nice</code> 值。需要提供进程 ID（ <strong>PID</strong> ）来指定要修改的进程。</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">renice &lt;nice_value&gt; -p &lt;PID&gt;</span><br></pre></td></tr></table></figure>
<p>如果想要一次修改多个进程的 <code>nice</code> 值，可以传递多个 PID：</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">sudo renice 10 -p 1234 2345 3456</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h1 id="Linux-进程资源控制-cgroups"><a href="#Linux-进程资源控制-cgroups" class="headerlink" title="Linux 进程资源控制 cgroups"></a>Linux 进程资源控制 cgroups</h1><p><code>cgroups</code> 可以将一个任务（<code>task</code>）标识（绑定）到一个特殊的 <strong>控制组（<code>Control Group</code>）</strong> ，此任务启动的子进程可以继承父进程的 <strong>控制组（<code>Control Group</code>）</strong> </p>
<p><strong>控制组（<code>Control Group</code>）</strong> 可以限制的资源类型如下：</p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody><tr>
<td><code>blkio</code></td>
<td><strong>Storage</strong> <br/>限制到存储设备（如 Hard Disk、USB Drivers等）的请求</td>
</tr>
<tr>
<td><code>cpu</code></td>
<td><strong>CPU</strong> <br/>限制 CPU 调度</td>
</tr>
<tr>
<td><code>cpuacct</code></td>
<td><strong>Process Accounting</strong> <br/>上报 CPU 使用状态，可以用于统计客户端使用的处理量并进行收费</td>
</tr>
<tr>
<td><code>cpuset</code></td>
<td><strong>CPU Assignment</strong> <br/>在多处理器的系统上，将 Task 分配到特定的处理器以及关联的内存</td>
</tr>
<tr>
<td><code>devices</code></td>
<td><strong>Device Access</strong> <br/>限制 <strong>控制组（<code>Control Group</code>）</strong> 中的 Task 对目标设备类型的使用</td>
</tr>
<tr>
<td><code>freezer</code></td>
<td><strong>Suspend&#x2F;Resume</strong> <br/>暂停&#x2F;恢复  <strong>控制组（<code>Control Group</code>）</strong> 中的 Task</td>
</tr>
<tr>
<td><code>memory</code></td>
<td><strong>Memory Usage</strong>  <br/>限制并报告  <strong>控制组（<code>Control Group</code>）</strong> 中的 Task 使用的内存</td>
</tr>
<tr>
<td><code>net_cls</code></td>
<td><strong>Network Bandwidth</strong> <br/> 制并报告  <strong>控制组（<code>Control Group</code>）</strong> 中的 Task 使用的网络流量，主要通过对网络流量打上 <code>cgroups</code> 相关标签实现</td>
</tr>
<tr>
<td><code>net_prio</code></td>
<td><strong>Network Traffic</strong> <br/> 控制  <strong>控制组（<code>Control Group</code>）</strong> 中的网络流量的优先级</td>
</tr>
<tr>
<td><code>ns</code></td>
<td><strong>Namespaces</strong> <br/> 将 <code>cgroups</code> 分配到不同的 Namespaces，如此同一个 <code>cgroups</code> 中的进程只能看到本 Namespace 中的进程</td>
</tr>
</tbody></table>
<h1 id="Linux-进程管理"><a href="#Linux-进程管理" class="headerlink" title="Linux 进程管理"></a>Linux 进程管理</h1><h2 id="top-命令"><a href="#top-命令" class="headerlink" title="top 命令"></a>top 命令</h2><p>使用 <code>top</code> 命令可以查看系统负载、CPU 和 内存使用情况。也可以查看单个进程的具体信息。</p>
<p><code>top</code> 命令常用选项</p>
<table>
<thead>
<tr>
<th>选项</th>
<th>说明</th>
<th>示例</th>
</tr>
</thead>
<tbody><tr>
<td><code>-H</code></td>
<td><code>Threads Mode</code>，线程模式。默认情况 <code>top</code> 展示进程的简要信息，使用此选项显示进程中的线程状态。<br/>对应交互式命令 <code>H</code></td>
<td></td>
</tr>
</tbody></table>
<ul>
<li>显示单个进程的（线程）详细信息  <figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">top -H -p 1423</span></span><br><span class="line">top - 09:44:42 up 54 days, 23:53,  2 users,  load average: 8.82, 6.84, 7.21</span><br><span class="line">Threads:  15 total,   0 running,  15 sleeping,   0 stopped,   0 zombie</span><br><span class="line"><span class="meta prompt_">%</span><span class="language-bash">Cpu(s): 40.9 us, 10.8 sy,  0.0 ni, 48.1 <span class="built_in">id</span>,  0.0 wa,  0.0 hi,  0.2 si,  0.0 st</span></span><br><span class="line">KiB Mem : 15790488 total,   466056 free,  7761544 used,  7562888 buff/cache</span><br><span class="line">KiB Swap:        0 total,        0 free,        0 used.  3895716 avail Mem </span><br><span class="line"></span><br><span class="line">  PID USER      PR  NI    VIRT    RES    SHR S %CPU %MEM     TIME+ COMMAND                                                                                  </span><br><span class="line"> 1423 root      20   0 1477368 778788   4260 S 39.5  4.9  11999:41 [watchdog:1:6]                                                                           </span><br><span class="line"> 2572 root      20   0 1477368 778788   4260 S 37.9  4.9  11363:48 [watchdog:1:6]                                                                           </span><br><span class="line"> 1436 root      20   0 1477368 778788   4260 S 34.2  4.9  11286:08 [watchdog:1:6]                                                                           </span><br><span class="line"> 1435 root      20   0 1477368 778788   4260 S 33.9  4.9  12059:53 [watchdog:1:6]                                                                           </span><br><span class="line"> 1434 root      20   0 1477368 778788   4260 S 33.2  4.9  10249:00 [watchdog:1:6]                                                                           </span><br><span class="line"> 1437 root      20   0 1477368 778788   4260 S 30.6  4.9  11717:47 [watchdog:1:6]                                                                           </span><br><span class="line"> 1431 root      20   0 1477368 778788   4260 S 28.9  4.9  11222:06 [watchdog:1:6]                                                                           </span><br><span class="line">21378 root      20   0 1477368 778788   4260 S 27.6  4.9  12143:35 [watchdog:1:6]                                                                           </span><br><span class="line"> 1433 root      20   0 1477368 778788   4260 S 17.6  4.9   8738:21 [watchdog:1:6]                                                                           </span><br><span class="line"> 1428 root      20   0 1477368 778788   4260 S  8.0  4.9   7650:56 [watchdog:1:6]                                                                           </span><br><span class="line"> 1429 root      20   0 1477368 778788   4260 S  0.0  4.9   0:00.04 [watchdog:1:6]                                                                           </span><br><span class="line"> 1430 root      20   0 1477368 778788   4260 S  0.0  4.9   0:00.05 [watchdog:1:6]                                                                           </span><br><span class="line"> 1432 root      20   0 1477368 778788   4260 S  0.0  4.9   0:00.03 [watchdog:1:6]                                                                           </span><br><span class="line"> 1438 root      20   0 1477368 778788   4260 S  0.0  4.9  12260:30 [watchdog:1:6]                                                                           </span><br><span class="line"> 1529 root      20   0 1477368 778788   4260 S  0.0  4.9  11068:39 [watchdog:1:6]</span><br></pre></td></tr></table></figure></li>
</ul>
<h2 id="进程命令名和进程可执行文件名"><a href="#进程命令名和进程可执行文件名" class="headerlink" title="进程命令名和进程可执行文件名"></a>进程命令名和进程可执行文件名</h2><p>在系统中遇到以下进程：</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">ps -elf | grep 18686</span></span><br><span class="line">5 S root     18686  1239  0  80   0 - 46620 pipe_w 15:50 ?        00:00:00 /usr/sbin/CROND -n</span><br><span class="line">0 R root     18694 18686  7  80   0 - 610547 -     15:50 ?        00:00:02 /usr/local/php73/bin/php /home/www/admin/artisan PullData</span><br><span class="line">0 S root     18754 18686  0  80   0 - 22453 pipe_w 15:50 ?        00:00:00 /usr/sbin/sendmail -FCronDaemon -i -odi -oem -oi -t -f root</span><br></pre></td></tr></table></figure>
<p>其中 PID 为 <code>18686</code> 的进程名为 <code>/usr/sbin/CROND</code>，其启动了另外两个子进程。但是在系统中检查，并不存在路径 <code>/usr/sbin/CROND</code></p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="built_in">ls</span> -l /usr/sbin/CROND</span></span><br><span class="line">ls: cannot access /usr/sbin/CROND: No such file or directory</span><br></pre></td></tr></table></figure>

<p>出现此种现象，主要是因为 <em><strong>在启动时，进程的命令名是根据路径传递给 <code>execve()</code> 函数的参数决定的，而不是直接与系统中的文件进行匹配</strong></em>。</p>
<p>在 Linux 系统中，<code>ps</code> 命令显示的进程信息是从 <code>/proc</code> 文件系统中获取的，而 <code>/proc</code> 文件系统包含有关正在运行的进程的信息，包括每个进程的命令名。因此，即使实际上系统中不存在 <code>/usr/sbin/CROND</code> 文件，但如果进程的命令名是 <code>/usr/sbin/CROND</code>，那么 <code>ps</code> 命令仍然会显示进程的命令名为 <code>/usr/sbin/CROND</code>。</p>
<p><em><strong>进程的命令名可以查看 <code>/proc/&lt;PID&gt;/cmdline</code> 文件</strong></em>，本示例中显示如下：</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="built_in">cat</span> /proc/18686/cmdline</span> </span><br><span class="line">/usr/sbin/CROND-n</span><br></pre></td></tr></table></figure>

<p>对应的系统上的可执行文件的名称可以查看 <code>/proc/&lt;PID&gt;/stat</code>、<code>/proc/&lt;PID&gt;/comm</code>、<code>/proc/&lt;PID&gt;/status</code> 等文件</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="built_in">cat</span> /proc/900/comm</span> </span><br><span class="line">crond</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="built_in">cat</span> /proc/900/status</span> </span><br><span class="line">Name:	crond</span><br><span class="line">Umask:	0022</span><br><span class="line">State:	S (sleeping)</span><br><span class="line">Tgid:	900</span><br><span class="line">Ngid:	0</span><br><span class="line">Pid:	900</span><br><span class="line">PPid:	1239</span><br><span class="line">TracerPid:	0</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="built_in">cat</span> /proc/900/stat</span></span><br><span class="line">900 (crond) S 1239 1239 1239 0 -1 4202816 1627 0 0 0 0 0 0 0 20 0 1 0 139129633 190955520 1478 18446744073709551615 94685936058368 94685936118156 140733000396032 140733000262488 140427856103840 0 0 4096 16387 18446744071797306256 0 0 17 3 0 0 0 0 0 94685938219080 94685938221648 94685948321792 140733000400770 140733000400789 140733000400789 140733000400872 0</span><br></pre></td></tr></table></figure>

<p>在本示例中，实际执行的命令为 <code>crond</code></p>
<h1 id="参考链接-Bibliography"><a href="#参考链接-Bibliography" class="headerlink" title="参考链接|Bibliography"></a>参考链接|Bibliography</h1><p><a target="_blank" rel="noopener" href="https://os.ecci.ucr.ac.cr/slides/Abraham-Silberschatz-Operating-System-Concepts-10th-2018.pdf">Operating System Concepts v10 Online</a><br><a target="_blank" rel="noopener" href="http://lionheartwang.github.io/blog/2018/06/05/linuxjin-cheng-zhuang-tai-shuo-ming/">Linux进程状态说明</a></p>
<h1 id="脚注"><a href="#脚注" class="headerlink" title="脚注"></a>脚注</h1><div id="footnotes"><hr><div id="footnotelist"><ol style="list-style: none; padding-left: 0; margin-left: 40px"><li id="fn:1"><span style="display: inline-block; vertical-align: top; padding-right: 10px; margin-left: -40px">1.</span><span style="display: inline-block; vertical-align: top; margin-left: 10px;"><a target="_blank" rel="noopener" href="https://os.ecci.ucr.ac.cr/slides/Abraham-Silberschatz-Operating-System-Concepts-10th-2018.pdf">Operating System Concepts v10 Online</a>  5.7.1 Example: Linux Scheduling<a href="#fnref:1" rev="footnote"> ↩</a></span></li></ol></div></div>
      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://csms.tech/202306091031/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="images/avatar.gif">
      <meta itemprop="name" content="COSMOS">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="L B T">
      <meta itemprop="description" content="得 能 莫 忘">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | L B T">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="202306091031/" class="post-title-link" itemprop="url">Linux man 使用</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2023-06-09 10:32:08" itemprop="dateCreated datePublished" datetime="2023-06-09T10:32:08+08:00">2023-06-09</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2024-10-15 11:10:00" itemprop="dateModified" datetime="2024-10-15T11:10:00+08:00">2024-10-15</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">上层目录</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="categories/Linux/" itemprop="url" rel="index"><span itemprop="name">Linux</span></a>
        </span>
          ，
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="categories/Linux/%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4/" itemprop="url" rel="index"><span itemprop="name">常用命令</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css"><p>在 Linux 中，命令提供的 <code>man</code> 手册是一份非常详细的命令使用说明手册，要了解命令的使用方法及其工作原理，熟练参考 <code>man</code> 手册是及其必要的。</p>
<p><code>man</code> 手册中不仅包含了命令的使用方法，还包括了命令相关的 <strong>（配置）文件说明</strong> 、 <strong>System Calls</strong> 等相关信息，下表中列出了 <code>man</code> 手册不同编号对应的功能</p>
<table>
<thead>
<tr>
<th>Section Number</th>
<th>Section Name</th>
<th>Description</th>
</tr>
</thead>
<tbody><tr>
<td><code>1</code></td>
<td><code>User Commands</code></td>
<td>用户可以在 shell 中运行的指令说明<br/><code>man</code> 命令不指定 <code>Section Number</code> 时默认为 <code>1</code></td>
</tr>
<tr>
<td><code>2</code></td>
<td><code>System Calls</code></td>
<td>应用程序中的功能函数调用的内核函数</td>
</tr>
<tr>
<td><code>3</code></td>
<td><code>C Library Functions</code></td>
<td>应用程序针对特定的函数库提供的接口</td>
</tr>
<tr>
<td><code>4</code></td>
<td><code>Devices and Special Files</code></td>
<td>程序使用的硬件或软件</td>
</tr>
<tr>
<td><code>5</code></td>
<td><code>File Formats and Conventions</code></td>
<td>涉及的文件类型（如配置文件）及约定</td>
</tr>
<tr>
<td><code>6</code></td>
<td><code>Games</code></td>
<td></td>
</tr>
<tr>
<td><code>7</code></td>
<td><code>Miscellaneous</code></td>
<td>其他杂项，如 <strong>协议</strong> 、 <strong>文件系统</strong> 、 <strong>字符集</strong> 等</td>
</tr>
<tr>
<td><code>8</code></td>
<td><code>System Administration Tools and Daemons</code></td>
<td>需要 <code>root</code> 权限或其他管理员权限运行的命令</td>
</tr>
</tbody></table>
<p>要查看命令 <code>man</code> 的某个部分，可以使用以下命令查看 <code>passwd</code> 命令的 <code>File Formats and Conventions</code></p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">man 5 passwd</span><br></pre></td></tr></table></figure>

<p><strong>环境信息</strong> ：</p>
<ul>
<li>Centos 7</li>
</ul>
<h1 id="为源码编译安装的软件安装-man-手册"><a href="#为源码编译安装的软件安装-man-手册" class="headerlink" title="为源码编译安装的软件安装 man 手册"></a>为源码编译安装的软件安装 man 手册</h1><p>使用源码编译安装的软件默认是没有 man 手册的，使用 man 命令会报以下错误</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">man fswatch</span></span><br><span class="line">No manual entry for fswatch</span><br></pre></td></tr></table></figure>

<p>要为源码编译安装的软件安装 man 手册，可以参考以下步骤，此处示例软件为 <code>fswatch</code>，软件编译安装到了 <code>/usr/local/fswatch-1.17.1/</code></p>
<ol>
<li><p>一般情况下，源码中会附带软件的使用文档，编译安装后，可能位于以下路径，<code>fswatch</code> 编译安装后的 man 手册位于 <code>/usr/local/fswatch-1.17.1/share/man/man7/fswatch.7</code></p>
 <figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">ls /usr/local/fswatch-1.17.1/doc</span><br><span class="line">ls /usr/local/fswatch-1.17.1/share/doc</span><br><span class="line">ls /usr/local/fswatch-1.17.1/share/man/</span><br><span class="line"></span><br></pre></td></tr></table></figure></li>
<li><p><code>man</code> 命令使用的文档默认来源于 <code>/usr/share/man/</code></p>
 <figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="built_in">ls</span> /usr/share/man/</span></span><br><span class="line">cs  de  fr  hu  it  ko     man1   man1x  man2x  man3p  man4   man5   man6   man7   man8   man9   mann  pl  pt_BR  ro  sk  tr  zh_CN</span><br><span class="line">da  es  hr  id  ja  man0p  man1p  man2   man3   man3x  man4x  man5x  man6x  man7x  man8x  man9x  nl    pt  pt_PT  ru  sv  zh  zh_TW</span><br></pre></td></tr></table></figure>
<p>要为编译安装软件的安装 <code>man</code> 帮助文档，首先将 <code>fswatch</code> 的帮助文档复制到 <code>man</code> 页面的目录</p>
 <figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">cp /usr/local/fswatch-1.17.1/share/man/man7/fswatch.7 /usr/share/man/man7/</span><br><span class="line"></span><br></pre></td></tr></table></figure>
</li>
<li><p>更新 <code>man</code> 索引</p>
 <figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">$ mandb</span><br><span class="line">1 man subdirectory contained newer manual pages.</span><br><span class="line">47 manual pages were added.</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>安装成功后，可以正常使用 <code>man fswatch</code> 查看帮助文档。</p>
</li>
</ol>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://csms.tech/20240816112002/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="images/avatar.gif">
      <meta itemprop="name" content="COSMOS">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="L B T">
      <meta itemprop="description" content="得 能 莫 忘">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | L B T">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="20240816112002/" class="post-title-link" itemprop="url">Linux bash 常用操作</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2024-08-14 10:52:20" itemprop="dateCreated datePublished" datetime="2024-08-14T10:52:20+08:00">2024-08-14</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2024-10-14 15:10:00" itemprop="dateModified" datetime="2024-10-14T15:10:00+08:00">2024-10-14</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">上层目录</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="categories/Linux/" itemprop="url" rel="index"><span itemprop="name">Linux</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css"><h1 id="bash-快捷键"><a href="#bash-快捷键" class="headerlink" title="bash 快捷键"></a>bash 快捷键</h1><p><code>bash</code> 常用的快捷键总结</p>
<h2 id="删除类快捷键"><a href="#删除类快捷键" class="headerlink" title="删除类快捷键"></a>删除类快捷键</h2><table>
<thead>
<tr>
<th>快捷键</th>
<th>功能</th>
<th>示例</th>
</tr>
</thead>
<tbody><tr>
<td><code>Ctrl + D</code></td>
<td>删除光标右侧的一个字符，等于 <code>Delete</code> 键</td>
<td></td>
</tr>
<tr>
<td><code>Ctrl + H</code></td>
<td>删除光标左侧的一个字符，等于 <code>Backspace</code> 键</td>
<td></td>
</tr>
<tr>
<td><code>Ctrl + K</code></td>
<td>删除从光标位置到行尾的所有字符。</td>
<td></td>
</tr>
<tr>
<td><code>Ctrl + U</code></td>
<td>删除从光标位置到行首的所有字符。</td>
<td></td>
</tr>
<tr>
<td><code>Ctrl + W</code></td>
<td>删除光标左侧的一个单词（以空格为分隔）。</td>
<td></td>
</tr>
<tr>
<td><code>Alt + D</code></td>
<td>删除光标右侧的一个单词。（空格，下划线，点分割）</td>
<td></td>
</tr>
<tr>
<td><code>Ctrl + C</code></td>
<td>删除整行</td>
<td></td>
</tr>
</tbody></table>
<h2 id="定位类快捷键"><a href="#定位类快捷键" class="headerlink" title="定位类快捷键"></a>定位类快捷键</h2><table>
<thead>
<tr>
<th>快捷键</th>
<th>功能</th>
<th>示例</th>
</tr>
</thead>
<tbody><tr>
<td><code>Ctrl + F</code></td>
<td>向前挪动一个字符 ，等于 右箭头 <code>-&gt;</code></td>
<td></td>
</tr>
<tr>
<td><code>Ctrl + B</code></td>
<td>向后挪动一个字符  ，等于 左箭头 <code>&lt;-</code></td>
<td></td>
</tr>
<tr>
<td><code>Alt + F</code></td>
<td>向前挪动一个 word</td>
<td></td>
</tr>
<tr>
<td><code>Alt + B</code></td>
<td>向后挪动一个 word              。</td>
<td></td>
</tr>
<tr>
<td><code>Ctrl + A</code></td>
<td>跳到行首。</td>
<td></td>
</tr>
<tr>
<td><code>Ctrl + E</code></td>
<td>跳到行尾。</td>
<td></td>
</tr>
</tbody></table>
<h2 id="Recall-类快捷键"><a href="#Recall-类快捷键" class="headerlink" title="Recall 类快捷键"></a>Recall 类快捷键</h2><p><code>bash</code> 中执行过的命令都保存在了历史记录中，可以通过 <code>history</code> 命令查看。为了快速重新执行或者修改之前的命令并执行，<code>bash</code> 提供了以下快捷键</p>
<table>
<thead>
<tr>
<th>快捷键</th>
<th>功能</th>
<th>示例</th>
</tr>
</thead>
<tbody><tr>
<td><code>Ctrl + R</code></td>
<td>搜索 <code>history</code> 中 <strong>最后一个</strong> 匹配的命令</td>
<td></td>
</tr>
<tr>
<td><code>Alt + P</code></td>
<td>搜索 <code>history</code> 中 <strong>最常使用</strong> 的命令</td>
<td></td>
</tr>
<tr>
<td><code>!100</code></td>
<td>重新执行 <code>history</code> 中的第 100 号的命令，无确认，会立即执行</td>
<td></td>
</tr>
<tr>
<td><code>!!</code></td>
<td>重新执行 <code>history</code> 中的 <strong>最后一个</strong> 命令，无确认，会立即执行</td>
<td></td>
</tr>
</tbody></table>
<h1 id="bash-环境变量"><a href="#bash-环境变量" class="headerlink" title="bash 环境变量"></a>bash 环境变量</h1><p><code>shell</code> 中的环境变量大体可以分为以下几种：</p>
<ul>
<li><p><code>Local Variables</code> : 当前 Shell 中的 <strong>所有的本地变量（<code>Local Variables</code>）</strong> ，要查看所有的 本地变量（<code>Local Variables</code>），可以使用以下命令：</p>
<ul>
<li><code>set</code></li>
<li><code>declare</code>  <figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="built_in">set</span> | more</span></span><br><span class="line">BASH=/bin/bash</span><br><span class="line">BASHOPTS=checkwinsize:cmdhist:complete_fullquote:expand_aliases:extglob:extquote:force_fignore:globasciiranges:histappend:interactive_comments:progcomp:promptvars:sour</span><br><span class="line">cepath</span><br><span class="line">BASH_ALIASES=()</span><br><span class="line">BASH_ARGC=([0]=&quot;0&quot;)</span><br><span class="line">BASH_ARGV=()</span><br><span class="line">...</span><br></pre></td></tr></table></figure></li>
</ul>
</li>
<li><p><code>Environment Variables</code> ： 本地变量（<code>Local Variables</code>）的一部分子集（<code>subset</code>）被稱為 <strong>环境变量（<code>Environment Variables</code>）</strong> ， <strong>环境变量（<code>Environment Variables</code>）</strong> 会被导入到任何从当前 Shell 启动的新的 Shell，要查看 <strong>环境变量（<code>Environment Variables</code>）</strong> ，使用以下命令</p>
<ul>
<li><code>env</code></li>
<li><code>printenv</code>  <figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="built_in">env</span></span></span><br><span class="line">SHELL=/bin/bash</span><br><span class="line">SESSION_MANAGER=local/U-3TSDMAL9IVFAQ:@/tmp/.ICE-unix/3396,unix/U-3TSDMAL9IVFAQ:/tmp/.ICE-unix/3396</span><br><span class="line">QT_ACCESSIBILITY=1</span><br><span class="line">COLORTERM=truecolor</span><br><span class="line">XDG_CONFIG_DIRS=/etc/xdg/xdg-ubuntu:/etc/xdg</span><br><span class="line">SSH_AGENT_LAUNCHER=gnome-keyring</span><br><span class="line">XDG_MENU_PREFIX=gnome-</span><br><span class="line">GNOME_DESKTOP_SESSION_ID=this-is-deprecated</span><br><span class="line">GTK_IM_MODULE=fcitx</span><br><span class="line">LANGUAGE=en</span><br><span class="line">LC_ADDRESS=en_US.UTF-8</span><br><span class="line">GNOME_SHELL_SESSION_MODE=ubuntu</span><br><span class="line">LC_NAME=en_US.UTF-8</span><br><span class="line">SSH_AUTH_SOCK=/run/user/408001114/keyring/ssh</span><br><span class="line">XMODIFIERS=@im=fcitx</span><br><span class="line">DESKTOP_SESSION=ubuntu</span><br><span class="line">LC_MONETARY=en_US.UTF-8</span><br><span class="line">GTK_MODULES=gail:atk-bridge</span><br><span class="line">DBUS_STARTER_BUS_TYPE=session</span><br><span class="line">...</span><br></pre></td></tr></table></figure>
  查看单个变量  <figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="built_in">echo</span> <span class="variable">$PATH</span></span> </span><br><span class="line">/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games:/snap/bin:/snap/bin</span><br><span class="line"></span><br></pre></td></tr></table></figure></li>
</ul>
</li>
</ul>
<p><strong><code>bash</code> 常用环境变量</strong> ：</p>
<table>
<thead>
<tr>
<th>环境变量</th>
<th>功能</th>
<th>示例</th>
</tr>
</thead>
<tbody><tr>
<td><code>PATH</code></td>
<td>可执行文件查找路径变量。<br/><strong>查找顺序从左向右，找到即停止</strong></td>
<td><code>$ echo $PATH</code> <br/><code>/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games:/snap/bin:/snap/bin</code></td>
</tr>
<tr>
<td><code>PS1</code><br/><code>PS[234]</code></td>
<td><code>PS1</code> 环境变量定义了 <code>bash</code> 中的命令后提示符包含的内容<br/>定义中支持的元字符可以查看 <code>man bash</code> 手册</td>
<td><code>PS1=&quot;[\u@\h \W]\\$</code></td>
</tr>
</tbody></table>
<h2 id="bash-命令查找优先级"><a href="#bash-命令查找优先级" class="headerlink" title="bash 命令查找优先级"></a>bash 命令查找优先级</h2><p><code>bash</code> 中命令执行优先顺序如下：</p>
<ul>
<li><strong>Aliases</strong> ： 由 <code>alias</code> 命令配置的命令别名。</li>
<li><strong>Shell 预留的关键字</strong> ： 主要是 Shell 编程中会用到的关键字，如 <code>do</code>、<code>while</code>、<code>case</code>、<code>else</code> 等。</li>
<li><strong>Built-in  Command</strong> ： shell 内嵌的命令，如 <code>cd</code>、<code>echo</code> 等</li>
<li><strong>Filesystem Command</strong> ： 环境变量 <code>PATH</code> 中的命令。</li>
</ul>
<p>要查找命令所在位置，可以使用 <code>type</code> 和 <code>which</code> 命令</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="built_in">type</span> bash</span></span><br><span class="line">bash is /usr/bin/bash</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="built_in">which</span> bash</span></span><br><span class="line">/usr/bin/bash</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="built_in">type</span> -a <span class="built_in">ls</span></span></span><br><span class="line">ls is aliased to `ls --color=auto&#x27;</span><br><span class="line">ls is /usr/bin/ls</span><br><span class="line">ls is /bin/ls</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<blockquote>
<p>如果要查找命令所在的所有位置，可以使用 <code>type -a ls</code>，如上所示，这会显示 <code>ls</code> 命令所在的所有位置</p>
</blockquote>
<h2 id="bash-环境变量配置优先级"><a href="#bash-环境变量配置优先级" class="headerlink" title="bash 环境变量配置优先级"></a>bash 环境变量配置优先级</h2><p>Linux 系统中的多个配置文件中可以配置环境变量，其中有些会针对所有的用户和 <code>shell</code> 生效，有些只会针对特定的用户生效。</p>
<p>以下表格中列出了常用的环境变量的配置文件：</p>
<table>
<thead>
<tr>
<th>File</th>
<th>Description</th>
</tr>
</thead>
<tbody><tr>
<td><code>/etc/profile</code></td>
<td><strong>此配置中的环境变量对所有用户生效，在用户登陆时为其配置环境变量</strong> ，它一般会加载（包含）<code>/etc/profile.d</code> 中的配置</td>
</tr>
<tr>
<td><code>/etc/bashrc</code></td>
<td><strong>此配置中的环境变量针对所有的 shell 生效，每次打开一个 <code>bash</code> 时会执行</strong> ，一般会设置包括 <strong>登陆提示</strong> 、 <strong><code>alias</code></strong> 等</td>
</tr>
<tr>
<td><code>~/.bash_profile</code></td>
<td><strong>此配置中的环境变量对 <code>当前登陆</code> 用户生效，仅在用户登陆时为其配置环境变量</strong> ，一般会加载 <code>~/.bashrc</code> 文件</td>
</tr>
<tr>
<td><code>~/.bashrc</code></td>
<td><strong>此配置中的环境变量针对 <code>当前登陆</code> 的用户 <code>bash</code> 生效，并在用户打开每个新的 <code>bash</code> 时执行</strong></td>
</tr>
<tr>
<td><code>~/.bash_logout</code></td>
<td><strong>此配置中的环境变量对 <code>当前登陆</code> 用户生效，仅在 <code>当前登陆用户登出（logout）</code> 时执行</strong></td>
</tr>
</tbody></table>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://csms.tech/20241010155400/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="images/avatar.gif">
      <meta itemprop="name" content="COSMOS">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="L B T">
      <meta itemprop="description" content="得 能 莫 忘">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | L B T">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="20241010155400/" class="post-title-link" itemprop="url">Linux Cockpit 服务</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2024-10-10 15:10:00" itemprop="dateCreated datePublished" datetime="2024-10-10T15:10:00+08:00">2024-10-10</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">上层目录</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="categories/Linux/" itemprop="url" rel="index"><span itemprop="name">Linux</span></a>
        </span>
          ，
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="categories/Linux/%E5%B8%B8%E7%94%A8%E6%9C%8D%E5%8A%A1/" itemprop="url" rel="index"><span itemprop="name">常用服务</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css"><p><a target="_blank" rel="noopener" href="https://cockpit-project.org/">Cockpit 服务官网说明</a></p>
<h1 id="Cockpit-安装"><a href="#Cockpit-安装" class="headerlink" title="Cockpit 安装"></a>Cockpit 安装</h1><p><strong>环境信息</strong>：</p>
<ul>
<li>CentOS Linux 7 (Core) 3.10.0</li>
<li>cockpit-195.12</li>
</ul>
<p><a target="_blank" rel="noopener" href="https://cockpit-project.org/running.html#centos">官网安装参考文档</a></p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">sudo yum install cockpit</span><br><span class="line"></span><br><span class="line">sudo systemctl enable --now cockpit.socket</span><br></pre></td></tr></table></figure>

<p>Cockpit 默认监听在 <code>9090</code> 端口，请在防火墙放通此端口。服务启动后，在浏览器中通过 <code>IP:9090</code> 即可登陆。</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://csms.tech/202405311003/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="images/avatar.gif">
      <meta itemprop="name" content="COSMOS">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="L B T">
      <meta itemprop="description" content="得 能 莫 忘">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | L B T">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="202405311003/" class="post-title-link" itemprop="url">操作系统导论专业词汇表</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2024-05-31 10:03:37" itemprop="dateCreated datePublished" datetime="2024-05-31T10:03:37+08:00">2024-05-31</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2024-10-09 10:10:00" itemprop="dateModified" datetime="2024-10-09T10:10:00+08:00">2024-10-09</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">上层目录</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="categories/%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0/" itemprop="url" rel="index"><span itemprop="name">读书笔记</span></a>
        </span>
          ，
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="categories/%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0/OS/" itemprop="url" rel="index"><span itemprop="name">OS</span></a>
        </span>
          ，
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="categories/%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0/OS/Operating-System-Concepts-v10/" itemprop="url" rel="index"><span itemprop="name">Operating System Concepts v10</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css"><p>Operating System Concepts v10(操作系统导论第10版)中涉及的相关专业词汇。</p>
<h1 id="memory"><a href="#memory" class="headerlink" title="memory"></a>memory</h1><h2 id="Main-Memory"><a href="#Main-Memory" class="headerlink" title="Main Memory"></a>Main Memory</h2><p><strong>Main Memory</strong> 通常是 CPU 可以直接定位和访问的唯一的大存储设备。如果 CPU 要处理磁盘上的数据，数据必须首先被传输到 <strong>Main Memory</strong>，指令要能被 CPU 执行，也必须首先载入内存中。</p>
<p><strong><code>Program</code></strong> 要能被运行，首先必须载入到内存中，并提供内存绝对地址给 CPU 以供加载指令和数据。</p>
<h2 id="Logical-Memory-Address-and-Virtual-Memory-Address"><a href="#Logical-Memory-Address-and-Virtual-Memory-Address" class="headerlink" title="Logical Memory Address and Virtual Memory Address"></a>Logical Memory Address and Virtual Memory Address</h2><p>通常情况下，CPU 生成的内存地址被称为 <code>Logical Memory Address</code>，也称为 <code>Virtual Memory Address</code>。</p>
<p>Memory-address 注册器（memory-address register）加载的地址通常称为 <code>Physical Memory Address</code>。</p>
<p>程序运行过程中，CPU 操作的是 <code>Virtual Memory Address</code>，需要由硬件设备 MMU（Memory Management Unit）负责将 <code>Virtual Memory Address space</code> 映射到对应的 <code>Physical Memory Address space</code>。程序或者是 CPU 运行过程中，不会直接操作（访问&#x2F;access）物理内存地址空间。</p>
<p><img src="https://i.csms.tech/img_243.png"></p>
<h2 id="DMA"><a href="#DMA" class="headerlink" title="DMA"></a>DMA</h2><p><code>Direct Memory Access (DMA)</code> 在 CPU 需要从存储读写大量数据到内存时，如果数据通过 CPU 中转，成本太高，为了解决这个问题，DMA 被采用，在传输大块数据时，首先在 CPU 中为数据设置好必要的 buffer、指针、计数器等资源，设备控制器（DMA Controller）直接（在磁盘和内存中）传输数据块而无须 CPU 参与实际的数据传输，只需要在数据块传输完成时，向 CPU 产生中断以指示设备控制器（DMA Controller）数据传输已完成。在 DMA 过程中，CPU 依旧可以做其他工作。 <sup id="fnref:1"><a href="#fn:1" rel="footnote"><span class="hint--top hint--error hint--medium hint--rounded hint--bounce" aria-label="[Operating System Concepts v10 Online](https://os.ecci.ucr.ac.cr/slides/Abraham-Silberschatz-Operating-System-Concepts-10th-2018.pdf) 1.2.3 I/O Structure">[1]</span></a></sup></p>
<h2 id="Dynamic-Linking-and-Shared-Libraries"><a href="#Dynamic-Linking-and-Shared-Libraries" class="headerlink" title="Dynamic Linking and Shared Libraries"></a>Dynamic Linking and Shared Libraries</h2><p>DLLs(Dynamic Linked Libraries) 是程序运行期间需要链接的系统库文件（system libraries）。<sup id="fnref:6"><a href="#fn:6" rel="footnote"><span class="hint--top hint--error hint--medium hint--rounded hint--bounce" aria-label="[Operating System Concepts v10 Online](https://os.ecci.ucr.ac.cr/slides/Abraham-Silberschatz-Operating-System-Concepts-10th-2018.pdf) 9.1.5 Dynamic Linking and Shared Libraries">[6]</span></a></sup> </p>
<p>部分操作系统不支持 DLLs 机制，只能使用 <strong>静态链接</strong>（<code>static linking</code>），在这种情况下，应用程序运行过程中需要使用的系统库文件必须和应用程序一起编译进应用程序镜像（program image）中。假如多个应用程序使用了同样的库文件，那么这些库文件会同时存在于这些应用程序的程序镜像文件中，这些应用程序运行过程中也会在内存中加载多份同样的库文件。这可能会产生以下缺点：</p>
<ul>
<li>应用程序镜像较大，占用更多磁盘空间</li>
<li>应用程序运行时，因为要加载多个同样的库文件，会占用更多的内存</li>
<li>库文件升级不灵活，要升级某个库文件，要重新编译所有使用此库文件的应用程序。</li>
</ul>
<p>DLLs(Dynamic Linked Libraries) 是在运行过程中，动态加载库文件。这个特性在系统库文件（如 standard C language library）中很常用。程序编译过程中及运行过程中动态加载系统库文件，无需将系统库文件打包进应用程序镜像中，应用程序运行过程中动态加载系统库文件，如果要加载的目标系统库文件已经存在于内存中，则无需重复加载，直接共享使用即可。DLLs 有以下优势：</p>
<ul>
<li>应用程序镜像无需包含常用的库文件，减少了磁盘使用量</li>
<li>应用程序运行时，可以在多个进程中共享库文件，无需重复加载（只存在一个库实例即可），减少了内存使用率并提升了内存效率</li>
<li>共享库文件升级后，所有加载此库文件的应用程序都可以直接使用更新后的新版本。<strong>应用程序和库文件中都包含了相应的版本信息，会防止应用程序使用错误的库版本</strong></li>
<li>内存中可以加载多个版本的共享库文件，应用程序会使用自己的库文件版本信息加载正确的库文件</li>
</ul>
<h2 id="Memory-Allocation"><a href="#Memory-Allocation" class="headerlink" title="Memory Allocation"></a>Memory Allocation</h2><h3 id="Fragmentation"><a href="#Fragmentation" class="headerlink" title="Fragmentation"></a>Fragmentation</h3><p>假设在一个全新的未运行任何应用程序的操作系统中，初始情况下内存中存在一整块连续的可用地址范围（one large block of available memory），或者叫一个 <code>Hole</code>。</p>
<p>假设如下图所示情况，系统中运行了 processes 5, 8, and 2 并且占用了所有的内存地址范围。之后 process 8 退出，其所使用的内存释放，形成了一个 <code>Hole</code>，随后 process 9 开始运行并申请了一段内存，随后 process 5 退出并释放内存，导致内存中出现了 2 个地址非连续（noncontigous）的 <code>Hole</code>。<strong>随着系统中进程的运行和退出，内存中可能会存在很多大小不一，地址范围不连续的 Hole</strong>，这些 <code>Hole</code> 既是 <strong>外部内存碎片（<code>External Memory Fragmentation</code>）</strong></p>
<p><img src="https://i.csms.tech/img_244.png"></p>
<p><strong>外部内存碎片（<code>External Memory Fragmentation</code>）</strong> 存在时，可能出现系统有足够多的空闲内存（非连续的地址空间，内存碎片）但是这些内存都是内存碎片。</p>
<p>在现代的内存管理中，内存的分配一般是以 <code>block</code> 为单位进行分配，<code>block</code> 是一个固定大小的内存。在这种情况下，假如 <code>block</code> 大小为 512 bytes，应用程序申请了 600 bytes 内存，那么需要分配 2 个 <code>block</code> 给应用程序，实际分配了 1024 bytes 。申请的内存（600 bytes）和实际分配的内存（2 blocks &#x3D; 1024 bytes）之间的差值被称为 <strong><code>内部内存碎片</code>（Internal Memory Fragmentation）</strong></p>
<h2 id="Paging"><a href="#Paging" class="headerlink" title="Paging"></a>Paging</h2><p>在当前的操作系统中，解决 <strong>外部内存碎片（<code>External Memory Fragmentation</code>）</strong> 的问题，通用解决方法是采用 <strong>内存页（Memory Paging）</strong> 技术： <strong>应用程序申请的 Logical 内存&#x2F;Physical 内存地址非连续（横跨多个 Hole）</strong></p>
<p>Paging 解决了 <strong>外部内存碎片（<code>External Memory Fragmentation</code>）</strong> 的问题，没有解决 <strong><code>内部内存碎片</code>（Internal Memory Fragmentation）</strong></p>
<h2 id="Virtual-Memory"><a href="#Virtual-Memory" class="headerlink" title="Virtual Memory"></a>Virtual Memory</h2><p>Virtual Memory 提供了 <strong>允许程序运行过程中，无需将整个程序内容全部加载到内存中的技术</strong> <sup id="fnref:7"><a href="#fn:7" rel="footnote"><span class="hint--top hint--error hint--medium hint--rounded hint--bounce" aria-label="[Operating System Concepts v10 Online](https://os.ecci.ucr.ac.cr/slides/Abraham-Silberschatz-Operating-System-Concepts-10th-2018.pdf) CHAPTER 10 Virtual Memory">[7]</span></a></sup></p>
<p>主要有以下优势：</p>
<ul>
<li>程序大小可以大于物理内存空间。开发者不必再关注物理内存是否足够。</li>
<li>Virtual Memory 将 main memory 抽象成一个统一的大存储阵列，基于此，程序开发者可以不用关注物理内存的差异和限制。</li>
<li>允许进程共享文件和库，并实现了共享内存（shared memory）。</li>
</ul>
<h2 id="Page-Fault"><a href="#Page-Fault" class="headerlink" title="Page Fault"></a>Page Fault</h2><p>Virtual Memory 提供了 <strong>允许程序运行过程中，无需将整个程序内容全部加载到内存中的技术</strong>，实现此技术主要使用了 <code>Demand Paging</code> 技术，使用 <code>demand-paged virtual memory</code>，可以实现程序运行过程中，仅仅在 <strong>运行过程中必须的 pages 才会被加载到内存中，那些没有用到的 pages 永远不会加载到物理内存中</strong>，<code>Demand Pageing</code> 也是 Virtual Memory 的一个主要优势。</p>
<p><code>Demand Paging</code> 技术的实现依赖于硬件的支持和 <code>Page Fault</code> 技术。</p>
<p>根据 <code>Demand Paging</code> 方案的原则，<strong>程序运行过程中用不到的 Pages 不应该被加载到内存中</strong>。因此，当一个程序刚刚启动时，它之后运行过程中所需的 Pages 理论上都不在内存中，而是存在于次级存储（secondary storage，如磁盘或者 swap）中，如果 <strong>程序运行过程中需要内存中不存在的 Pages，这时就要有机制确保实现将程序运行所需的 Pages 加载到内存中来，并且只是加载程序运行所需的 Pages，而不会加载用不到的 Pages</strong>，实现此机制的技术叫 <code>Page Fault</code>。</p>
<p><code>Page Fault</code> 需要硬件支持，主要是内存组件中的硬件设备（Paging Hardware，负责 page table 内存地址转换），当程序运行过程中需要不存在于内存中的 Pages 时，会向 OS 产生一个 <code>Page Fault</code> 的 trap，此 trap 是一个 OS Failure（指示所需 Pages 不在内存中），硬件会注意到此 OS Failure 并进行相应处理。</p>
<p>操作系统处理 <code>Page Fault</code> 的简要工作流程如下：</p>
<ol>
<li>检查并确保此内存请求合法后，如果所需的 pages 不在内存中，开始将其加载入内存（page in）</li>
<li>在物理内存中找到空闲的 frame（free frame）</li>
<li>向次级存储（secondary storage，如磁盘或者 swap）发送读取所需 Pages 到新分配的 frame 的请求</li>
<li>当存储（Pages）读取到内存完毕后，修改程序所属的 internal table 和 page table 以指示所需的 Pages 已经在内存中 </li>
<li>重新启动因为缺少所需 Pages 而被中断（interrupted）的指令（instruction）</li>
</ol>
<p><img src="https://i.csms.tech/img_246.png"></p>
<h3 id="Major-Page-Fault"><a href="#Major-Page-Fault" class="headerlink" title="Major Page Fault"></a>Major Page Fault</h3><p><code>Major Page Fault</code> 发生于所需要的 Page 不在内存中，这是系统需要在物理内存中找到可用的 Frames，然后将数据从 <strong>次级存储（secondary storage，如磁盘或者 swap）</strong> 读取到内存中并更新对应的  <code>internal table</code> 和 <code>page table</code> 以指示所需的 Pages 已经在内存中</p>
<h3 id="Minor-Page-Fault"><a href="#Minor-Page-Fault" class="headerlink" title="Minor Page Fault"></a>Minor Page Fault</h3><p><code>Minor Page Fault</code> 发生在以下 2 中情况：</p>
<ol>
<li>应用程序需要引用共享库，此共享库已经在内存中，但是应用程序的 <code>page table</code> 中没有到此共享库所在内存页的 mapping。此种情况下，只需要更新应用程序的 <code>page table</code>，向其中添加到共享内存库所在内存页的引用。</li>
<li>Virtual Memory 中的 Page 被应用程序释放（reclaimed），对应物理内存 Frame 被标记为 <code>free-frame</code>，但是上面的数据未被 <code>zeroed out</code>，此时 Page 被分配给其他应用程序。</li>
</ol>
<p>Linux 系统中，使用 <code>ps</code> 命令的 <code>-eo min_flt,maj_flt,cmd</code> 参数可以查看进程相关的 major 和 minor page fault。</p>
<h2 id="Page-Relpacement"><a href="#Page-Relpacement" class="headerlink" title="Page Relpacement"></a>Page Relpacement</h2><p>现代的操作系统内存，一般都允许 <strong>超分配（over-allocating）</strong>，即允许操作系统分配比实际的物理内存更多的内存给应用程序，当一个应用程序运行过程中，因为 Page Fault 要 Page In 时，可能会出现物理内存不足（no free frames on the free-frame list）的情况，此时操作系统会尽最大可能的满足应用程序对内存的申请。以前的操作系统大都采用 Swap 来实现，即将当前未在 CPU 上运行的应用程序使用的内存 swap out 到 Swap 中，并将空余出来的内存分配给要运行的程序使用。<strong>Swap 技术已被当前大多数操作系统摈弃，因为其在内存和 Swap 中拷贝数据成本太高</strong>，取而代之的技术是 <code>Page Repalcement</code>。</p>
<p>使用 Page Relpacement 技术，在物理内存不足时，使用 page-replacement 算法找到物理内存中的 Frames（victim frames），将其上的内容写入（<strong>如果其上内容未改变，不用执行写入操作，如果内容改变，执行写操作</strong>）到次级存储（secondary storage），如果之后的运行过程中，应用程序需要这些数据，它会产生 Page Fault，这些数据会被重新加载回内存中。 </p>
<h2 id="Memory-Compression"><a href="#Memory-Compression" class="headerlink" title="Memory Compression"></a>Memory Compression</h2><p><code>Memory Compression</code> 是在物理内存不够时，使用的一种可替代 <code>Page Repacement</code> 的技术。在系统内存不足时，系统不执行 <code>Page Replacement</code>，而是先对选择出的 <code>victim frames</code> 执行内存压缩，将多个 frames 压缩成一个 frame 进而降低内存使用率，而无需进行 <code>Page Swapping out</code> 操作。</p>
<blockquote>
<p>移动设备操作系统，包括 Android 和 IOS 都不支持 <code>Swap</code> 和 <code>Page Repalcement</code>，都采用了 <code>Memory Compression</code> 技术作为 Memory Management strategy 的一部分</p>
<p><strong>在性能方面，<code>Memory Compression</code> 拥有比 <code>Page Repalcement</code> 更快的速度。</strong></p>
</blockquote>
<h2 id="Kernel-Memory"><a href="#Kernel-Memory" class="headerlink" title="Kernel Memory"></a>Kernel Memory</h2><p>内核（kernel）使用的内存和用户模式（user mode space）中的应用程序使用的内存分配机制不同。主要基于以下原因： <sup id="fnref:8"><a href="#fn:8" rel="footnote"><span class="hint--top hint--error hint--medium hint--rounded hint--bounce" aria-label="[Operating System Concepts v10 Online](https://os.ecci.ucr.ac.cr/slides/Abraham-Silberschatz-Operating-System-Concepts-10th-2018.pdf) 10.8 Allocating Kernel Memory">[8]</span></a></sup></p>
<ul>
<li>Kernel 中的数据结构大小差异很大，很多都比 Page Size 要小，内存使用不当会导致非常多的 <code>internal fragmentation</code>，导致内存严重浪费。而且很多操作系统并未将内核代码放置到 Paging Memory 中。</li>
<li><code>user-mode</code> 中的应用程序分配的内存在物理内存地址上没必要是连续地址空间，然而内核中包含的很多硬件设备都需要直接通过物理内存进行交互，无法使用 <code>Virtual Memory Interface</code>，因此需要内存中连续的地址空间（contiguous pages）分配</li>
</ul>
<h1 id="CPU"><a href="#CPU" class="headerlink" title="CPU"></a>CPU</h1><h2 id="SMP"><a href="#SMP" class="headerlink" title="SMP"></a>SMP</h2><p><code>Symmetric Multiprocessing (SMP)</code>，对称处理系统，在系统中存在多个处理器，每个处理器中包含一个或多个 CPU，每个 CPU 有自己的 L1 Cache （CPU 独享）和 Register，每个处理器有 L2 Cache（处理器中的多个 CPU 共享 L2 cache），同一个处理器中的 CPU 使用处理器内部通信系统通信，跨处理器的 CPU 之间通过系统总线（Bus）通信。 <sup id="fnref:2"><a href="#fn:2" rel="footnote"><span class="hint--top hint--error hint--medium hint--rounded hint--bounce" aria-label="[Operating System Concepts v10 Online](https://os.ecci.ucr.ac.cr/slides/Abraham-Silberschatz-Operating-System-Concepts-10th-2018.pdf) 1.3.2 Multiprocessor Systems">[2]</span></a></sup></p>
<h2 id="NUMA"><a href="#NUMA" class="headerlink" title="NUMA"></a>NUMA</h2><p><strong>系统中的处理器不宜太多，多处理器可以提高系统的任务处理能力，但是当 CPU 过高时，对系统总线的争抢会成为系统瓶颈。</strong></p>
<p>为了避免太多 Processors 争抢系统总线造成的性能下降，一个可选的 方法是为每个 CPU（或 CPU 集）提供专用的本地内存，CPU 通过一个更小更快的本地 bus 连接专用的本地内存。所有的 CPU 通过一个 <strong>内部通信系统</strong> 进行连接，所有 CPU 共享同一个物理地址空间，这种架构被称为 <code>Non-uniform Memory Access (NUMA)</code></p>
<p><img src="https://i.csms.tech/img_236.png"></p>
<h2 id="Program-and-Process"><a href="#Program-and-Process" class="headerlink" title="Program and Process"></a>Program and Process</h2><p><strong><code>Program</code></strong> 是一个静态实体，只是存储在操作系统中的文件（集合）</p>
<p><strong><code>Process</code></strong> 是操作系统上的活动（Active）实体，是 <strong><code>Program</code></strong> 由操作系统加载运行之后的实体。</p>
<p><strong><code>Process</code></strong> 运行过程中需要操作系统为其分配各种资源，如 CPU、Memory、Files、IO 等来完成其运行。</p>
<p>如果一个 <strong><code>Program</code></strong> 被操作系统运行（启动）了多次，那么其产生的多个 <strong><code>Process</code></strong>  属于分割（单独）的实体。</p>
<h3 id="Process-Control-Block"><a href="#Process-Control-Block" class="headerlink" title="Process Control Block"></a>Process Control Block</h3><p>PCB (<code>Process Control Block</code>) 代表了 OS 中进程（Process）的各种信息，包括</p>
<ul>
<li><code>Process State</code> : 进程当前的状态</li>
<li><code>Program counter</code> : 程序计数器指针。指向了当前进程中下一个要执行的指令的地址。</li>
<li><code>CPU registers</code> : 根据计算机架构的不同，可能包括计数器、栈指针（stack pointers）、通用指针（general-purpose registers）等。</li>
<li><code>CPU-scheduling information</code> : 包括进程优先级（process priority）信息、调度队列指针（pointers to scheduling queues）以及其他调度参数等。</li>
<li><code>Memory-management information</code> : 进程使用的内存信息</li>
<li><code>Accounting information</code> : CPU 数量和 CPU 使用时间，CPU 使用限制，进程数量等信息</li>
<li><code>I/O status information</code> : 分配给进程的 IO 设备，打开的文件列表等。</li>
</ul>
<p><img src="https://i.csms.tech/img_240.png"></p>
<h2 id="Scheduling-Queues"><a href="#Scheduling-Queues" class="headerlink" title="Scheduling Queues"></a>Scheduling Queues</h2><p><img src="https://i.csms.tech/img_241.png"></p>
<ul>
<li><code>ready queue</code> : 进程开始后，会被放入 <code>ready queue</code>，等待 CPU 被分配给它。<code>ready queue</code> 是一个 <strong>链接队列</strong>，其首部包含一个指向队列中第一个 PCB 的指针，每个 PCB 都包含一个指针，指向 <code>ready queue</code> 中的下一个 PCB。</li>
<li><code>wait queue</code> : 当 <code>ready queue</code> 中的进程被分配了 CPU 后，其执行一段时间后会中止或者是等待特殊事件，如 IO，在起等待的过程中会被放入 <code>wait queue</code></li>
</ul>
<blockquote>
<p><strong>操作系统负载（system load）</strong> 衡量的就是在 Scheduling Queues 中的进程（线程）的数量。即有多少任务等待 CPU 空闲以运行。</p>
</blockquote>
<h2 id="Context-Switch"><a href="#Context-Switch" class="headerlink" title="Context Switch"></a>Context Switch</h2><p>CPU 会频繁的调度（因为 CPU Schedule 或 Interrupts）不同的进程来执行，当调度发生，OS 需要保存当前进程的上下文信息（Context）以备当前进程再次开始执行时恢复 Context，Context 信息保存在 <a href="#Process-Control-Block">PCB</a> 中</p>
<p>切换 CPU core 要保存当前进程的 Context (到 PCB)并恢复另一个进程的 Context（从 PCB），这个过程被称为 <code>Context Switch</code></p>
<p><img src="https://i.csms.tech/img_242.png"></p>
<blockquote>
<p>在现代化的操作系统上，OS 调度的更多的是 <code>kernel-level threads</code>，而不是 <strong>processes （进程）</strong></p>
</blockquote>
<h2 id="Processor-Affinity"><a href="#Processor-Affinity" class="headerlink" title="Processor Affinity"></a>Processor Affinity</h2><p>Processes 在指定的 CPU 上运行的过程中，一般会加载数据到 CPU 的 cache 中，下一次调度到同一个 CPU 运行时，仍然可以使用 Cache 中的数据（称为 <code>warm cache</code>）。 <sup id="fnref:5"><a href="#fn:5" rel="footnote"><span class="hint--top hint--error hint--medium hint--rounded hint--bounce" aria-label="[Operating System Concepts v10 Online](https://os.ecci.ucr.ac.cr/slides/Abraham-Silberschatz-Operating-System-Concepts-10th-2018.pdf) 5.5.4 Processor Affinity ">[5]</span></a></sup></p>
<p>假如后续 CPU 调度时，此进程被调度到了另一个 CPU，那么原来 CPU Cache 中的数据就要失效，新的 CPU 必须从新加载数据到 Cache 中。<strong>因为让 CPU Cache 中的数据失效和加载 Memroy 中的数据到 Cache 中是一个成本较高的操作，现代的 SMP 操作系统都会避免这类缓存迁移操作，会尽量将进程调度到同一个 CPU 以使用 <code>warm cache</code> 数据</strong>，这就是 <code>Processor Affinity</code>，一个进程对其正在运行的 CPU 拥有亲和性。</p>
<p>常见的 CPU 亲和性（Processor Affinity）有两类：</p>
<ul>
<li><code>soft affinity</code> : 尽量保证一个进程被调度到同一个 CPU，但是不保证一定，尽最大可能</li>
<li><code>hard affinity</code> : 允许配置进程只运行在选定的 CPU 集（subset of processors）</li>
</ul>
<p>大多数系统同时实现了以上两种类型。 </p>
<h1 id="Disk"><a href="#Disk" class="headerlink" title="Disk"></a>Disk</h1><p>可以将 NVS （<code>Nonvolatile Storage (NVS)</code>）根据硬盘组成划分成 2 大类</p>
<ul>
<li>机械硬盘（Mechanical）： HDDs，Optical Disks，Holographic storage，Magnetic Tape。</li>
<li>Electrical（NVM）： Flash Memory，FRAM，NRAM，SSD</li>
</ul>
<h2 id="HDD"><a href="#HDD" class="headerlink" title="HDD"></a>HDD</h2><p><img src="https://i.csms.tech/img_247.png"><br>HDD （Hard Disk Driver）的主要组成如上图。主要包括以下主要组件： <sup id="fnref:9"><a href="#fn:9" rel="footnote"><span class="hint--top hint--error hint--medium hint--rounded hint--bounce" aria-label="[Operating System Concepts v10 Online](https://os.ecci.ucr.ac.cr/slides/Abraham-Silberschatz-Operating-System-Concepts-10th-2018.pdf) 11.1.1 Hard Disk Drives">[9]</span></a></sup></p>
<ul>
<li><p><code>Platter</code><br>  Platter 的两面由磁性材料（magnetic material）覆盖组成。</p>
</li>
<li><p><code>Read-Write Head</code><br>  Platter 的两面分别有个 <code>Read-Write Head</code> (读写磁头) 负责在磁碟（Platter）上写入&#x2F;读取数据。磁头和 Platters 之间一般由一层非常薄的气体作为保护层，如氦气（helium），磁头和 Platter 表面接触会造成 Platter 表面的磁性材料损坏，这被称为 <code>Head Crash</code>，一般无法修复，磁盘上面数据会丢失。</p>
</li>
<li><p><code>Disk Arm</code><br>  Disk Arm 连接了 <code>Read-Write Head</code> (读写磁头) 和 <code>Arm Assembly</code>，<code>Read-Write Head</code> (读写磁头) 通过 Disk Arm 的移动来寻址到不同的存储单元。</p>
</li>
<li><p><code>Tracks</code><br>  Platter 的面被（逻辑&#x2F;Logically）分割成圆弧形（两个不同半径的圆分割组成的部分）</p>
</li>
<li><p><code>Sectors</code><br>  <code>Tracks</code> 被逻辑（Logically） 分割成 <code>Sectors</code>  （扇形），Sectors 是 HDD 磁盘上最小的传输单元，一般有固定大小的存储空间（2010 年前一般是 512 bytes，之后大多升级到了 4KB）。每个 Track 上面包含多个 Sectors。</p>
</li>
<li><p><code>Cylinder</code><br>  每个 Platter 上面，固定位置的 <code>Disk Arm</code> &#x2F; <code>Read-Write Head</code> 垂直组成的存储单元组成一个 <code>Cylinder</code> 。每个磁盘上面会包含很多个同心的（Concentric） Cylinder</p>
</li>
</ul>
<p>HDD 磁盘中包含一个高速旋转的 <strong>马达（disk driver motor）</strong>，HDD 磁盘的传输速度（<code>Transfer Rate</code>）和马达的旋转速度相关，通常使用 <strong><code>RPM(Rotations Per Minute)</code></strong> 来衡量 HDD 磁盘的转速，通常在 5400&#x2F;7200&#x2F;15000 RPM。有些 HDD 磁盘在电量不足或者使用频率低时会降低 RPM 来节能和提高磁盘使用寿命。</p>
<p><code>Transfer Rate</code> 是衡量数据在 HDD 磁盘和操作系统之间传输速度的指标。这个性能指标主要受到 <strong>寻址时间（Positioning Time）</strong> 或者叫 <code>Random-Access Time</code> 的影响，这个时间主要由 2 部分组成，一般在 <strong>几毫秒（several milliseconds）</strong></p>
<ol>
<li><code>Seek Time</code> : Disk Arm 移动到目标 Cylinder 的时间</li>
<li><code>Rotational Latency</code> : 目标 Sector 移动到 Disk Read Wirte Head 的延迟。</li>
</ol>
<h2 id="NVM"><a href="#NVM" class="headerlink" title="NVM"></a>NVM</h2><p> <code>Nonvolatile Memory Devices (NVM)</code> 使用电特性（Electrical）存储，而不是机械（mechanical）特性，相比 HDD，其拥有更高的可靠性和性能（没有 Seek Time 和 Rotational Latency），更加的省电，劣势是他们价格相对 HDD 更贵并且存储空间相对较小，但是随着时间推移，这些劣势也会逐渐消弭。</p>
<p>NVM 存储的 <strong>写入性能</strong> 通常和其存储可用大小相关，因为 NVM 设备内部通常会保留部分空间用于 <code>Garbage Collection</code> 和 <code>Over-Provisioning</code>（通常为 20%），如果可用空间小，会导致 <strong>写性能</strong> 下降。</p>
<p><strong>NVM 设备的寿命和其 Erase 的次数正相关</strong></p>
<h2 id="Error-Detection-and-Correction"><a href="#Error-Detection-and-Correction" class="headerlink" title="Error Detection and Correction"></a>Error Detection and Correction</h2><p><strong>Error Detection</strong> 是计算机系统中最基础的功能之一，普遍用于 Memory、Network、Storage 系统中。Error Detection 的常见功能包括：</p>
<ul>
<li>检测存储中存储的数据是否发生了（错误&#x2F;非自发&#x2F;无意的）改变，比如某个数据位由 0 变为了 1</li>
<li>网络数据在传输过程中发生了改变</li>
<li>存储设备上的数据读写不一致。<br>通过检测这些错误，可以防止在使用这些错误数据之前对其进行修正或者是发送通知给使用者。</li>
</ul>
<h3 id="Parity-Bit"><a href="#Parity-Bit" class="headerlink" title="Parity Bit"></a>Parity Bit</h3><p>Memory 长使用 <code>Parity Bit (奇偶校验位)</code> 算法进行 Error Detection，Memory 系统中的每个 Byte 都有一个对应的 <code>Parity Bit</code>，此 <code>Parity Bit</code> 记录了对应的 byte 中 <code>1</code> 出现的次数是 <strong>偶数（even，<code>Parity Bit = 0</code>）</strong> 还是 <strong>奇数(odd, <code>Parity Bit = 1</code>)</strong></p>
<p>根据 <code>Parity Bit</code> 算法的计算结果，会出现以下情况：</p>
<ul>
<li>Memory 中的一个 byte 中的一个 bit 位发生了改变，那么此 byte 计算出的 Parity Bit 值和保存的 Parity Bit 值不一样，<strong>说明数据不可靠</strong></li>
<li>Memory 中的一个 byte 中的任何 bit 都正常，但是保存的 Parity Bit 值发生了变化，那么此 byte 计算出的 Parity Bit 值和保存的 Parity Bit 值不一样，<strong>说明数据不可靠</strong></li>
<li>Memory 中的一个 byte 计算出的 Parity Bit 值和保存的 Parity Bit 值一致，<strong>说明数据可靠</strong></li>
</ul>
<p><strong>Parity Bit 无法检测 2 个 bit 位的错误，因为 2 个 bit 位的数据错误，其正确计算出来 Parity Bit 的值不变。</strong></p>
<p><strong>Parity Bit 容易实现并且计算起来非常的快，但是因为 Parity Bit 的存在，会为每个 byte 增加一个 bit 的大小</strong></p>
<h3 id="CRCs"><a href="#CRCs" class="headerlink" title="CRCs"></a>CRCs</h3><p>CRCs (Cyclic Redundancy Check) 是网络传输中常用的 Error Detection 算法。可以检测到多个 bit 位的错误。</p>
<h3 id="ECC"><a href="#ECC" class="headerlink" title="ECC"></a>ECC</h3><p>ECC (Error Correction Code) 算法不仅可以检测到数据错误，并且可以尝试恢复数据。</p>
<h2 id="EEPROM"><a href="#EEPROM" class="headerlink" title="EEPROM"></a>EEPROM</h2><p><code>EEPROM(Electrically Erasable Programmable Read-Only Memory)</code> 是主板上的一个 NVM Flash Memory Firmware。</p>
<p>服务器上电运行后启动的第一个程序是 <code>bootstrap loader program</code> （操作系统启动引导程序，如 Linux 中的 <code>grub2</code>，其启动之后会加载操作系统）。RAM 是易失性存储，不能将 <code>bootstrap program</code> 放置到 RAM 中，当下主机会使用 EEPROM 放置 <code>bootstrap program</code>。<code>bootstrap program</code> 可以被修改，但是不能频繁修改，它属于慢速存储，其中包含了不经常会使用的静态程序和数据。比如 iPhone 使用了 EEPROM 存储了设备 <code>serial numbers</code> 和 <code>hardware information</code></p>
<h2 id="RAID"><a href="#RAID" class="headerlink" title="RAID"></a>RAID</h2><p><code>RAID (Redundant Arrays of Independent Disks)</code> 。</p>
<h3 id="RAID-0-Striping-Volume"><a href="#RAID-0-Striping-Volume" class="headerlink" title="RAID 0: Striping Volume"></a>RAID 0: Striping Volume</h3><p>RAID 0，Striping Volume，条带卷，在多个存储设备上面，以 Block 为基本单位组成条带（Strip），数据分散写入到每个存储设备的对应的条带上，读取时从多个设备上的对应条带中读取。</p>
<ul>
<li><strong>不提供任何冗余（Redundancy）</strong>，任意存储设备损坏，会导致整个存储系统上的数据损坏</li>
<li><strong>有极高的读写速度</strong>，在多个设备上并发的读写</li>
<li><strong>存储设备利用率 100%</strong></li>
</ul>
<h3 id="RAID-1-Mirrored-Volume"><a href="#RAID-1-Mirrored-Volume" class="headerlink" title="RAID 1: Mirrored Volume"></a>RAID 1: Mirrored Volume</h3><p>由 2 或多块物理存储设备（physical storage device）组成一个逻辑存储设备（logical disk），每次写入数据时，同时写入到 2 个或多个物理存储设备。</p>
<ul>
<li><strong>提供冗余（Redundancy）</strong>，数据同时写入 2 个或多个物理存储设备上，只有在所有数据盘都损坏的情况下数据才会损坏</li>
<li><strong>有极高的读取速度</strong>，可以从每个镜像盘读取数据</li>
<li><strong>数据写入速度降低</strong>，因为要将数据写入多个数据盘，可能会导致写入速度下降</li>
<li><strong>存储设备利用率 50%</strong></li>
</ul>
<h3 id="RAID-4-Block-Interleaved-Parity"><a href="#RAID-4-Block-Interleaved-Parity" class="headerlink" title="RAID 4: Block-Interleaved Parity"></a>RAID 4: Block-Interleaved Parity</h3><p>RAID 4 使用 RAID 0 的 Strip（条带）作为基础，至少需要 3 块数据盘。数据存储以 Block 为单位。</p>
<p>假设由 3 块数据盘组成 RAID 4，数据写入过程如下：</p>
<ol>
<li>写入数据的第一个 block 写入到第 1 块数据盘中，第二个 block 写入到第 2 块数据盘中，对写入第一块盘和第二块盘上的这 2 个 block 做 Error Correcting Code 计算，计算结果存储在第 3 块数据盘中。</li>
<li>第三个 block 继续写入到第 1 块数据盘中，第四个 block 写入到第 2 块数据盘中，对此 2 个 block 做 Error Correcting Code 计算，计算结果存储在第 3 块数据盘中</li>
<li>依次类推，直到数据写入完成。</li>
</ol>
<ul>
<li>其中一块盘存储了 Error Correction Code</li>
<li>假如其中一个数据盘或其上的一个 Block 损坏，那么这块数据可以根据其他盘上的数据和 Error Correction Code 做计算进行恢复</li>
<li><strong>有极高的读写速度</strong>，在多个设备上并发的读写。</li>
<li><strong>存储设备利用率 (N-1)&#x2F;N</strong></li>
</ul>
<h3 id="RAID-5-Block-Interleaved-Distributed-Parity"><a href="#RAID-5-Block-Interleaved-Distributed-Parity" class="headerlink" title="RAID 5: Block-Interleaved Distributed Parity"></a>RAID 5: Block-Interleaved Distributed Parity</h3><p>和 RAID 4 唯一的不同是： <strong>RAID 4 使用一个单独的盘存储了 Error Correction Code（Parity Bit），RAID 5 将 Error Correction Code（Parity Bit）分布存储在所有数据盘上</strong>，通过将 Parity 分布到所有的数据盘上，避免了专用的 Parity Block 的盘压力太大。</p>
<h3 id="RAID-6-P-Q-redundancy-scheme"><a href="#RAID-6-P-Q-redundancy-scheme" class="headerlink" title="RAID 6: P + Q redundancy scheme"></a>RAID 6: P + Q redundancy scheme</h3><p>RAID 6 为每 4 个 Block 保留了 2 个冗余（Redundant）的 Block，使用了更复杂的算法来进行 Error Detect 和 Error Correcting，可以支持 2 块数据盘损坏。</p>
<h3 id="RAID-10"><a href="#RAID-10" class="headerlink" title="RAID 10"></a>RAID 10</h3><p><img src="https://i.csms.tech/img_248.png"><br>RAID 10 的结构：</p>
<ul>
<li>首先将硬盘分成多个镜像组（RAID 1），每个镜像组包含两个或多个硬盘。</li>
<li>然后将这些镜像组组合成一个条带组（RAID 0）。</li>
</ul>
<p>优缺点：</p>
<ul>
<li><p>高数据冗余：每个数据块都有一个镜像副本，因此可以抵抗单个硬盘故障。</p>
</li>
<li><p>高读写性能：通过条带化技术，可以提高读写速度。</p>
</li>
<li><p>成本较高：需要至少四个硬盘，而且有效存储容量只有硬盘总数的一半。</p>
</li>
</ul>
<h3 id="RAID-01"><a href="#RAID-01" class="headerlink" title="RAID 01"></a>RAID 01</h3><p>RAID 01 的结构：</p>
<ul>
<li>首先将硬盘分成多个条带组（RAID 0），每个条带组包含两个或多个硬盘。</li>
<li>然后将这些条带组组合成一个镜像组（RAID 1）。</li>
</ul>
<p>优缺点：</p>
<ul>
<li><p>高读写性能：通过条带化技术，可以提高读写速度。</p>
</li>
<li><p>数据冗余：整个条带组被镜像，因此可以抵抗硬盘故障。</p>
</li>
<li><p>成本较高：需要至少四个硬盘，而且有效存储容量只有硬盘总数的一半。</p>
</li>
<li><p>数据恢复复杂：如果一个硬盘发生故障，整个条带组都需要被重建，恢复时间较长。</p>
</li>
</ul>
<p><strong>RAID 10 和 RAID 01 在单一硬盘故障时的恢复方式基本一致，都是从对应的镜像组恢复数据到故障硬盘。</strong> 在涉及到多个硬盘的故障的情况下，RAID 10 相比 RAID 01 拥有更多的优势：</p>
<ul>
<li>RAID 10 提供了更高的冗余性和恢复灵活性，因为它允许多个独立的镜像组。</li>
<li>RAID 10 可以承受每个镜像组中的一个硬盘故障而不影响整体系统。</li>
<li>RAID 01 在任一条带组中失效的硬盘超过一个时，会导致整个 RAID 组不可用。</li>
</ul>
<h1 id="File-System"><a href="#File-System" class="headerlink" title="File System"></a>File System</h1><p><code>File Systems</code> 为访问（<code>stored</code>、<code>located</code>、<code>retrieve</code>）存储系统（Storage）上存储的文件提供了高效和便利的途径（方式）。文件系统的设计主要涉及到以下问题： <sup id="fnref:10"><a href="#fn:10" rel="footnote"><span class="hint--top hint--error hint--medium hint--rounded hint--bounce" aria-label="[Operating System Concepts v10 Online](https://os.ecci.ucr.ac.cr/slides/Abraham-Silberschatz-Operating-System-Concepts-10th-2018.pdf) 14.1 File-System Structure">[10]</span></a></sup></p>
<ul>
<li>File System 对用户（User）应该如何呈现。包括如何定义文件以及文件属性，允许哪些操作，目录结构是怎样的（如何组织）</li>
<li>使用怎样的算法来创建文件或者目录结构，以及如何将逻辑上的文件（logical files system）和物理存储（硬件）上的内容进行对应</li>
</ul>
<p>File System 通常由多个功能分层（Levels or layers）构成，其中 <strong>下层为上层提供服务，上层利用下层提供的服务来构建文件系统的功能（特性）</strong></p>
<p><img src="https://i.csms.tech/img_258.png"></p>
<p>在如上图所示的分层的文件系统架构中，主要包括以下层：</p>
<ul>
<li><code>I/O control</code> : 主要由存储设备驱动器（Device Drivers）和中断控制器（interrupt handlers）组成。主要功能是在存储设备和主内存之间传输数据。它接受更高层的指令（如 <code>retrieve block 123</code>），并将此指令转换为能被存储设备驱动器识别的针对存储硬件设备的指令。</li>
<li><code>basic file system</code> : 在 Linux 系统中被称为 <code>“block I/O subsystem</code>。这一层的主要功能是将上层的通用的读写 block 的指令发布给正确的存储设备驱动器（device driver）来读写存储设备上的 block。它发送给存储设备驱动器（device driver）的是 <strong>逻辑块地址（Logical block address）</strong>，它还负责 IO request scheduling 以及 buffers 和 caches。</li>
<li><code>file-organization module</code> : 主要存储了文件和他们对应的 <code>logical blocks</code> 的信息。还包括 <code>free-space manager</code>，用来跟踪未分配的 <code>logical blocks</code>，当 <code>file-organization module</code> 需要空闲块时提供空闲的块地址信息。</li>
<li><code>logical file system</code> : 负责管理 <code>metadata</code> 信息。Metadata 信息存储了所有的文件系统结构信息（包括 <strong>目录结构</strong>、<strong>文件名</strong>），只是不包括具体的数据。关键信息包括 FCB (<code>file-controle blocks</code>，即 <code>inode</code>)，存储了文件的具体信息如 <code>owership</code>、<code>permissions</code>、<code>locations of file contents(location of logical blocks)</code>。</li>
</ul>
<h2 id="system-wide-open-file-table-And-per-process-open-file-table"><a href="#system-wide-open-file-table-And-per-process-open-file-table" class="headerlink" title="system-wide open-file table And per-process open-file table"></a>system-wide open-file table And per-process open-file table</h2><p>大多数操作系统再打开并使用文件之前，都需要（implicitly or explicitly）系统调用 <code>open()</code>，操作系统维护了一个 <code>open-file table</code>，维护着所有的打开文件的信息。当一个文件操作（如读，写，执行等）被请求前，系统调用 <code>open()</code>，文件会通过一个 <code>index</code> 被加入到 <code>open-file table</code>，当文件不在使用时，<code>open-file table</code> 中关于此文件的条目（<code>index</code>） 被移除。</p>
<p>系统中维护了 2 中类别的 <code>open-file table</code>:</p>
<ul>
<li><code>per-process open-file table</code> : 跟踪进程打开的文件列表，此表中的列表实际是指向 <code>system-wide open-file table</code> 中相关条目（entry）的指针（pointer）。</li>
<li><code>system-wide open-file table</code> ： 维护了系统上所有的打开的文件信息，保存了如 <strong>文件路径</strong>、<strong>文件大小</strong>、<strong>文件时间属性（access time 等）</strong>、<code>open count</code> 等信息，当一个进程打开一个文件后，<code>system-wide open-file table</code> 中就会添加一个此文件相关的条目，当另一个进程打开同样的文件后，进程的 <code>per-process open-file table</code> 中只是会添加一条到 <code>system-wide open-file table</code> 中对应文件的引用（entry）。<code>system-wide open-file table</code> 中的每个条目还维护了一个 <code>open count</code>，记录了有多少进程打开了此文件，当某个进程关闭此文件后，其 <code>open count</code> 会减少，值为 <code>0</code> 时，表示没有任何进程打开了此文件，此条目可以从 <code>system-wide open-file table</code> 中移除。</li>
</ul>
<p><strong><code>system-wide open-file table</code> 里面关于文件的信息，保存的主要是 FCB 的拷贝（Copy）</strong></p>
<p><strong><code>per-process open-file table</code> 里面存储的主要是到 <code>system-wide open-file table</code> 里面的对应文件的指针（pointers）</strong></p>
<p><strong>Linux 系统中要查看 <code>open-file table</code> 相关信息，可以使用 <code>lsof</code>、<code>fuser</code>、<code>/proc/&lt;pid&gt;/fd/</code> 等方法。</strong></p>
<h1 id="Security"><a href="#Security" class="headerlink" title="Security"></a>Security</h1><h2 id="Encryption"><a href="#Encryption" class="headerlink" title="Encryption"></a>Encryption</h2><h3 id="Symmetric-Encryption"><a href="#Symmetric-Encryption" class="headerlink" title="Symmetric Encryption"></a>Symmetric Encryption</h3><p>在 <strong>对称加密算法(Symmetric Encryption)</strong> 中，加密和解密使用同样的密钥（Key）</p>
<h1 id="Glossary"><a href="#Glossary" class="headerlink" title="Glossary"></a>Glossary</h1><p><code>GNU</code>： GNU’s Not Unix，Richard Stallman 于 1984 年开始开发的自由（free）的类 Unix 操作系统。包括编译器、编辑器、库文件、游戏等应用，没有内核。</p>
<p><code>GNU/Linux</code>： 1991 年，Linus Torvalds 发布了最初版类 Unix 操作系统内核，并使用了 GNU 提供的编译器和工具。</p>
<p><code>FSF</code>: Free Software Foundation，自由软件基金会，由 Richard Stallman 于 1985 年成立，旨在鼓励和推动自由软件的使用和开发。<strong>自由不等于免费</strong></p>
<p><code>GPL</code>： GNU General Public License。</p>
<p><code>ELF</code>: Executable and Linkable Format.</p>
<p><code>ABI</code> : Application Binary Interface. ABI 定义了在不同架构以及不同的操作系统中，一个二进制代码（Binary Code）提供的接口的差异性。ABI 定义了二进制代码的底层细节，如地址宽度、向系统调用（system calls）提供参数的方法、运行时的堆栈（stack）的组织方式、系统库的二进制格式、数据类型等信息。ABI 是架构级别（architecture-level）的定义，如果一个二进制文件是根据特点的架构（如 ARMv8 processor）编译（链接）而成，那将他迁移到支持此 ABI 的另外的系统上，理论上它也可以正常运行。<sup id="fnref:3"><a href="#fn:3" rel="footnote"><span class="hint--top hint--error hint--medium hint--rounded hint--bounce" aria-label="[Operating System Concepts v10 Online](https://os.ecci.ucr.ac.cr/slides/Abraham-Silberschatz-Operating-System-Concepts-10th-2018.pdf) 2.6 Why Applications Are Operating-System Specific">[3]</span></a></sup></p>
<p><code>RTE</code> : Run Time Environment. </p>
<p><code>LKMs</code> : Loadable Kernel Modules. </p>
<p><code>Darwin</code> : iOS&#x2F;MacOS 底层的类 Unix 操作系统，主要基于 BSD UNIX 的 microkernel</p>
<p><code>IPC</code> : Inter-Process Communication.</p>
<p><code>RPCs</code> : Remote Procedure Calls.</p>
<p><code>JNI</code> : Java Native Interface.</p>
<p><code>HAL</code> : Hardware Abstraction Layer.</p>
<p><code>UEFI</code> : Unified Extensible Firmware Interface. 最新的硬件初始化程序，用于取代 BIOS</p>
<p><code>initramfs</code> : 在系统启动过程中（Bootstrap Program 运行过程，比如 GRUB），因为根文件系统（<code>root file system</code>）还未挂载，为了挂载根文件系统，必须加载必要的驱动程序和内核模块，boot loader 会创建一个临时 RAM 文件系统，即 <code>initramfs</code>。一旦内核开始运行，必要的驱动已经安装，内核会将根文件系统从 <code>initramfs</code> 切换到已经挂载的根文件系统。然后启动 <code>systemd</code> 进程。</p>
<p><code>CMT</code> : Chip MultiThreading. 一个物理 CPU 核上实现了双线程或多线程的支持。在一个 CPU 线程因等待内存加载数据而空闲（Memory Stall）时，另一个 CPU 线程开始执行。每个 CPU 线程拥有自己独立的状态数据（architectural state）、指令指针（instruction pointer）、注册器（regester set）等，可以将其当作一个单独的逻辑 CPU 来运行单独的线程（进程&#x2F;Job）。如 Intel 的超线程（hyper-threading）或者叫 SMT（Simultaneous Multi-Threading）</p>
<p><code>CFS</code> : Completely Fail Scheduler。Linux kernel 2.6.23 版本开始默认的 CPU 调度算法。</p>
<p><code>MMU</code> : Memory Management Unit.</p>
<p><code>HDD</code> : Hard Disk Driver.</p>
<p><code>SSD</code> : Solid State Disk.</p>
<p><code>ATA</code> : Advanced Technology Attachment. 存储设备接口协议</p>
<p><code>SATA</code> : Serial ATA. 存储设备接口协议</p>
<p><code>SAS</code> : Serial Attached SCSI. 存储设备接口协议</p>
<p><code>USB</code> : Universal Serial Bus. 存储设备接口协议</p>
<p><code>FC</code> : Fibre Channel. 存储设备接口协议</p>
<p><code>NVMe</code> : NVM express. NVM 存储设备专用的通信接口协议。NVM 设备通过 NVMe 接口协议直接连接在系统 PCI 总线上。 相比其他存储接口协议（如 SATA 、SAS 等）增加了吞吐量及减少了延迟。</p>
<p><code>HBA</code> : Host Bus Adapter.</p>
<p><code>HAS</code> : Host Attached Storage. </p>
<p><code>NAS</code> : Network Attached Storage. 存储设备接口协议，使用基于 TCP&#x2F;IP 的 RPC 实现，如 NFS</p>
<p><code>FC</code> : Fibre Channel，光纤通道，存储设备接口协议</p>
<p><code>SANs</code> : Storage Area Networks. 使用基于 TCP&#x2F;IP 的 RPC 实现</p>
<p><code>RAIDs</code> : Redundant Arrays of Independent Disks.</p>
<p><code>DES</code> : Data Encryption Standard.</p>
<p><code>AES</code> : Advanced Encryption Standard</p>
<p><code>IKE</code> : Internet Key Exchange.</p>
<p><code>TLS</code> : Transport Layer Security.  SSL 的升级版</p>
<p><code>SSL</code> : Secure Sockets Layer.</p>
<p><code>MAC</code> ： Mandatory Access Control. Linux 系统中，是 SELinux 的一部分。</p>
<p><code>DAC</code> ： Discretionary Access Control. UNIX-based 系统上使用的权限控制策略（<code>chmod</code>、<code>chown</code>、<code>chgrp</code>）</p>
<p><code>PAM</code> : Pluggable Authentication Modules. UNIX-based 系统上使用的用户鉴权模块</p>
<p><code>BSD</code> : Berkeley Software Distribution. 第一个 Unix 发行版，由 California Berkeley 大学发行</p>
<p><code>FSF</code> ： Free Software Foundation, 自由软件基金会，由 理查德斯托曼 于 1984 年发起的开源运动，GNU 是其主要的一部分</p>
<h1 id="参考链接-Bibliography"><a href="#参考链接-Bibliography" class="headerlink" title="参考链接|Bibliography"></a>参考链接|Bibliography</h1><p><a target="_blank" rel="noopener" href="https://os.ecci.ucr.ac.cr/slides/Abraham-Silberschatz-Operating-System-Concepts-10th-2018.pdf">Operating System Concepts v10 Online</a></p>
<h1 id="脚注"><a href="#脚注" class="headerlink" title="脚注"></a>脚注</h1><div id="footnotes"><hr><div id="footnotelist"><ol style="list-style: none; padding-left: 0; margin-left: 40px"><li id="fn:1"><span style="display: inline-block; vertical-align: top; padding-right: 10px; margin-left: -40px">1.</span><span style="display: inline-block; vertical-align: top; margin-left: 10px;"><a target="_blank" rel="noopener" href="https://os.ecci.ucr.ac.cr/slides/Abraham-Silberschatz-Operating-System-Concepts-10th-2018.pdf">Operating System Concepts v10 Online</a> 1.2.3 I/O Structure<a href="#fnref:1" rev="footnote"> ↩</a></span></li><li id="fn:2"><span style="display: inline-block; vertical-align: top; padding-right: 10px; margin-left: -40px">2.</span><span style="display: inline-block; vertical-align: top; margin-left: 10px;"><a target="_blank" rel="noopener" href="https://os.ecci.ucr.ac.cr/slides/Abraham-Silberschatz-Operating-System-Concepts-10th-2018.pdf">Operating System Concepts v10 Online</a> 1.3.2 Multiprocessor Systems<a href="#fnref:2" rev="footnote"> ↩</a></span></li><li id="fn:3"><span style="display: inline-block; vertical-align: top; padding-right: 10px; margin-left: -40px">3.</span><span style="display: inline-block; vertical-align: top; margin-left: 10px;"><a target="_blank" rel="noopener" href="https://os.ecci.ucr.ac.cr/slides/Abraham-Silberschatz-Operating-System-Concepts-10th-2018.pdf">Operating System Concepts v10 Online</a> 2.6 Why Applications Are Operating-System Specific<a href="#fnref:3" rev="footnote"> ↩</a></span></li><li id="fn:4"><span style="display: inline-block; vertical-align: top; padding-right: 10px; margin-left: -40px">4.</span><span style="display: inline-block; vertical-align: top; margin-left: 10px;"><a target="_blank" rel="noopener" href="https://os.ecci.ucr.ac.cr/slides/Abraham-Silberschatz-Operating-System-Concepts-10th-2018.pdf">Operating System Concepts v10 Online</a> CHAPTER 5 CPU Scheduling<a href="#fnref:4" rev="footnote"> ↩</a></span></li><li id="fn:5"><span style="display: inline-block; vertical-align: top; padding-right: 10px; margin-left: -40px">5.</span><span style="display: inline-block; vertical-align: top; margin-left: 10px;"><a target="_blank" rel="noopener" href="https://os.ecci.ucr.ac.cr/slides/Abraham-Silberschatz-Operating-System-Concepts-10th-2018.pdf">Operating System Concepts v10 Online</a> 5.5.4 Processor Affinity<a href="#fnref:5" rev="footnote"> ↩</a></span></li><li id="fn:6"><span style="display: inline-block; vertical-align: top; padding-right: 10px; margin-left: -40px">6.</span><span style="display: inline-block; vertical-align: top; margin-left: 10px;"><a target="_blank" rel="noopener" href="https://os.ecci.ucr.ac.cr/slides/Abraham-Silberschatz-Operating-System-Concepts-10th-2018.pdf">Operating System Concepts v10 Online</a> 9.1.5 Dynamic Linking and Shared Libraries<a href="#fnref:6" rev="footnote"> ↩</a></span></li><li id="fn:7"><span style="display: inline-block; vertical-align: top; padding-right: 10px; margin-left: -40px">7.</span><span style="display: inline-block; vertical-align: top; margin-left: 10px;"><a target="_blank" rel="noopener" href="https://os.ecci.ucr.ac.cr/slides/Abraham-Silberschatz-Operating-System-Concepts-10th-2018.pdf">Operating System Concepts v10 Online</a> CHAPTER 10 Virtual Memory<a href="#fnref:7" rev="footnote"> ↩</a></span></li><li id="fn:8"><span style="display: inline-block; vertical-align: top; padding-right: 10px; margin-left: -40px">8.</span><span style="display: inline-block; vertical-align: top; margin-left: 10px;"><a target="_blank" rel="noopener" href="https://os.ecci.ucr.ac.cr/slides/Abraham-Silberschatz-Operating-System-Concepts-10th-2018.pdf">Operating System Concepts v10 Online</a> 10.8 Allocating Kernel Memory<a href="#fnref:8" rev="footnote"> ↩</a></span></li><li id="fn:9"><span style="display: inline-block; vertical-align: top; padding-right: 10px; margin-left: -40px">9.</span><span style="display: inline-block; vertical-align: top; margin-left: 10px;"><a target="_blank" rel="noopener" href="https://os.ecci.ucr.ac.cr/slides/Abraham-Silberschatz-Operating-System-Concepts-10th-2018.pdf">Operating System Concepts v10 Online</a> 11.1.1 Hard Disk Drives<a href="#fnref:9" rev="footnote"> ↩</a></span></li><li id="fn:10"><span style="display: inline-block; vertical-align: top; padding-right: 10px; margin-left: -40px">10.</span><span style="display: inline-block; vertical-align: top; margin-left: 10px;"><a target="_blank" rel="noopener" href="https://os.ecci.ucr.ac.cr/slides/Abraham-Silberschatz-Operating-System-Concepts-10th-2018.pdf">Operating System Concepts v10 Online</a> 14.1 File-System Structure<a href="#fnref:10" rev="footnote"> ↩</a></span></li></ol></div></div>
      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://csms.tech/d5da7d5e/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="images/avatar.gif">
      <meta itemprop="name" content="COSMOS">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="L B T">
      <meta itemprop="description" content="得 能 莫 忘">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | L B T">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="d5da7d5e/" class="post-title-link" itemprop="url">Django 常见错误</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2022-07-12 13:55:03" itemprop="dateCreated datePublished" datetime="2022-07-12T13:55:03+08:00">2022-07-12</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2024-10-02 16:10:00" itemprop="dateModified" datetime="2024-10-02T16:10:00+08:00">2024-10-02</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">上层目录</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="categories/Python/" itemprop="url" rel="index"><span itemprop="name">Python</span></a>
        </span>
          ，
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="categories/Python/Django/" itemprop="url" rel="index"><span itemprop="name">Django</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="环境信息"><a href="#环境信息" class="headerlink" title="环境信息"></a>环境信息</h1><ul>
<li>centos7</li>
<li>python3</li>
<li>Django 4</li>
</ul>
<h2 id="ModuleNotFoundError-No-module-named-‘MySQLdb’"><a href="#ModuleNotFoundError-No-module-named-‘MySQLdb’" class="headerlink" title="ModuleNotFoundError: No module named ‘MySQLdb’"></a>ModuleNotFoundError: No module named ‘MySQLdb’</h2><blockquote>
<p>ModuleNotFoundError: No module named ‘MySQLdb’<br>…<br>django.core.exceptions.ImproperlyConfigured: Error loading MySQLdb module.</p>
</blockquote>
<p><strong>解决方法</strong></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">pip3 install pymysql</span><br></pre></td></tr></table></figure>

<p>编辑文件<code>./python36/lib/python3.6/site-packages/django/db/backends/mysql/__init__.py</code>, 输入以下内容</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> pymysql </span><br><span class="line">pymysql.install_as_MySQLdb()</span><br></pre></td></tr></table></figure>
          <!--noindex-->
            <div class="post-button">
              <a class="btn" href="d5da7d5e/#more" rel="contents">
                阅读全文 &raquo;
              </a>
            </div>
          <!--/noindex-->
        
      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://csms.tech/7d1a39d2/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="images/avatar.gif">
      <meta itemprop="name" content="COSMOS">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="L B T">
      <meta itemprop="description" content="得 能 莫 忘">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | L B T">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="7d1a39d2/" class="post-title-link" itemprop="url">Django+uwsgi+nginx 配置示例</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2022-07-19 10:55:03" itemprop="dateCreated datePublished" datetime="2022-07-19T10:55:03+08:00">2022-07-19</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2024-10-02 15:10:00" itemprop="dateModified" datetime="2024-10-02T15:10:00+08:00">2024-10-02</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">上层目录</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="categories/Python/" itemprop="url" rel="index"><span itemprop="name">Python</span></a>
        </span>
          ，
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="categories/Python/Django/" itemprop="url" rel="index"><span itemprop="name">Django</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="环境信息"><a href="#环境信息" class="headerlink" title="环境信息"></a>环境信息</h1><ul>
<li>centos 7</li>
<li>Python 3.10</li>
<li>Django 4.0</li>
<li>uwsgi 2.0.20</li>
<li>nginx 1.20.1</li>
<li>venv<blockquote>
<p>示例中虚拟环境位于 <code>/opt/vb/</code>, Django工程目录位于 <code>/opt/vb/vb/</code> , 工程名称为vb</p>
</blockquote>
</li>
</ul>
<h1 id="uwsgi-配置文件-uwsgi-ini-配置示例"><a href="#uwsgi-配置文件-uwsgi-ini-配置示例" class="headerlink" title="uwsgi 配置文件 (uwsgi.ini) 配置示例"></a>uwsgi 配置文件 (uwsgi.ini) 配置示例</h1><figure class="highlight shell"><figcaption><span>uwsgi.ini</span></figcaption><table><tr><td class="code"><pre><span class="line">[uwsgi]</span><br><span class="line">socket = 127.0.0.1:8081</span><br><span class="line">chdir = /opt/vb/vb</span><br><span class="line">wsgi-file = ./vb/wsgi.py</span><br><span class="line">master = true         //主进程</span><br><span class="line">vhost = true          //多站模式</span><br><span class="line">no-site = true        //多站模式时不设置入口模块和文件</span><br><span class="line">workers = 2           //子进程数</span><br><span class="line">reload-mercy = 10     </span><br><span class="line">vacuum = true         //退出、重启时清理文件</span><br><span class="line">max-requests = 1000   </span><br><span class="line">limit-as = 512</span><br><span class="line">buffer-size = 30000</span><br><span class="line">pidfile = uwsgi-8081.pid</span><br><span class="line">daemonize = uwsgi-8081.log</span><br><span class="line">pythonpath = /opt/vb/env/lib/python3.10/site-packages/</span><br></pre></td></tr></table></figure>
          <!--noindex-->
            <div class="post-button">
              <a class="btn" href="7d1a39d2/#more" rel="contents">
                阅读全文 &raquo;
              </a>
            </div>
          <!--/noindex-->
        
      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




  <nav class="pagination">
    <span class="page-number current">1</span><a class="page-number" href="page/2/">2</a><span class="space">&hellip;</span><a class="page-number" href="page/12/">12</a><a class="extend next" rel="next" title="下一页" aria-label="下一页" href="page/2/"><i class="fa fa-angle-right"></i></a>
  </nav>

</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">


<div class="copyright">
  &copy; 
  <span itemprop="copyrightYear">2024</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">COSMOS</span>
</div>
<div class="busuanzi-count">
    <span class="post-meta-item" id="busuanzi_container_site_uv">
      <span class="post-meta-item-icon">
        <i class="fa fa-user"></i>
      </span>
      <span class="site-uv" title="总访客量">
        <span id="busuanzi_value_site_uv"></span>
      </span>
    </span>
    <span class="post-meta-item" id="busuanzi_container_site_pv">
      <span class="post-meta-item-icon">
        <i class="fa fa-eye"></i>
      </span>
      <span class="site-pv" title="总访问量">
        <span id="busuanzi_value_site_pv"></span>
      </span>
    </span>
</div>

    </div>
  </footer>

  
  <div class="reading-progress-bar"></div>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


  
  <script size="300" alpha="0.3" zIndex="-1" src="https://cdnjs.cloudflare.com/ajax/libs/ribbon.js/1.0.2/ribbon.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
<script src="js/comments.js"></script><script src="js/utils.js"></script><script src="js/motion.js"></script><script src="js/next-boot.js"></script>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/hexo-generator-searchdb/1.4.1/search.js" integrity="sha256-1kfA5uHPf65M5cphT2dvymhkuyHPQp5A53EGZOnOLmc=" crossorigin="anonymous"></script>
<script src="js/third-party/search/local-search.js"></script>




  <script src="js/third-party/pace.js"></script>

  
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>




<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/gitalk/1.8.0/gitalk.css" integrity="sha256-AJnUHL7dBv6PGaeyPQJcgQPDjt/Hn/PvYZde1iqfp8U=" crossorigin="anonymous">

<script class="next-config" data-name="gitalk" type="application/json">{"enable":true,"github_id":"fl9999","repo":"fl9999.github.io","client_id":"a11bf6f7860762b725b5","client_secret":"a99046105f8bddc72ec718d54dc3fd7f22070821","admin_user":"fl9999","distraction_free_mode":true,"proxy":"https://cors-anywhere.azm.workers.dev/https://github.com/login/oauth/access_token","language":null,"js":{"url":"https://cdnjs.cloudflare.com/ajax/libs/gitalk/1.8.0/gitalk.min.js","integrity":"sha256-MVK9MGD/XJaGyIghSVrONSnoXoGh3IFxLw0zfvzpxR4="},"path_md5":"d41d8cd98f00b204e9800998ecf8427e"}</script>
<script src="js/third-party/comments/gitalk.js"></script>

</body>
</html>
