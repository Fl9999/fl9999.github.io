<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222" media="(prefers-color-scheme: light)">
<meta name="theme-color" content="#222" media="(prefers-color-scheme: dark)"><meta name="generator" content="Hexo 6.2.0">

  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="css/main.css">



<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.2.1/css/all.min.css" integrity="sha256-Z1K5uhUaJXA7Ll0XrZ/0JhX4lAtZFpT6jkKrEDT0drU=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pace/1.2.4/themes/blue/pace-theme-minimal.css">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/pace/1.2.4/pace.min.js" integrity="sha256-gqd7YTjg/BtfqWSwsJOvndl0Bxc8gFImLEkXQT8+qj0=" crossorigin="anonymous"></script>

<script class="next-config" data-name="main" type="application/json">{"hostname":"csms.tech","root":"/","images":"images","scheme":"Gemini","darkmode":true,"version":"8.14.2","exturl":false,"sidebar":{"position":"left","display":"always","padding":18,"offset":12},"copycode":{"enable":true,"style":null},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":"gitalk","storage":true,"lazyload":true,"nav":null,"activeClass":"gitalk"},"stickytabs":false,"motion":{"enable":true,"async":true,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeIn","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"搜索...","empty":"没有找到任何搜索结果：${query}","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","hits":"找到 ${hits} 个搜索结果"},"path":"search.xml","localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false}}</script><script src="js/config.js"></script>

    <meta name="description" content="得 能 莫 忘">
<meta property="og:type" content="website">
<meta property="og:title" content="L B T">
<meta property="og:url" content="http://csms.tech/index.html">
<meta property="og:site_name" content="L B T">
<meta property="og:description" content="得 能 莫 忘">
<meta property="og:locale" content="zh_CN">
<meta property="article:author" content="COSMOS">
<meta property="article:tag" content="博客, 记录，技术">
<meta name="twitter:card" content="summary">


<link rel="canonical" href="http://csms.tech/">



<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":true,"isPost":false,"lang":"zh-CN","comments":"","permalink":"","path":"index.html","title":""}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>L B T</title>
  








  <noscript>
    <link rel="stylesheet" href="css/noscript.css">
  </noscript>
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <div class="column">
      <header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <h1 class="site-title">L B T</h1>
      <i class="logo-line"></i>
    </a>
      <p class="site-subtitle" itemprop="description">记 录 过 去 的 经 验</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger" aria-label="搜索" role="button">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="index.html" rel="section"><i class="fa fa-earth-americas fa-fw"></i>首页</a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-folder-tree fa-fw"></i>总目录<span class="badge">53</span></a></li><li class="menu-item menu-item-linux"><a href="/categories/Linux" rel="section"><i class="fa fa-brands fa-linux fa-fw"></i>Linux</a></li><li class="menu-item menu-item-python"><a href="/categories/Python" rel="section"><i class="fa fa-brands fa-python fa-fw"></i>Python</a></li><li class="menu-item menu-item-docker"><a href="/categories/Docker" rel="section"><i class="fa fa-brands fa-docker fa-fw"></i>Docker</a></li><li class="menu-item menu-item-kubernetes"><a href="/categories/Kubernetes" rel="section"><i class="fa fa-dharmachakra fa-fw"></i>Kubernetes</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tornado fa-fw"></i>标签<span class="badge">78</span></a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-rectangle-list fa-fw"></i>列表<span class="badge">256</span></a></li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup"><div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off" maxlength="80"
           placeholder="搜索..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close" role="button">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div class="search-result-container no-result">
  <div class="search-result-icon">
    <i class="fa fa-spinner fa-pulse fa-5x"></i>
  </div>
</div>

    </div>
  </div>

</header>
        
  
  <aside class="sidebar">

    <div class="sidebar-inner sidebar-overview-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          文章总目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">COSMOS</p>
  <div class="site-description" itemprop="description">得 能 莫 忘</div>
</div>
<div class="site-state-wrap animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">256</span>
          <span class="site-state-item-name">文章</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
          <a href="/categories/">
        <span class="site-state-item-count">53</span>
        <span class="site-state-item-name">目录</span></a>
      </div>
      <div class="site-state-item site-state-tags">
          <a href="/tags/">
        <span class="site-state-item-count">78</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>

        </div>
      </div>
        <div class="back-to-top animated" role="button" aria-label="返回顶部">
          <i class="fa fa-arrow-up"></i>
          <span>0%</span>
        </div>
    </div>

    
  </aside>


    </div>

    <div class="main-inner index posts-expand">

    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://csms.tech/20250429103946/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="images/avatar.gif">
      <meta itemprop="name" content="COSMOS">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="L B T">
      <meta itemprop="description" content="得 能 莫 忘">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | L B T">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="20250429103946/" class="post-title-link" itemprop="url">八字十神</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2025-04-29 10:04:00" itemprop="dateCreated datePublished" datetime="2025-04-29T10:04:00+08:00">2025-04-29</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2025-05-12 15:17:53" itemprop="dateModified" datetime="2025-05-12T15:17:53+08:00">2025-05-12</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">上层目录</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="categories/%E6%98%93%E5%AD%A6/" itemprop="url" rel="index"><span itemprop="name">易学</span></a>
        </span>
          ，
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="categories/%E6%98%93%E5%AD%A6/%E5%85%AB%E5%AD%97%E5%8D%81%E7%A5%9E/" itemprop="url" rel="index"><span itemprop="name">八字十神</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css"><p>在 <strong>四柱八字</strong> 命盘中，以 <em>日干</em> 代表命主本人，周围的干支和日干的关系有十种状态，用 <strong>十神</strong> 来表示</p>
<p><img src="https://i.csms.tech/img_301.png"></p>
<ul>
<li><strong>印枭</strong> 。。</li>
</ul>
<table>
<thead>
<tr>
<th>十神</th>
<th>关系</th>
<th>正偏</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td><strong>财星</strong></td>
<td><em>我克者为财</em></td>
<td>- 异性者为 <strong>正财（财）</strong><br/>- 同性者为 <strong>偏财（才）</strong></td>
<td></td>
</tr>
<tr>
<td><strong>官杀</strong></td>
<td><em>克我者为官杀</em></td>
<td>- 异性者为 <strong>正官（官）</strong> <br/>- 同性者为 <strong>偏官（七杀、杀）</strong></td>
<td></td>
</tr>
<tr>
<td><strong>印枭</strong></td>
<td><em>生我者为印枭</em></td>
<td>- 异性者为 <strong>正印（印）</strong><br/>- 同性者为 <strong>偏印（枭）</strong></td>
<td></td>
</tr>
<tr>
<td><strong>比劫</strong></td>
<td><em>同我者为比劫</em></td>
<td>- 异性者为 <strong>劫财（劫）</strong> <br/> - 同性者为 <strong>比肩（比）</strong></td>
<td></td>
</tr>
<tr>
<td><strong>食伤</strong></td>
<td><strong>我生者为食伤</strong></td>
<td>- 异性者为 <strong>伤官（伤）</strong> <br/> - 同性者为 <strong>食神（食）</strong></td>
<td></td>
</tr>
</tbody></table>
<p><strong>十神类象</strong></p>
<table>
<thead>
<tr>
<th>十神</th>
<th>优点</th>
<th>缺点</th>
<th>其他</th>
</tr>
</thead>
<tbody><tr>
<td><strong>比肩</strong></td>
<td>自信</td>
<td>坚持己见，不听劝</td>
<td>比肩多容易合伙做事，帮身抗杀（杀克比肩）克财（比肩克财）助食伤（比劫生食伤）</td>
</tr>
<tr>
<td><strong>劫财</strong></td>
<td>勇猛</td>
<td>粗暴自负；容易狂</td>
<td>劫财多，容易破财</td>
</tr>
<tr>
<td><strong>正印</strong></td>
<td>优雅仁慈</td>
<td>依赖心，不爱动，懒</td>
<td>正印多，容易懒，得母亲偏爱，生我泄官杀克食伤</td>
</tr>
<tr>
<td><strong>偏印（枭）</strong></td>
<td>思维细腻</td>
<td>内向多疑</td>
<td></td>
</tr>
<tr>
<td><strong>食神</strong></td>
<td>口才好，想法多</td>
<td>空想幻想纠结</td>
<td>泄我生财克官杀</td>
</tr>
<tr>
<td><strong>伤官</strong></td>
<td>聪明，悟性高，创造力强</td>
<td>桀骜不驯，高冷，挑剔</td>
<td></td>
</tr>
<tr>
<td><strong>正官</strong></td>
<td>正直保守，秉公尚义</td>
<td>胆小怕事，过于谨慎</td>
<td>官主贵，有情（自律）约束。引财生印制劫</td>
</tr>
<tr>
<td><strong>偏官（杀，七杀）</strong></td>
<td>坚决果断，天生王者</td>
<td>个性偏激，招惹小人</td>
<td>杀主祸，事业名气权力，耗财生印功身制劫</td>
</tr>
<tr>
<td><strong>正财</strong></td>
<td>精打细算，勤俭持家</td>
<td>因小失大，不大气</td>
<td>财不大，稳定。生官杀，克印枭，泄伤食，坏印</td>
</tr>
<tr>
<td><strong>偏财</strong></td>
<td>慷慨豪爽，不拘小节</td>
<td>虚荣心强，炫富，花心</td>
<td>财大，不固定，众人财</td>
</tr>
</tbody></table>
<p><strong>偏财</strong></p>
<ul>
<li>通常比较大</li>
<li>不固定，三年不开张，开张吃三年</li>
<li>众人财，如开公司，做生意，营销等</li>
<li>喜欢炫、表面有钱，别人觉得有钱</li>
<li>偏财旺，机会多，身边老板有钱人可能多</li>
</ul>
<p><strong>正财</strong></p>
<ul>
<li>财不大但是可能很稳定，月月有，年年有，具体上线看实际情况</li>
<li>至于小不小取决于是否有食伤生助； 正财星是否有根，正财星的力量</li>
<li>正财正印正官透出，是典型的公务员、国企编制、大公司等</li>
</ul>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://csms.tech/20250510163229/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="images/avatar.gif">
      <meta itemprop="name" content="COSMOS">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="L B T">
      <meta itemprop="description" content="得 能 莫 忘">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | L B T">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="20250510163229/" class="post-title-link" itemprop="url">阴阳五行</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>
      

      <time title="创建时间：2025-05-10 16:32:33 / 修改时间：16:32:37" itemprop="dateCreated datePublished" datetime="2025-05-10T16:32:33+08:00">2025-05-10</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">上层目录</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="categories/%E6%98%93%E5%AD%A6/" itemprop="url" rel="index"><span itemprop="name">易学</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>五行，最初代表古人认为构成世界万物的五种基础物质，后来逐渐扩展为 方向、人体脏腑、颜色、季节等</p>
<table>
<thead>
<tr>
<th>五行</th>
<th>木</th>
<th>火</th>
<th>土</th>
<th>金</th>
<th>水</th>
</tr>
</thead>
<tbody><tr>
<td><em>阴阳</em></td>
<td>偏阳</td>
<td>纯阳</td>
<td>阴阳平衡</td>
<td>偏阴</td>
<td>纯阴</td>
</tr>
<tr>
<td><em>方向</em></td>
<td>东</td>
<td>南</td>
<td>中</td>
<td>西</td>
<td>北</td>
</tr>
<tr>
<td><em>四季</em></td>
<td>春</td>
<td>夏</td>
<td>四季末</td>
<td>秋</td>
<td>冬</td>
</tr>
<tr>
<td><em>颜色</em></td>
<td>青绿</td>
<td>红紫</td>
<td>黄褐</td>
<td>金白</td>
<td>黑</td>
</tr>
<tr>
<td><em>五脏</em></td>
<td>肝</td>
<td>心</td>
<td>脾</td>
<td>肺</td>
<td>肾</td>
</tr>
<tr>
<td><em>五常</em></td>
<td>仁</td>
<td>礼</td>
<td>信</td>
<td>义</td>
<td>智</td>
</tr>
<tr>
<td><em>性格</em></td>
<td>积极向上</td>
<td>大胆创新</td>
<td>忠厚踏实</td>
<td>刚直坚定</td>
<td>智慧圆滑</td>
</tr>
<tr>
<td><em>行业</em></td>
<td>- 家具 <br/> - 木材 <br/> - 纺织 <br/> - 服装 <br/> - 园林</td>
<td>- 互联网 <br/> - 电商 <br/> - 电力、电器 <br/> - 光热</td>
<td>- 房地产 <br/> - 矿产 <br/> - 沙石陶瓷相关</td>
<td>- 机械 <br/> - 刀枪金银钢铁</td>
<td>- 渔业 <br/> - 物流交通运输</td>
</tr>
</tbody></table>
<h1 id="易学相关常识"><a href="#易学相关常识" class="headerlink" title="易学相关常识"></a>易学相关常识</h1><h2 id="天干地支纪年法的第一个甲子年"><a href="#天干地支纪年法的第一个甲子年" class="headerlink" title="天干地支纪年法的第一个甲子年"></a>天干地支纪年法的第一个甲子年</h2><ul>
<li><p><strong>中国传统上，以轩辕黄帝纪元作为起点</strong> 。据《史记·律书》记载，古人以轩辕黄帝即位之年（传说中的黄帝元年）为第一个甲子年。现代学者一般推算黄帝即位在公元前2697年或前2698年，其中以公元前2637年、前2697年这两种说法较常见。</p>
</li>
<li><p><strong>天干地支系统正式广泛应用于纪年，是在汉代以后逐步普及的</strong> 。 因此常见两种推法</p>
<table>
<thead>
<tr>
<th>推算基准</th>
<th>第一个甲子年（公历）</th>
<th>备注</th>
</tr>
</thead>
<tbody><tr>
<td>以轩辕黄帝纪元起算</td>
<td>公元前 2637 年</td>
<td>公元前 2637 年</td>
</tr>
<tr>
<td>以西汉太初元年（建元）推回</td>
<td>公元前 1984 年</td>
<td>另一种学术推法</td>
</tr>
</tbody></table>
</li>
</ul>
<p><strong>中国官方和民间传统纪年一般默认黄帝纪元</strong></p>
<p><a target="_blank" rel="noopener" href="https://www.zhihu.com/question/38105366">此链接中的说法可能更为有道理，古时纪年法非常的多，也存在很多误差，到了西汉才由官方钦定使用天干地支纪年，往前的纪年都是由此往前推论而出</a></p>
<h2 id="年干支"><a href="#年干支" class="headerlink" title="年干支"></a>年干支</h2><ul>
<li><p>方法 1： <strong>速算公式</strong></p>
<p>  为了快速计算，首先为天干地支按照以下顺序编号：</p>
<table>
<thead>
<tr>
<th>0</th>
<th>1</th>
<th>2</th>
<th>3</th>
<th>4</th>
<th>5</th>
<th>6</th>
<th>7</th>
<th>8</th>
<th>9</th>
</tr>
</thead>
<tbody><tr>
<td>癸</td>
<td>甲</td>
<td>乙</td>
<td>丙</td>
<td>丁</td>
<td>戊</td>
<td>己</td>
<td>庚</td>
<td>辛</td>
<td>壬</td>
</tr>
</tbody></table>
<table>
<thead>
<tr>
<th>0</th>
<th>1</th>
<th>2</th>
<th>3</th>
<th>4</th>
<th>5</th>
<th>6</th>
<th>7</th>
<th>8</th>
<th>9</th>
<th>10</th>
<th>11</th>
</tr>
</thead>
<tbody><tr>
<td>亥</td>
<td>子</td>
<td>丑</td>
<td>寅</td>
<td>卯</td>
<td>辰</td>
<td>巳</td>
<td>午</td>
<td>未</td>
<td>申</td>
<td>酉</td>
<td>戌</td>
</tr>
</tbody></table>
<ol>
<li><p><strong>确定天干（甲乙丙丁戊己庚辛壬癸）</strong></p>
<p> <code>天干序号 =（公元年份最后一位数 − 3）</code> ，如果结果为负数则加 10， 若是公元前年份： <code>天干序号 =（公元前年份最后一位数 + 8）</code> ，如公元前 1 年（<code>-1 + 8 = 7</code>） 为 <strong>庚</strong></p>
<blockquote>
<p>减 3 是因为公元 3 年为 <strong>癸亥年</strong> ， 公元 4 年为 <strong>甲子年</strong> ，所以每 10 个整年中的第 4 年都是 <strong>甲年</strong></p>
</blockquote>
</li>
<li><p><strong>确定地支（子丑寅卯辰巳午未申酉戌亥）</strong></p>
<p> <code>地支序号=（年份−3）mod 12</code></p>
</li>
</ol>
<p>   例如 1992 年为 <strong>壬申</strong>：</p>
<p>   <code>(2−3) = -1 ， -1 + 10 = 9</code> 则为 <strong>壬</strong></p>
<p>   <code>(1992 − 3) mod 12 = 1989 mod 12 = 9</code> 则为 <strong>申</strong></p>
</li>
<li><p>方法 2 ： <strong>记住几个“关键年”，然后顺推&#x2F;逆推干支循环</strong></p>
<p>  <strong>关键年份记忆（常用锚点年）</strong></p>
<table>
<thead>
<tr>
<th>公历年份</th>
<th>干支</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td>1984</td>
<td>甲子</td>
<td>六十甲子起点，建议背住</td>
</tr>
<tr>
<td>2000</td>
<td>庚辰</td>
<td>千禧年，常用</td>
</tr>
<tr>
<td>2024</td>
<td>甲辰</td>
<td>近期年份，容易记住</td>
</tr>
</tbody></table>
<p>  举个例子：快速推算 1992 年的干支<br>  我们知道 1984 年是 <strong>甲子年</strong> ，是一个周期的起点。</p>
<p>  从 1984 到 1992 过了 8 年。</p>
<p>  所以：</p>
<p>  干支位置往后推 8 个：<br>  天干：甲 → 乙 → 丙 → 丁 → 戊 → 己 → 庚 → 辛 → 壬（第 9 个）</p>
<p>  地支：子 → 丑 → 寅 → 卯 → 辰 → 巳 → 午 → 未 → 申（第 9 个）</p>
<p>  🔵 所以 1992 年 &#x3D; <strong>壬申年</strong></p>
<blockquote>
<p><strong>天干往后加 8 个等于往前减 2 个</strong><br><strong>地支往后加 8 个等于往前减 4 个</strong></p>
</blockquote>
</li>
</ul>
<h2 id="月干支"><a href="#月干支" class="headerlink" title="月干支"></a>月干支</h2><p>月支比较简单，12 地支和 12 个月份按照以下表一一对应</p>
<table>
<thead>
<tr>
<th>1</th>
<th>2</th>
<th>3</th>
<th>4</th>
<th>5</th>
<th>6</th>
<th>7</th>
<th>8</th>
<th>9</th>
<th>10</th>
<th>11</th>
<th>12</th>
</tr>
</thead>
<tbody><tr>
<td>寅</td>
<td>卯</td>
<td>辰</td>
<td>巳</td>
<td>午</td>
<td>未</td>
<td>申</td>
<td>酉</td>
<td>戌</td>
<td>亥</td>
<td>子</td>
<td>丑</td>
</tr>
</tbody></table>
<blockquote>
<p>五行中，<strong>寅卯属木，辰属土，在东方，为春天</strong> ， <strong>巳午属火，未属土，在南方，为夏天</strong> ， <strong>申酉属金，戌属土，在西方，为秋天</strong> ， <strong>亥子属水，丑属土，在北方，为冬天</strong><br><strong>寅卯辰三会为木，巳午未三会为火，申酉辰三会为金，亥子丑三会为水</strong></p>
</blockquote>
<p>月干稍微复杂些， <strong>年干不同，会导致月干的不同</strong> ，确定了正月后，其他月干依次往后推</p>
<p><strong>五虎遁年起月诀</strong> ，其中 <em>虎指寅</em> ，也称 <strong>年上起月法</strong> ： </p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">甲己之年丙作首，乙庚之年戊作首，丙辛之年庚作首，丁壬之年壬作首，戊癸之年甲作首。</span><br></pre></td></tr></table></figure>

<table>
<thead>
<tr>
<th>年份天干</th>
<th>正月起始天干</th>
</tr>
</thead>
<tbody><tr>
<td>甲、己年</td>
<td>丙寅月</td>
</tr>
<tr>
<td>乙、庚年</td>
<td>戊寅月</td>
</tr>
<tr>
<td>丙、辛年</td>
<td>庚寅月</td>
</tr>
<tr>
<td>丁、壬年</td>
<td>壬寅月</td>
</tr>
<tr>
<td>戊、癸年</td>
<td>甲寅月</td>
</tr>
</tbody></table>
<blockquote>
<p>月干由年干配合 <strong>天干五合</strong> 推导而出，并且 <strong>月首（正月）一定为阳干</strong> ，以下为 <strong>天干五合</strong> 推导出月首（正月）的过程</p>
<ul>
<li><p><strong>甲己合为土</strong> ，（丙丁）火生土，丙为阳火，月首为 <strong>丙寅</strong> 月</p>
</li>
<li><p><strong>乙庚合为金</strong> ，（戊己）土生金，戊为阳土，月首为 <strong>戊寅</strong> 月</p>
</li>
<li><p><strong>丙辛合为水</strong> ，（庚辛）金生水，庚为阳金，月首为 <strong>庚寅</strong> 月</p>
</li>
<li><p><strong>丁壬合为木</strong> ，（壬癸）水生木，壬为阳水，月首为 <strong>壬寅</strong> 月</p>
</li>
<li><p><strong>戊癸合为火</strong> ，（甲乙）木生火，甲为阳木，月首为 <strong>甲寅</strong> 月</p>
</li>
</ul>
</blockquote>
<p><strong>还需特别注意干支月之间是以 <em>节</em> 分割，而不是按照正常的整月为界线</strong> ，比如公元 <code>2025.5.1</code> 为农历 <code>2025 年 4 月初 4</code> ，2025 年为 <code>乙巳蛇年</code> ，根据以上推算，其正月为 <code>戊寅</code> 月，则 <em>农历四月</em> 月为 <code>辛巳</code> 月，但是在万年历中， <strong>四月初一 不属于 <em>辛巳月</em> 而属于 <em>庚辰</em> 月，这是因为 <code>四月初五 在节气中为 立夏</code> ，因此 <code>四月初五开始才是辛巳月</code></strong></p>
<h2 id="时干支"><a href="#时干支" class="headerlink" title="时干支"></a>时干支</h2><p>古人把一昼夜分为十二辰，每辰分为八刻，一昼夜为九十六刻。时支较为简单，12 地支和 12 个时辰按照以下表一一对应</p>
<table>
<thead>
<tr>
<th>23 - 1 点</th>
<th>1 - 3 点</th>
<th>3 - 5 点</th>
<th>5 - 7 点</th>
<th>7 - 9 点</th>
<th>9 - 11 点</th>
<th>11 - 13 点</th>
<th>13 - 15 点</th>
<th>15 - 17 点</th>
<th>17 - 19 点</th>
<th>19 - 21 点</th>
<th>21 - 23 点</th>
</tr>
</thead>
<tbody><tr>
<td>子</td>
<td>丑</td>
<td>寅</td>
<td>卯</td>
<td>辰</td>
<td>巳</td>
<td>午</td>
<td>未</td>
<td>申</td>
<td>酉</td>
<td>戌</td>
<td>亥</td>
</tr>
</tbody></table>
<p>时干稍微复杂些， <strong>需要根据日干而定</strong> ，确定日干后，首先推定出 <strong>子时</strong> 对应的天干，后面的依次后推</p>
<p><strong>五鼠遁日起时诀</strong> ，也称为 <strong>日上起时法</strong>：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">甲己还加甲，乙庚丙作初。</span><br><span class="line">丙辛从戊起，丁壬庚子是。</span><br><span class="line">戊癸何方觅，壬子是真途。 </span><br></pre></td></tr></table></figure>

<blockquote>
<p>和月干一样，也可以根据 <strong>天干五合</strong> 推导出 <strong>寅时</strong> ，再推导出 <strong>子时</strong></p>
<ul>
<li><p><strong>甲己合为土</strong> ，（丙丁）火生土，丙为阳火， <strong>丙寅</strong> <strong>甲子</strong></p>
</li>
<li><p><strong>乙庚合为金</strong> ，（戊己）土生金，戊为阳土， <strong>戊寅</strong> <strong>丙子</strong></p>
</li>
<li><p><strong>丙辛合为水</strong> ，（庚辛）金生水，庚为阳金， <strong>庚寅</strong> <strong>戊子</strong></p>
</li>
<li><p><strong>丁壬合为木</strong> ，（壬癸）水生木，壬为阳水， <strong>壬寅</strong> <strong>庚子</strong></p>
</li>
<li><p><strong>戊癸合为火</strong> ，（甲乙）木生火，甲为阳木， <strong>甲寅</strong> <strong>壬子</strong></p>
</li>
</ul>
</blockquote>
          <!--noindex-->
            <div class="post-button">
              <a class="btn" href="20250510163229/#more" rel="contents">
                阅读全文 &raquo;
              </a>
            </div>
          <!--/noindex-->
        
      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://csms.tech/20250507104153/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="images/avatar.gif">
      <meta itemprop="name" content="COSMOS">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="L B T">
      <meta itemprop="description" content="得 能 莫 忘">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | L B T">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="20250507104153/" class="post-title-link" itemprop="url">八字解析</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>
      

      <time title="创建时间：2025-05-07 10:42:00 / 修改时间：10:42:05" itemprop="dateCreated datePublished" datetime="2025-05-07T10:42:00+08:00">2025-05-07</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">上层目录</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="categories/%E6%98%93%E5%AD%A6/" itemprop="url" rel="index"><span itemprop="name">易学</span></a>
        </span>
          ，
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="categories/%E6%98%93%E5%AD%A6/%E5%85%AB%E5%AD%97%E5%8D%81%E7%A5%9E/" itemprop="url" rel="index"><span itemprop="name">八字十神</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css"><p>在八字命理体系中，判断一个人的八字是身强还是身弱是非常关键的一步，它犹如一把关键的钥匙，是开启后续分析如 性格特征、运势走向、用神、喜忌 等诸多方面的基础。</p>
<h1 id="四柱八字"><a href="#四柱八字" class="headerlink" title="四柱八字"></a>四柱八字</h1><p>在八字命令体系中， <strong>四柱八字</strong> 是分析命理的基本盘，它由 <em>年柱</em> 、 <em>月柱</em> 、 <em>日柱</em> 、 <em>时柱</em> 构成，分别代表了人出生时的 <em>年</em> 、 <em>月</em> 、 <em>日</em> 、 <em>时</em> 的天干地支纪时。</p>
<table>
<thead>
<tr>
<th></th>
<th>年柱</th>
<th>月柱</th>
<th>日柱</th>
<th>时柱</th>
</tr>
</thead>
<tbody><tr>
<td><strong>天干</strong></td>
<td>己</td>
<td>丙</td>
<td><strong>戊</strong></td>
<td>壬</td>
</tr>
<tr>
<td><strong>地支</strong></td>
<td>卯</td>
<td>子</td>
<td>午</td>
<td>子</td>
</tr>
<tr>
<td><em>藏干（继承 &#x2F; 余气）</em> <br/><em>藏干（长生 &#x2F; 中气）</em> <br/> <em>藏干（本气）</em></td>
<td>-<br/>- <br/> 乙木</td>
<td>-<br/>- <br/>癸水</td>
<td>-<br/> 己土 <br/>丁火</td>
<td>-<br/>-<br/>癸水</td>
</tr>
</tbody></table>
<ul>
<li><p><strong>日主</strong> ， 也称 <strong>日元</strong> 、 <strong>本命元神</strong> 或者 <em>日干</em>， 是 <strong>日柱中的天干</strong> ，如以上 <strong>四柱八字中的 <em>戊</em></strong> 。 <em><strong>日主 代表命主本身，是整个八字的核心所在</strong></em></p>
</li>
<li><p><strong>月令</strong> ， 也称 <strong>月支</strong> ， 在判断八字身强身弱的诸多因素中， <strong>月令</strong> 占据这举足轻重的地位，是决定先天旺衰的关键所在。不同的季节对应着不同的五行旺相状态，而出生月份的地支所代表的五行，对日主五行的力量有着先天性的影响。 <strong>若 日主 的五行处于 当令 旺相状态，日主便处于 <em>得令</em> 状态，力量相对较强</strong></p>
</li>
<li><p><strong>通根</strong> ， 天干中的五行，在地支也能找到对应的五行</p>
<p>  比如 <em>甲木</em> ，在地支中能找到 <em>寅木</em> 、 <em>卯木</em> 既是有根，并且是 <strong>强根</strong> ；如果有 <em>未土</em> ，因为 <em>未藏己丁乙</em> 为 <em>中气根</em> 相比 <em>本气根</em> 会弱些；如果有 <em>辰</em> ， 因为 <em>辰藏戊乙癸</em> ，为 <em>余气根</em> 属于最弱的根。</p>
</li>
<li><p><strong>透干</strong> ， 地支中存在的五行，在天干中有对应的五行，则属于透干。 <strong>存在通根，也会存在透干</strong> 。如果 <strong>地支中存在的属性，天干中没有对应的属性（即不存在透干），则会比存在透干的属性弱一些</strong></p>
</li>
<li><p><strong>无根 &#x2F; 天干虚浮 &#x2F; 虚浮无根</strong> 指天干对应的五行在地支中没有对应的属性</p>
</li>
<li><p><strong>天干的五行能量强于地干，天干代表会表现出来的特性，地支通常处于 <em>伏藏</em> 状态，不易被发现</strong></p>
</li>
</ul>
<p>四柱八字对应的信息</p>
<table>
<thead>
<tr>
<th></th>
<th>年柱</th>
<th>月柱</th>
<th>日柱</th>
<th>时柱</th>
</tr>
</thead>
<tbody><tr>
<td><strong>天干</strong></td>
<td>父亲</td>
<td>兄弟</td>
<td><strong>命主</strong></td>
<td>儿子</td>
</tr>
<tr>
<td><strong>地支</strong></td>
<td>母亲</td>
<td>姐妹</td>
<td>配偶</td>
<td>女儿</td>
</tr>
<tr>
<td>宫</td>
<td>父母宫</td>
<td>兄弟姐妹宫</td>
<td>夫妻宫</td>
<td>子女宫</td>
</tr>
<tr>
<td>年龄</td>
<td>1 - 18 岁</td>
<td>19 - 35 岁</td>
<td>36 - 54 岁</td>
<td>54 岁以后</td>
</tr>
<tr>
<td>身体部位</td>
<td>头部</td>
<td>胸背</td>
<td>腰腹</td>
<td>阴部、下肢、足</td>
</tr>
</tbody></table>
<ul>
<li><p>年柱主要代表了 <strong>父母</strong> 及 <em>祖上</em> 的信息</p>
</li>
<li><p><strong>兄弟宫也可以代表父母，但是更偏向于 <em>母亲</em></strong> </p>
</li>
<li><p><strong>天干所表现的通常是能看得到的，地支通常存在 <em>伏藏</em></strong></p>
</li>
</ul>
<p>年月日时之间的关联互动关系</p>
<table>
<thead>
<tr>
<th>关联</th>
<th>关系</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td>年月</td>
<td>父母关系或者祖父辈关系，主三十六之前的状态<br/>年柱如果代表父亲，则月柱代表母亲</td>
<td><strong>年月相合</strong> ： 父母关系好，三十岁前多贵人相助，年轻时做事容易成功 <br/> <strong>年月相冲</strong> ： 青年时期多奔波，不安稳，多白手起家，难得祖业，起点比较低</td>
</tr>
<tr>
<td>年日</td>
<td>- 父母与配偶的关系 <br/>   年柱代表父母，日柱代表配偶，如婆媳关系，女婿和岳父岳母关系 <br/> - 也代表命主和祖业的关系</td>
<td><strong>年日相合</strong> ： 父母和配偶关系融洽，也可能会得到祖业祖产   <br/> <strong>年日相冲</strong> ： 和祖辈关系不好，婆媳&#x2F;翁婿关系不好，容易远离家乡发展</td>
</tr>
<tr>
<td>年时</td>
<td>- 子女关系 <br/> - 命主年轻时的事业和将来的事业状态好坏是否相同</td>
<td><strong>年时相合</strong> ： 事业能够持续有成，事业能一直做到老；也代表后继有人，子女能成材    <br/> <strong>年冲时</strong> ： 家业难留，手下无强兵，自立自强</td>
</tr>
<tr>
<td>月日</td>
<td>- 兄弟姐妹和配偶的关系<br/> - 18-55 岁之间 <br/> 为人生事业、婚姻、感情最为重要的阶段</td>
<td><strong>月日相合</strong> ： 出社会后，事业关系和夫妻关系都不错，夫妻间能互相扶持，多贵人帮扶<br/> 月柱为兄弟宫， <strong>月日相合</strong> 也表示能得到兄弟朋友的帮扶 <br/> <strong>月冲日</strong> ： 家庭纠纷多，婚姻不稳定，是非多</td>
</tr>
<tr>
<td>月时</td>
<td>- 交友、合作伙伴、工作等</td>
<td><strong>月时相合</strong> ： 容易和朋友合作投资赚钱，能有不错的表现  <br/> <strong>月冲时</strong> ： 看交友、合作伙伴； 子嗣凶顽，难管教，意外较多</td>
</tr>
<tr>
<td>日时</td>
<td>- 夫妻关系 <br/> - 亲子关系</td>
<td><strong>日时相合</strong> ： 亲子关系和谐，子女能达到父母期望      <br/> <strong>日时相冲</strong> ： （工作等）变动大；子女不好管，长大后聚少离多</td>
</tr>
</tbody></table>
<h2 id="日主对应五行的特点"><a href="#日主对应五行的特点" class="headerlink" title="日主对应五行的特点"></a>日主对应五行的特点</h2><p>不同属性的日主会代表命主本人有不同的性格特征，这些天干出现命盘的其他地方也会产生作用，无需一定是 <strong>日主</strong> ，只是出现在日主能量更强。出现在地支通常代表命主内心的想法（伏藏），不一定会直接显现出来</p>
<table>
<thead>
<tr>
<th>日干</th>
<th>特点</th>
</tr>
</thead>
<tbody><tr>
<td><strong>甲木</strong></td>
<td><strong>甲木为阳</strong> ，为参天大树，上进，专一，有组织领导能力</td>
</tr>
<tr>
<td><strong>乙木</strong></td>
<td><strong>乙木为阴</strong> ，为花草藤曼，善于借势借力，重视朋友</td>
</tr>
<tr>
<td><strong>丙火</strong></td>
<td><strong>丙火为阳火</strong> ，为太阳之火，热烈（热情）耿直</td>
</tr>
<tr>
<td><strong>丁火</strong></td>
<td><strong>丁火为阴火</strong> ，为烛火炉火，黑暗中的明灯（光明），温暖，随遇而安，持久性较强</td>
</tr>
<tr>
<td><strong>戊土</strong></td>
<td><strong>戊土为阳土</strong> ，为大地高山城墙，稳重可靠，包容万物；固执，很难被改变</td>
</tr>
<tr>
<td><strong>己土</strong></td>
<td><strong>己土为阴土</strong> ，为田园之土，可塑性和包容性强，有牺牲精神，注重义气</td>
</tr>
<tr>
<td><strong>庚金</strong></td>
<td><strong>庚金为阳金</strong> ，为刀斧之金，刚直不屈，坚韧果断，一根筋，不懂变通</td>
</tr>
<tr>
<td><strong>辛金</strong></td>
<td><strong>辛金为阴金</strong> ，为珠玉之金，好面子，自尊心极强，一般会长得漂亮，爱好打扮，形象好</td>
</tr>
<tr>
<td><strong>壬水</strong></td>
<td><strong>壬水为阳水</strong> ，为江海河湖泊之水，宽宏大量，变化快，不稳定，适应能力强</td>
</tr>
<tr>
<td><strong>癸水</strong></td>
<td><strong>癸水为阴水</strong> ，为雨露之水，滋润万物，愿意帮助别人并会得到反哺，足智多谋，阴柔十足</td>
</tr>
</tbody></table>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://csms.tech/20250504171818/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="images/avatar.gif">
      <meta itemprop="name" content="COSMOS">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="L B T">
      <meta itemprop="description" content="得 能 莫 忘">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | L B T">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="20250504171818/" class="post-title-link" itemprop="url">二十四节气</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2025-05-04 17:18:27" itemprop="dateCreated datePublished" datetime="2025-05-04T17:18:27+08:00">2025-05-04</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2025-05-05 10:33:23" itemprop="dateModified" datetime="2025-05-05T10:33:23+08:00">2025-05-05</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">上层目录</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="categories/%E6%98%93%E5%AD%A6/" itemprop="url" rel="index"><span itemprop="name">易学</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css"><p><strong>传统廿四节气歌</strong></p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">春雨惊春清谷天，夏满芒夏暑相连。</span><br><span class="line">秋处露秋寒霜降，冬雪雪冬小大寒。</span><br><span class="line">每月两节不变更，最多相差一两天。</span><br><span class="line">上半年来六廿一，下半年来八廿三。</span><br></pre></td></tr></table></figure>

<p><strong>论节气歌 《渊海子平》</strong></p>
<figure class="highlight text"><table><tr><td class="code"><pre><span class="line">正月立春雨水节，二月惊蛰及春风。</span><br><span class="line">三月清明并谷雨，四月立夏小满方。</span><br><span class="line">五月芒种并夏至，六月小暑大暑当。</span><br><span class="line">七月立秋还处暑，八月白露秋分忙。</span><br><span class="line">九月寒露又霜降，十月立冬小雪降。</span><br><span class="line">子月大雪冬至节，丑月小寒大寒昌。</span><br></pre></td></tr></table></figure>

<table>
<thead>
<tr>
<th></th>
<th>寅月</th>
<th>卯月</th>
<th>辰月</th>
<th>巳月</th>
<th>午月</th>
<th>未月</th>
<th>申月</th>
<th>酉月</th>
<th>戌月</th>
<th>亥月</th>
<th>子月</th>
<th>丑月</th>
</tr>
</thead>
<tbody><tr>
<td><strong>节</strong></td>
<td><strong>立春</strong></td>
<td><strong>惊蛰</strong></td>
<td><strong>清明</strong></td>
<td><strong>立夏</strong></td>
<td><strong>芒种</strong></td>
<td><strong>小暑</strong></td>
<td><strong>立秋</strong></td>
<td><strong>白露</strong></td>
<td><strong>寒露</strong></td>
<td><strong>立冬</strong></td>
<td><strong>大雪</strong></td>
<td><strong>小寒</strong></td>
</tr>
<tr>
<td><strong>气 &#x2F; 候</strong></td>
<td><em>雨水</em></td>
<td><em>春风</em></td>
<td><em>谷雨</em></td>
<td><em>小满</em></td>
<td><em>夏至</em></td>
<td><em>大暑</em></td>
<td><em>处暑</em></td>
<td><em>秋风</em></td>
<td><em>霜降</em></td>
<td><em>小雪</em></td>
<td><em>冬至</em></td>
<td><em>大寒</em></td>
</tr>
</tbody></table>
<blockquote>
<p><em>*<em>需要注意的是，天干地支中表示的月份，都是以节气中的节为分割，而不是公历或者农历中的整月分割，例如正月的开始是 <em>立春</em>，而不是正月初一</em>*</em></p>
<p>比如公元 1993 年 2 月 4 号，为农历 <em>正月十三</em> ，为节气 <em>立春</em> ，那么子天干地支纪年法中， <em>正月初一到正月十二不属于正月（ <strong>甲寅月</strong> ）而是属于前一年的腊月（ <strong>癸丑月</strong> ），正月十三到二月十二属于正月（ <strong>甲寅月</strong> ）</em></p>
</blockquote>
<h1 id="春季"><a href="#春季" class="headerlink" title="春季"></a>春季</h1><table>
<thead>
<tr>
<th>节</th>
<th>气</th>
<th>说明</th>
<th>解释</th>
</tr>
</thead>
<tbody><tr>
<td><strong>立春</strong></td>
<td></td>
<td><strong>斗指东北，斗柄指向 <em>寅</em> ，立春是干支历 <em>寅</em> 月的起始</strong> 。</td>
<td><strong>立，是开始之意。万物复苏、生机勃勃，立春期间，气温上升，日照、降雨趋于增多</strong> <br/> 古代将立春分为三候： <code>一候东风解冻，二候蜇虫始振，三候鱼陟负冰</code> <sup id="fnref:1"><a href="#fn:1" rel="footnote"><span class="hint--top hint--error hint--medium hint--rounded hint--bounce" aria-label="候： 在节气中，将每个节气分为 3 候，每候大概 5天">[1]</span></a></sup></td>
</tr>
<tr>
<td></td>
<td><em>雨水</em></td>
<td></td>
<td>降雨开始，但降雨量级以小雨或毛毛细雨为主，太阳的直射点由南半球逐渐向赤道靠近。这时的北半球，日照时数和强度都在增加，气温回升较快，来自海洋的暖湿气流开始活跃，并渐渐向北挺进；冷暖交汇形成降雨。 <br/> 雨水三候是： <code>一候獭祭鱼，二候鸿雁来，三候草木萌动</code> <br/> 雨水三候对应的花信是 <code>一候菜花，二候棠棣，三候李花</code></td>
</tr>
<tr>
<td><strong>惊蛰</strong></td>
<td></td>
<td><strong>惊蛰是干支历 <em>卯</em> 月的起始</strong></td>
<td>时至惊蛰，阳气上升、气温回暖、春雷乍动、雨水增多，万物生机盎然 <br/> 惊蛰三候为： <code>一候桃始华；二候仓庚鸣；三候鹰化为鸠</code> <br/> 花信为： <code>一候桃花，二候杏花，　三候蔷薇</code></td>
</tr>
<tr>
<td></td>
<td><em>春风</em></td>
<td></td>
<td>春分又称为 <code>日中</code>、<code>日夜分</code>、<code>仲春之月</code>、<code>升分</code> 等。这一天太阳直射地球赤道，南北半球昼夜平分。</td>
</tr>
<tr>
<td><strong>清明</strong></td>
<td></td>
<td><strong>清明是干支历 <em>辰</em> 月的起始</strong></td>
<td>清明后雨水增多，大地呈现春和景明之象。草木始发新枝芽，万物开始生长，农民忙于春耕春种。 <br/> 三候： <code>桐始华，田鼠化为鴽，虹始见，萍始生。</code> <br/> 清明花信为： <code>一候桐花，二候麦花，三候柳花。</code></td>
</tr>
<tr>
<td></td>
<td><strong>谷雨</strong></td>
<td></td>
<td>谷雨就是 <em>雨水生五谷</em> 的意思，由于雨水滋润大地五谷得以生长，所以，谷雨就是 <code>雨生百谷</code> 。谚云 <code>谷雨前后，种瓜种豆</code> 。<br/> 三候： <code>第一候萍始生；第二候鸣鸠拂其羽；第三候为戴胜降于桑。</code> <br/> 谷雨时节正值暮春，是牡丹花开的重要时段，因此，牡丹花也被称为 <strong>谷雨花</strong> ，民间有 <code>谷雨三朝看牡丹</code> 的说法。</td>
</tr>
</tbody></table>
<h1 id="夏季"><a href="#夏季" class="headerlink" title="夏季"></a>夏季</h1><table>
<thead>
<tr>
<th>节</th>
<th>气</th>
<th>说明</th>
<th>解释</th>
</tr>
</thead>
<tbody><tr>
<td><strong>立夏</strong></td>
<td></td>
<td><strong>斗指东南，斗柄指向 <em>巳</em> ，立夏是干支历 <em>巳</em> 月的起始</strong> 。</td>
<td>盛夏时节的正式开始</td>
</tr>
<tr>
<td></td>
<td><em>小满</em></td>
<td></td>
<td>气温升高，降雨增多。 <br/> 三候是： <code>一候苦菜秀，二候靡草死，三候麦秋至</code></td>
</tr>
<tr>
<td><strong>芒种</strong></td>
<td></td>
<td><strong>芒种是干支历 <em>午</em> 月的起始</strong></td>
<td><strong><code>芒</code> 字指麦类等作物的收获，<code>种</code> 字是指谷黍类作物的播种， <code>芒种</code> 二字表明一切作物都在 <em>忙种</em> 了，是农事最为繁忙的时节</strong> 。 <br/> 三候： <code>一候螳螂生；二候鹏始鸣；三候反舌无声</code></td>
</tr>
<tr>
<td></td>
<td><em>夏至</em></td>
<td></td>
<td>太阳直射地面的位置到达一年的最北端，几乎直射北回归线，此时，北半球的白昼达最长。 <strong>夏至日阴气生而阳气始衰</strong> <br/> 三候： <code>一候鹿角解；二候蝉始鸣；三候半夏生。</code></td>
</tr>
<tr>
<td><strong>小暑</strong></td>
<td></td>
<td><strong>小暑是干支历 <em>未</em> 月的起始</strong></td>
<td>小暑意为天气开始炎热，但还没到最热。 <br/> 三候： <code>一候温风至；二候蟋蟀居宇；三候鹰始鸷。</code></td>
</tr>
<tr>
<td></td>
<td><em>大暑</em></td>
<td></td>
<td>炎热至极 <br/> 三候为： <code>一候腐草为萤；二候土润溽暑；三候大雨时行。 </code></td>
</tr>
</tbody></table>
<h1 id="秋季"><a href="#秋季" class="headerlink" title="秋季"></a>秋季</h1><table>
<thead>
<tr>
<th>节</th>
<th>气</th>
<th>说明</th>
<th>解释</th>
</tr>
</thead>
<tbody><tr>
<td><strong>立秋</strong></td>
<td></td>
<td><strong>斗指西南，斗柄指向 <em>申</em> ，立秋是干支历 <em>申</em> 月的起始</strong> 。</td>
<td>三候为： <code>初候凉风至，二候白露降，三候寒蝉鸣</code></td>
</tr>
<tr>
<td></td>
<td><em>处暑</em></td>
<td></td>
<td>即为 <strong>出暑</strong> ，是炎热离开的意思。 气温由炎热向寒冷过渡的节气 <br/> 三候： <code>一候鹰乃祭鸟；二候天地始肃；三候禾乃登。</code></td>
</tr>
<tr>
<td><strong>白露</strong></td>
<td></td>
<td><strong>白露是干支历 <em>酉</em> 月的起始</strong></td>
<td>自白露节气开始，季风交替，夏季季风逐渐被冬季季风代替，冷空气逐步南移，天气明显变得凉爽。 <br/> 三候是： <code>一候鸿雁来；二候玄鸟归；三候群鸟养羞。</code></td>
</tr>
<tr>
<td></td>
<td><em>秋风</em></td>
<td></td>
<td>秋分当日太阳直射赤道，全球各地昼夜等长。 <br/> 三候： <code>一候雷始收声；二候蛰虫坯户；三候水始涸</code></td>
</tr>
<tr>
<td><strong>寒露</strong></td>
<td></td>
<td><strong>小暑是干支历 <em>戌</em> 月的起始</strong></td>
<td>寒露节气是天气转凉的象征，如俗语所说， <code>寒露寒露，遍地冷露</code> ，寒露时的气温比白露时更低，地面的露水快要凝结成霜了。 <br/> 三候： <code>一候鸿雁来宾；二候雀入大水为蛤；三候菊有黄华</code></td>
</tr>
<tr>
<td></td>
<td><em>霜降</em></td>
<td></td>
<td>天气渐冷、初霜出现。 <br/>  三候： <code>一候豺乃祭兽；二候草木黄落；三候蜇虫咸俯</code></td>
</tr>
</tbody></table>
<h1 id="冬季"><a href="#冬季" class="headerlink" title="冬季"></a>冬季</h1><table>
<thead>
<tr>
<th>节</th>
<th>气</th>
<th>说明</th>
<th>解释</th>
</tr>
</thead>
<tbody><tr>
<td><strong>立冬</strong></td>
<td></td>
<td><strong>斗指西北，斗柄指向 <em>亥</em> ，立冬是干支历 <em>亥</em> 月的起始</strong> 。</td>
<td>意味着生气开始闭蓄，万物进入休养、收藏状态。 <br/> 三候： <code>一候水始冰；二候地始冻；三候雉入大水为蜃</code> <br/></td>
</tr>
<tr>
<td></td>
<td><em>小雪</em></td>
<td></td>
<td>三候： <code>一候虹藏不见；二候天气上升地气下降；三候闭塞而成冬</code></td>
</tr>
<tr>
<td><strong>大雪</strong></td>
<td></td>
<td><strong>大雪是干支历 <em>子</em> 月的起始</strong></td>
<td>三候为： <code>一候鹖鴠不鸣；二候虎始交；三候荔挺出</code></td>
</tr>
<tr>
<td></td>
<td><em>冬至</em></td>
<td></td>
<td>太阳直射地面的位置到达一年的最南端，几乎直射南回归线，这一天北半球的白昼最短，且越往北越短，黑夜最长。 <br/> 冬至三候为： <code>一候蚯蚓结，二候麋角解，三候水泉动</code></td>
</tr>
<tr>
<td><strong>小寒</strong></td>
<td></td>
<td><strong>小寒是干支历 <em>丑</em> 月的起始</strong></td>
<td><strong>一年中最寒冷的时节</strong> <br/>   三候为： <code>一候雁北乡，二候鹊始巢，三候雉始鸲</code></td>
</tr>
<tr>
<td></td>
<td><em>大寒</em></td>
<td></td>
<td>三候： <code>一候鸡乳；二候征鸟厉疾；三候水泽腹坚</code></td>
</tr>
</tbody></table>
<h1 id="脚注："><a href="#脚注：" class="headerlink" title="脚注："></a>脚注：</h1><div id="footnotes"><hr><div id="footnotelist"><ol style="list-style: none; padding-left: 0; margin-left: 40px"><li id="fn:1"><span style="display: inline-block; vertical-align: top; padding-right: 10px; margin-left: -40px">1.</span><span style="display: inline-block; vertical-align: top; margin-left: 10px;">候： 在节气中，将每个节气分为 3 候，每候大概 5天<a href="#fnref:1" rev="footnote"> ↩</a></span></li></ol></div></div>
      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://csms.tech/20250415143946/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="images/avatar.gif">
      <meta itemprop="name" content="COSMOS">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="L B T">
      <meta itemprop="description" content="得 能 莫 忘">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | L B T">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="20250415143946/" class="post-title-link" itemprop="url">GIMP 图像处理工具</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2025-04-15 14:04:00" itemprop="dateCreated datePublished" datetime="2025-04-15T14:04:00+08:00">2025-04-15</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">上层目录</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="categories/Tools/" itemprop="url" rel="index"><span itemprop="name">Tools</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css"><p>GIMP(GNU Image Manipulation Program) 是一个开源的专业的图像处理工具 <sup id="fnref:1"><a href="#fn:1" rel="footnote"><span class="hint--top hint--error hint--medium hint--rounded hint--bounce" aria-label="[GNU IMAGE MANIPULATION PROGRAM](https://www.gimp.org/)">[1]</span></a></sup></p>
<h1 id="常用操作"><a href="#常用操作" class="headerlink" title="常用操作"></a>常用操作</h1><h2 id="调整图像大小"><a href="#调整图像大小" class="headerlink" title="调整图像大小"></a>调整图像大小</h2><p><a target="_blank" rel="noopener" href="https://www.gimp.org/tutorials/GIMP_Quickies/#changing-the-size-dimensions-of-an-image-scale">调整图像大小参考文档</a></p>
<h2 id="颜色操作"><a href="#颜色操作" class="headerlink" title="颜色操作"></a>颜色操作</h2><h3 id="如何将新加元素的颜色调整为和图片上某个像素颜色完全一致"><a href="#如何将新加元素的颜色调整为和图片上某个像素颜色完全一致" class="headerlink" title="如何将新加元素的颜色调整为和图片上某个像素颜色完全一致"></a>如何将新加元素的颜色调整为和图片上某个像素颜色完全一致</h3><ol>
<li><p><strong>选择颜色拾取器工具</strong></p>
<p> 在左侧工具栏中，点击 <code>颜色拾取工具</code>（吸管图标），或快捷键 <code>O</code> 。接着鼠标点击图片上你想匹配的颜色。</p>
</li>
<li><p><strong>将拾取的颜色用于新内容</strong></p>
<p> 拾色后，GIMP 会自动将该颜色设为 <code>前景色（在工具箱左下角可见）</code> 。</p>
<p> 如果你是使用：</p>
<ul>
<li><p><code>文字工具</code> ： 输入新文字后，在工具选项中点击 <code>颜色</code> ，然后点击刚才的前景色。</p>
</li>
<li><p><code>画笔/填充工具</code> ： 直接使用前景色即可绘制或填充。</p>
</li>
</ul>
</li>
</ol>
<h2 id="复制粘贴"><a href="#复制粘贴" class="headerlink" title="复制粘贴"></a>复制粘贴</h2><h3 id="如何将矩形选择工具选择的区域复制粘贴到其他区域"><a href="#如何将矩形选择工具选择的区域复制粘贴到其他区域" class="headerlink" title="如何将矩形选择工具选择的区域复制粘贴到其他区域"></a>如何将矩形选择工具选择的区域复制粘贴到其他区域</h3><ol>
<li><p><strong>使用矩形选择工具</strong></p>
<p> 在左侧工具栏选择 <code>矩形选择工具</code>（快捷键：R）。在图像中框选你要复制的区域。</p>
</li>
<li><p><strong>复制或剪切该区域</strong></p>
<ul>
<li><strong>复制</strong> ：快捷键 <code>Ctrl + C</code>（或 <code>菜单：编辑 &gt; 复制</code> ）。  </li>
<li><strong>剪切</strong> （如果你想把原位置清除）： <code>Ctrl + X</code>（或 <code>菜单：编辑 &gt; 剪切</code> ）。</li>
</ul>
</li>
<li><p><strong>粘贴到新位置</strong></p>
<p> 按 <code>Ctrl + V</code> （或 <code>菜单：编辑 &gt; 粘贴</code> ）。 <strong>此时会出现一个名为 <code>浮动选择（浮动图层）</code> 的新图层，附着在原图上。</strong></p>
</li>
<li><p><strong>移动</strong></p>
<p> 在左侧工具栏选择 <code>移动工具</code>（十字箭头图标，快捷键：M）。 拖动粘贴的内容到你想要放置的位置。</p>
</li>
<li><p><strong>锚定或新建图层</strong></p>
<p> 如果你满意现在的位置，可以：</p>
<ul>
<li><strong>锚定图层</strong> ： <code>Ctrl + H</code> 或 <code>图层 &gt; 锚定图层</code> ，粘贴内容会并入原图。</li>
<li><strong>转为新图层</strong> ：右键 <code>浮动图层 &gt; 转为新图层</code> ，便于后续调整。</li>
</ul>
</li>
</ol>
<h2 id="测量图片中元素大小"><a href="#测量图片中元素大小" class="headerlink" title="测量图片中元素大小"></a>测量图片中元素大小</h2><p>要测量图片中指定元素的精确大小（Pixel），可以参考以下方法</p>
<ul>
<li><p><strong>使用 <code>测量工具（Measure Tool）</code></strong></p>
<ol>
<li>在工具箱中点击 <code>测量工具</code> （图标像一个圆规），或按快捷键 <code>Shift + M</code> ， <strong>鼠标点击图片上你要测量的起点 → 拖动到终点。状态栏会实时显示 <code>距离（以像素为单位）</code> ，如 <code>Distance: XXX px</code> 。</strong></li>
</ol>
</li>
<li><p><strong>使用 <code>矩形选择工具</code> 看宽高</strong></p>
<ol>
<li>选择 <code>矩形选择工具</code> （快捷键 <code>R</code>）， 用鼠标拖出一个区域（框住你要测量的元素）， 在 <code>工具选项</code> 面板或 <code>状态栏</code> 里，会显示所选区域的<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">Position: X, Y</span><br><span class="line">Size: Width x Height（单位是 px）</span><br></pre></td></tr></table></figure></li>
</ol>
</li>
</ul>
<h2 id="抬高图片的某一个角"><a href="#抬高图片的某一个角" class="headerlink" title="抬高图片的某一个角"></a>抬高图片的某一个角</h2><p>图片经常会出现某个角较低或较高的情况，此时想要调整图片是所有角处于完美的矩形状态，可以使用 <strong>透视工具（Perspective Tool）</strong></p>
<ol>
<li><strong>工具箱里面选择 <code>透视工具（Perspective Tool）</code> 或使用快捷键 <code>Shift + P</code></strong> </li>
<li>**图片中会出现四个角，随1313575799<br><a target="_blank" rel="noopener" href="https://www.gimp.org/">GNU IMAGE MANIPULATION PROGRAM</a></li>
</ol>
<h1 id="脚注"><a href="#脚注" class="headerlink" title="脚注"></a>脚注</h1><div id="footnotes"><hr><div id="footnotelist"><ol style="list-style: none; padding-left: 0; margin-left: 40px"><li id="fn:1"><span style="display: inline-block; vertical-align: top; padding-right: 10px; margin-left: -40px">1.</span><span style="display: inline-block; vertical-align: top; margin-left: 10px;"><a target="_blank" rel="noopener" href="https://www.gimp.org/">GNU IMAGE MANIPULATION PROGRAM</a><a href="#fnref:1" rev="footnote"> ↩</a></span></li></ol></div></div>
      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://csms.tech/20250415145440/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="images/avatar.gif">
      <meta itemprop="name" content="COSMOS">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="L B T">
      <meta itemprop="description" content="得 能 莫 忘">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | L B T">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="20250415145440/" class="post-title-link" itemprop="url">图像相关术语词汇表</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2025-04-15 14:04:00" itemprop="dateCreated datePublished" datetime="2025-04-15T14:04:00+08:00">2025-04-15</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">上层目录</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="categories/Tools/" itemprop="url" rel="index"><span itemprop="name">Tools</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css"><ul>
<li>JPEG - Joint Photographic Experts Group ， <strong>图像有损压缩标准</strong> ，主要用于数码图像的存储和传输，</li>
</ul>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://csms.tech/202209121102/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="images/avatar.gif">
      <meta itemprop="name" content="COSMOS">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="L B T">
      <meta itemprop="description" content="得 能 莫 忘">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | L B T">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="202209121102/" class="post-title-link" itemprop="url">kubernetes 安装配置</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2022-09-12 11:03:09" itemprop="dateCreated datePublished" datetime="2022-09-12T11:03:09+08:00">2022-09-12</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2025-03-19 13:03:00" itemprop="dateModified" datetime="2025-03-19T13:03:00+08:00">2025-03-19</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">上层目录</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="categories/Kubernetes/" itemprop="url" rel="index"><span itemprop="name">Kubernetes</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p><a target="_blank" rel="noopener" href="https://kubernetes.io/zh-cn/docs/setup/production-environment/">Kubernetes 官网文档</a></p>
<h1 id="环境信息"><a href="#环境信息" class="headerlink" title="环境信息"></a>环境信息</h1><ul>
<li>Centos 7 5.4.212-1</li>
<li>Docker 20.10.18</li>
<li>containerd.io-1.6.8</li>
<li>kubectl-1.24.7</li>
<li>kubeadm-1.24.7</li>
<li>kubelet-1.24.7</li>
</ul>
<h1 id="kubernetes-环境安装前配置"><a href="#kubernetes-环境安装前配置" class="headerlink" title="kubernetes 环境安装前配置"></a>kubernetes 环境安装前配置</h1><h2 id="升级内核版本"><a href="#升级内核版本" class="headerlink" title="升级内核版本"></a>升级内核版本</h2><p>Centos 7 默认的内核版本 3.10 在运行 kubernetes 时存在不稳定性，建议升级内核版本到新版本</p>
<a href="/202209140931/" title="Linux 升级内核">Linux 升级内核</a>

<blockquote>
<ul>
<li><p>Centos 7 默认的内核版本 3.10 使用的 cgroup 版本为 v1，Kubernetes 的部分功能必须使用 <code>cgroup v2</code> 来进行增强的资源管理和隔离 <sup id="fnref:13"><a href="#fn:13" rel="footnote"><span class="hint--top hint--error hint--medium hint--rounded hint--bounce" aria-label="[About cgroup v2](https://kubernetes.io/docs/concepts/architecture/cgroups/)">[13]</span></a></sup></p>
<p>使用以下命令检查系统使用的 <code>cgroup</code> 版本</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">stat -fc %T /sys/fs/cgroup/</span><br></pre></td></tr></table></figure>
<p>如果输出是 <code>cgroup2fs</code>， <strong>表示使用 cgroup v2</strong></p>
<p>如果输出是 <code>tmpfs</code>， <strong>表示使用 cgroup v1</strong></p>
</li>
<li><p><code>User Namespaces</code> 功能需要 Linux 6.3 以上版本，<code>tmpfs</code> 才能支持 <code>idmap</code> 挂载。并且其他功能（如 ServiceAccount 的挂载）也需要此功能的支持 <sup id="fnref:14"><a href="#fn:14" rel="footnote"><span class="hint--top hint--error hint--medium hint--rounded hint--bounce" aria-label="[User Namespaces](https://kubernetes.io/docs/concepts/workloads/pods/user-namespaces/)">[14]</span></a></sup></p>
</li>
<li><p><strong>Kubernetes v1.32 需要 Linux Kernel &gt;&#x3D; 4.19, 建议 5.8+ 以更好的支持 cgroups v2</strong></p>
</li>
<li><p><strong>Rocky Linux 8 或者 Centos 8 默认使用 <code>cgroup v1</code>，需要升级到 <code>cgroup v2</code>，执行命令 <code>grubby --update-kernel=ALL --args=&quot;systemd.unified_cgroup_hierarchy=1&quot;</code> 后重启即可升级到 <code>cgroup v2</code> 。</strong> 使用以下命令检查：</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="built_in">stat</span> -<span class="built_in">fc</span> %T /sys/fs/cgroup/</span></span><br><span class="line">cgroup2fs</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p><strong>若 CRI 使用 Containerd，需要 <a href="https://csms.tech/202212011355/#Containerd-常用配置">配置启用 CRI 以及配置其使用 <code>cgroup v2</code></a>。</strong></p>
</li>
</ul>
</blockquote>
<h2 id="关闭-SELinux"><a href="#关闭-SELinux" class="headerlink" title="关闭 SELinux"></a>关闭 SELinux</h2><p>kubernetes 目前未实现对 SELinux 的支持，因此必须要关闭 SELinux</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">sudo setenforce 0</span><br><span class="line">sudo sed -i &#x27;s/^SELINUX=enforcing$/SELINUX=disabled/&#x27; /etc/selinux/config</span><br></pre></td></tr></table></figure>

<h2 id="集群中所有计算机之间具有完全的网络连接"><a href="#集群中所有计算机之间具有完全的网络连接" class="headerlink" title="集群中所有计算机之间具有完全的网络连接"></a>集群中所有计算机之间具有完全的网络连接</h2><p>配置集群所有节点的防火墙，确保所有集群节点之间具有完全的网络连接。</p>
<ul>
<li>放通节点之间的通信</li>
<li>确保防火墙允许 <code>FORWARD</code> 链的流量<figure class="highlight shell"><figcaption><span>/etc/sysconfig/iptables</span></figcaption><table><tr><td class="code"><pre><span class="line">*filter</span><br><span class="line">:INPUT DROP [0:0]</span><br><span class="line">:FORWARD ACCEPT [0:0]</span><br><span class="line">:OUTPUT ACCEPT [4:368]</span><br><span class="line"></span><br><span class="line">-A INPUT -m state --state RELATED,ESTABLISHED -j ACCEPT</span><br><span class="line">-A INPUT -i lo -j ACCEPT</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">kubernetes nodes</span></span><br><span class="line">-A INPUT -m comment --comment &quot;kubernetes nodes&quot; -s 172.31.5.58 -j ACCEPT</span><br><span class="line">-A INPUT -m comment --comment &quot;kubernetes nodes&quot; -s 172.31.5.68 -j ACCEPT</span><br><span class="line">-A INPUT -m comment --comment &quot;kubernetes nodes&quot; -s 172.31.0.230 -j ACCEPT</span><br><span class="line"></span><br><span class="line">-A INPUT -p tcp -m multiport --dports 80,443 -j ACCEPT -m comment --comment &quot;k8s ingress http,https&quot;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">-A INPUT -p icmp -m icmp --icmp-type 8 -j ACCEPT</span><br><span class="line">-A INPUT -p icmp -m icmp --icmp-type 0 -j ACCEPT</span><br><span class="line">-A INPUT -j REJECT --reject-with icmp-host-prohibited</span><br><span class="line">COMMIT</span><br></pre></td></tr></table></figure></li>
</ul>
          <!--noindex-->
            <div class="post-button">
              <a class="btn" href="202209121102/#more" rel="contents">
                阅读全文 &raquo;
              </a>
            </div>
          <!--/noindex-->
        
      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://csms.tech/202209301604/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="images/avatar.gif">
      <meta itemprop="name" content="COSMOS">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="L B T">
      <meta itemprop="description" content="得 能 莫 忘">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | L B T">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="202209301604/" class="post-title-link" itemprop="url">ingress-nginx 安装配置</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2022-09-30 16:04:20" itemprop="dateCreated datePublished" datetime="2022-09-30T16:04:20+08:00">2022-09-30</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2025-03-19 11:03:00" itemprop="dateModified" datetime="2025-03-19T11:03:00+08:00">2025-03-19</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">上层目录</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="categories/Kubernetes/" itemprop="url" rel="index"><span itemprop="name">Kubernetes</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="环境信息"><a href="#环境信息" class="headerlink" title="环境信息"></a>环境信息</h1><ul>
<li>Centos7 5.4.212-1</li>
<li>Docker 20.10.18</li>
<li>containerd.io-1.6.8</li>
<li>kubectl-1.25.0</li>
<li>kubeadm-1.25.0</li>
<li>kubelet-1.25.0</li>
</ul>
<h1 id="安装-ingress-nginx-controller"><a href="#安装-ingress-nginx-controller" class="headerlink" title="安装 ingress-nginx controller"></a>安装 ingress-nginx controller</h1><p>此文档中的配置主要针对基于部署在裸机（安装通用 Linux 发行版的物理机或者云主机系统）上的 Kebernetes 集群</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">wget https://raw.githubusercontent.com/kubernetes/ingress-nginx/controller-v1.3.1/deploy/static/provider/cloud/deploy.yaml</span><br><span class="line">mv deploy.yaml ingress-nginx-controller-v1.3.1.yaml</span><br></pre></td></tr></table></figure>

<h2 id="基于-hostNetwork-的-ingress-nginx-controller"><a href="#基于-hostNetwork-的-ingress-nginx-controller" class="headerlink" title="基于 hostNetwork 的 ingress-nginx controller"></a>基于 hostNetwork 的 ingress-nginx controller</h2><p>编辑 <code>ingress-nginx-controller</code> 的 <code>Deployment</code> 配置文件，在 <code>Deployment</code> 中的 <code>.spec.template.spec</code> 下添加字段 <code>hostNetwork: true</code>，以使 <code>ingress-nginx-controller</code> 可以使用节点的主机网络提供对外访问<br><img src="https://i.csms.tech/img_61.png"></p>
          <!--noindex-->
            <div class="post-button">
              <a class="btn" href="202209301604/#more" rel="contents">
                阅读全文 &raquo;
              </a>
            </div>
          <!--/noindex-->
        
      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://csms.tech/202212020941/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="images/avatar.gif">
      <meta itemprop="name" content="COSMOS">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="L B T">
      <meta itemprop="description" content="得 能 莫 忘">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | L B T">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="202212020941/" class="post-title-link" itemprop="url">Kubernetes 网络</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2022-12-02 09:41:16" itemprop="dateCreated datePublished" datetime="2022-12-02T09:41:16+08:00">2022-12-02</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2025-03-17 16:03:00" itemprop="dateModified" datetime="2025-03-17T16:03:00+08:00">2025-03-17</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">上层目录</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="categories/Kubernetes/" itemprop="url" rel="index"><span itemprop="name">Kubernetes</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="环境信息"><a href="#环境信息" class="headerlink" title="环境信息"></a>环境信息</h1><ul>
<li>Centos7 3.10.0-1160</li>
<li>Docker Engine - Community 23.0.3</li>
<li>kubernetes 1.21.2-0</li>
<li>kubernetes-cni-0.8.7-0</li>
</ul>
<p>Kubernetes 对任何网络实现都规定了以下要求： <sup id="fnref:1"><a href="#fn:1" rel="footnote"><span class="hint--top hint--error hint--medium hint--rounded hint--bounce" aria-label="[万字长文，带你搞懂 Kubernetes 网络模型](https://www.51cto.com/article/714336.html)">[1]</span></a></sup></p>
<ul>
<li><p><strong>所有 Pod 都可以在不使用网络地址转换 (NAT) 的情况下与所有其他 Pod 通信。</strong></p>
<p>  容器之间直接通信，不需要额外的 NAT，不存在源地址伪装的情况</p>
</li>
<li><p><strong>所有节点都可以在没有 NAT 的情况下与所有 Pod 通信。</strong></p>
<p>  Node 与容器直接通信，不需要额外的 NAT</p>
</li>
<li><p><strong>Pod 认为自己的 IP 与其他人认为的 IP 相同。</strong></p>
</li>
</ul>
<h1 id="CNI"><a href="#CNI" class="headerlink" title="CNI"></a>CNI</h1><p>CNI 是 Kubernetes 容器网络的标准，CNI 是 Kubernetes 和底层网络插件之间的一个抽象层，为 Kubernetes 屏蔽了底层网络实现的负责度，同时解耦了 Kubernetes 和具体的网络插件实现。</p>
<h2 id="安装-CNI"><a href="#安装-CNI" class="headerlink" title="安装 CNI"></a>安装 CNI</h2><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">yum install kubernetes-cni</span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">rpm -qa | grep kube</span></span><br><span class="line">kubeadm-1.21.2-0.x86_64</span><br><span class="line">kubectl-1.21.2-0.x86_64</span><br><span class="line">kubelet-1.21.2-0.x86_64</span><br><span class="line">kubernetes-cni-0.8.7-0.x86_64</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">rpm -ql kubernetes-cni-0.8.7-0</span></span><br><span class="line">/opt/cni</span><br><span class="line">/opt/cni/bin</span><br><span class="line">/opt/cni/bin/bandwidth</span><br><span class="line">/opt/cni/bin/bridge</span><br><span class="line">/opt/cni/bin/dhcp</span><br><span class="line">/opt/cni/bin/firewall</span><br><span class="line">/opt/cni/bin/flannel</span><br><span class="line">/opt/cni/bin/host-device</span><br><span class="line">/opt/cni/bin/host-local</span><br><span class="line">/opt/cni/bin/ipvlan</span><br><span class="line">/opt/cni/bin/loopback</span><br><span class="line">/opt/cni/bin/macvlan</span><br><span class="line">/opt/cni/bin/portmap</span><br><span class="line">/opt/cni/bin/ptp</span><br><span class="line">/opt/cni/bin/sbr</span><br><span class="line">/opt/cni/bin/static</span><br><span class="line">/opt/cni/bin/tuning</span><br><span class="line">/opt/cni/bin/vlan</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>Kubernetes 要使用 CNI，需要在 kubelet 启动时配置启动参数 <code>--network-plugin=cni</code>（默认配置，可使用 <code>systemctl status kubelet -l</code> 查看启动参数）。</p>
<p>kubelet 从 <code>--cni-config-dir</code> （默认为 <code>/etc/cni/net.d/</code>）中读取网络插件的配置文件，并使用该文件中的 CNI 配置来配置每个 Pod 网络。如果该目录 （<code>/etc/cni/net.d/</code>）中有多个配置文件，则使用文件名字典序列中的第一个文件。</p>
<p>CNI 插件的二进制文件放置的目录是通过 kubelet 的 <code>--cni-bin-dir</code> 参数指定，默认为 <code>/opt/cni/bin/</code></p>
          <!--noindex-->
            <div class="post-button">
              <a class="btn" href="202212020941/#more" rel="contents">
                阅读全文 &raquo;
              </a>
            </div>
          <!--/noindex-->
        
      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://csms.tech/202310051003/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="images/avatar.gif">
      <meta itemprop="name" content="COSMOS">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="L B T">
      <meta itemprop="description" content="得 能 莫 忘">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | L B T">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="202310051003/" class="post-title-link" itemprop="url">etcd</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2023-10-05 10:03:54" itemprop="dateCreated datePublished" datetime="2023-10-05T10:03:54+08:00">2023-10-05</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2025-03-13 16:03:00" itemprop="dateModified" datetime="2025-03-13T16:03:00+08:00">2025-03-13</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">上层目录</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="categories/Linux/" itemprop="url" rel="index"><span itemprop="name">Linux</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="环境信息"><a href="#环境信息" class="headerlink" title="环境信息"></a>环境信息</h1><ul>
<li>etcd v3.5</li>
</ul>
<p><a target="_blank" rel="noopener" href="https://etcd.io/docs/v3.5/install/">etcd 官网安装指南</a><br><a target="_blank" rel="noopener" href="https://github.com/etcd-io/etcd/releases/">Github 下载链接</a></p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">wget https://github.com/etcd-io/etcd/releases/download/v3.5.9/etcd-v3.5.9-linux-amd64.tar.gz</span><br><span class="line"></span><br><span class="line">tar -xf etcd-v3.5.9-linux-amd64.tar.gz -C /usr/local/</span><br><span class="line"></span><br><span class="line">ln -s /usr/local/etcd-v3.5.9-linux-amd64/etcd /usr/bin/</span><br><span class="line">ln -s /usr/local/etcd-v3.5.9-linux-amd64/etcdctl /usr/bin/</span><br><span class="line">ln -s /usr/local/etcd-v3.5.9-linux-amd64/etcdutl /usr/bin/</span><br></pre></td></tr></table></figure>
<p>启动 <code>etcd</code></p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">etcd</span></span><br><span class="line">&#123;&quot;level&quot;:&quot;warn&quot;,&quot;ts&quot;:&quot;2023-10-05T02:16:52.853273Z&quot;,&quot;caller&quot;:&quot;embed/config.go:673&quot;,&quot;msg&quot;:&quot;Running http and grpc server on single port. This is not recommended for production.&quot;&#125;</span><br><span class="line">&#123;&quot;level&quot;:&quot;info&quot;,&quot;ts&quot;:&quot;2023-10-05T02:16:52.853914Z&quot;,&quot;caller&quot;:&quot;etcdmain/etcd.go:73&quot;,&quot;msg&quot;:&quot;Running: &quot;,&quot;args&quot;:[&quot;etcd&quot;]&#125;</span><br><span class="line">&#123;&quot;level&quot;:&quot;warn&quot;,&quot;ts&quot;:&quot;2023-10-05T02:16:52.853947Z&quot;,&quot;caller&quot;:&quot;etcdmain/etcd.go:105&quot;,&quot;msg&quot;:&quot;&#x27;data-dir&#x27; was empty; using default&quot;,&quot;data-dir&quot;:&quot;default.etcd&quot;&#125;</span><br><span class="line">&#123;&quot;level&quot;:&quot;warn&quot;,&quot;ts&quot;:&quot;2023-10-05T02:16:52.853994Z&quot;,&quot;caller&quot;:&quot;embed/config.go:673&quot;,&quot;msg&quot;:&quot;Running http and grpc server on single port. This is not recommended for production.&quot;&#125;</span><br><span class="line">&#123;&quot;level&quot;:&quot;info&quot;,&quot;ts&quot;:&quot;2023-10-05T02:16:52.854009Z&quot;,&quot;caller&quot;:&quot;embed/etcd.go:127&quot;,&quot;msg&quot;:&quot;configuring peer listeners&quot;,&quot;listen-peer-urls&quot;:[&quot;http://localhost:2380&quot;]&#125;</span><br><span class="line">...</span><br></pre></td></tr></table></figure>

<h1 id="常用管理命令"><a href="#常用管理命令" class="headerlink" title="常用管理命令"></a>常用管理命令</h1><h2 id="etcd"><a href="#etcd" class="headerlink" title="etcd"></a>etcd</h2><h3 id="查看版本信息"><a href="#查看版本信息" class="headerlink" title="查看版本信息"></a>查看版本信息</h3><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">etcd --version</span></span><br><span class="line">etcd Version: 3.5.3</span><br><span class="line">Git SHA: 0452feec7</span><br><span class="line">Go Version: go1.16.15</span><br><span class="line">Go OS/Arch: linux/amd64</span><br></pre></td></tr></table></figure>

<h3 id="创建集群"><a href="#创建集群" class="headerlink" title="创建集群"></a>创建集群</h3><p><code>etcd</code> 创建集群涉及参数说明</p>
<table>
<thead>
<tr>
<th>name</th>
<th>说明</th>
<th>命令行参数</th>
</tr>
</thead>
<tbody><tr>
<td><code>name</code></td>
<td>每个集群成员的唯一名称</td>
<td><code>--name=etcd0</code></td>
</tr>
<tr>
<td><code>initial-advertise-peer-urls</code></td>
<td>群成员广播给集群其他成员（用于连接本节点）的 URL<br/>默认为 <code>http://IP:2380</code></td>
<td><code>--initial-advertise-peer-urls=http://10.0.0.10:2380</code></td>
</tr>
<tr>
<td><code>listen-peer-urls</code></td>
<td>在这些（一个或多个） URL 上监听其他集群成员的连接请求<br/>通信包括了集群管理任务、数据同步和心跳检测等</td>
<td><code>http://10.0.0.10:2380,http://127.0.0.1:2380</code></td>
</tr>
<tr>
<td><code>listen-client-urls</code></td>
<td>该成员监听客户端连接的 URL。 默认端口 2379</td>
<td><code>--listen-client-urls=http://10.0.0.10:2379,http://127.0.0.1:2379</code></td>
</tr>
<tr>
<td><code>advertise-client-urls</code></td>
<td>该成员广播给客户端的 URL</td>
<td><code>--advertise-client-urls=http://10.0.0.10:2379</code></td>
</tr>
<tr>
<td><code>initial-cluster</code></td>
<td>所有 <code>etcd</code> 成员的初始列表</td>
<td><code>--initial-cluster=etcd0=http://10.0.0.10:2380,etcd1=http://10.0.0.11:2380,etcd2=http://10.0.0.12:2380</code></td>
</tr>
<tr>
<td><code>data-dir</code></td>
<td><code>etcd</code> 数据的存储目录。</td>
<td><code>--data-dir=/var/lib/etcd</code></td>
</tr>
<tr>
<td><code>initial-cluster-token</code></td>
<td>初始集群的唯一标识符，用于区分不同的 <code>etcd</code> 集群</td>
<td><code>--initial-cluster-token=my-etcd-token</code></td>
</tr>
<tr>
<td><code>initial-cluster-state</code></td>
<td>初始集群状态，可以是 <code>new</code> 或 <code>existing</code>。<br/>通常在引导新集群时使用 <code>new</code>，而在添加或删除成员时使用 <code>existing</code>。</td>
<td><code>--initial-cluster-state=new</code></td>
</tr>
<tr>
<td><code>quota-backend-bytes</code></td>
<td><code>etcd</code> 的后端数据库大小的硬限制，默认是 2GB</td>
<td><code>--quota-backend-bytes=3000000000</code></td>
</tr>
<tr>
<td><code>cert-file</code><br/><code>key-file</code></td>
<td>用于 HTTPS 的证书和私钥</td>
<td><code>--cert-file=/etc/kubernetes/pki/etcd/server.crt</code> <br/><code>--key-file=/etc/kubernetes/pki/etcd/server.key</code></td>
</tr>
<tr>
<td><code>trusted-ca-file</code></td>
<td>客户端和对等体的验证所需的 CA 证书</td>
<td><code>--trusted-ca-file=/etc/kubernetes/pki/etcd/ca.crt</code></td>
</tr>
<tr>
<td><code>client-cert-auth</code></td>
<td>启用客户端证书验证，默认为 <code>false</code></td>
<td><code>--client-cert-auth</code></td>
</tr>
</tbody></table>
<p><code>listen-peer-urls</code> 和 <code>initial-advertise-peer-urls</code> 的区别说明：</p>
<ul>
<li><p><code>listen-peer-urls</code></p>
<p>  这个参数指定了 <code>etcd</code> 成员应该在哪些地址和端口上监听来自其他 <code>etcd</code> 成员的请求（数据同步、领导选举、集群更改等相关）</p>
<p> 主要用途是定义哪个网络接口和端口号应该被 <code>etcd</code> 服务绑定，以便它可以接收来自其他成员的连接</p>
</li>
<li><p><code>initial-advertise-peer-urls</code></p>
<p> 这个参数告诉 <code>etcd</code> 该如何 <em><strong>通告自己</strong></em> 给集群中的其他成员。这是其他集群成员用来联系此 <code>etcd</code> 成员的地址。</p>
<p> 主要用途是 <strong>当新成员加入集群时，它需要通知其他成员自己的存在，以及如何与自己通信</strong>，因此它必须是个其他节点可达的 Endpoints，如 <code>http://0.0.0.0:2380</code> 就不行。</p>
<blockquote>
<p><code>listen-client-urls</code> 和 <code>advertise-client-urls</code> 的区别同理</p>
</blockquote>
</li>
</ul>
<p>示例环境说明</p>
<table>
<thead>
<tr>
<th>主机</th>
<th>IP</th>
<th>角色</th>
</tr>
</thead>
<tbody><tr>
<td>etcd1</td>
<td>172.17.0.2&#x2F;16</td>
<td>etcd node</td>
</tr>
<tr>
<td>etcd2</td>
<td>172.17.0.3&#x2F;16</td>
<td>etcd node</td>
</tr>
<tr>
<td>etcd3</td>
<td>172.17.0.4&#x2F;16</td>
<td>etcd node</td>
</tr>
</tbody></table>
<p>分别在 3 个节点上执行以下 3 条命令，创建集群</p>
<p><code>etcd1</code> 执行命令：</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">etcd --data-dir=data.etcd --name etcd1 \</span><br><span class="line">	--initial-advertise-peer-urls http://172.17.0.2:2380 --listen-peer-urls http://172.17.0.2:2380,http://127.0.0.1:2380 \</span><br><span class="line">	--advertise-client-urls http://172.17.0.2:2379 --listen-client-urls http://172.17.0.2:2379,http://127.0.0.1:2379 \</span><br><span class="line">	--initial-cluster etcd1=http://172.17.0.2:2380,etcd2=http://172.17.0.3:2380,etcd3=http://172.17.0.4:2380 \</span><br><span class="line">	--initial-cluster-state new --initial-cluster-token etcd-cluster</span><br></pre></td></tr></table></figure>

<p><code>etcd2</code> 执行命令：	</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">etcd --data-dir=data.etcd --name etcd2 \</span><br><span class="line">	--initial-advertise-peer-urls http://172.17.0.3:2380 --listen-peer-urls http://172.17.0.3:2380,http://127.0.0.1:2380 \</span><br><span class="line">	--advertise-client-urls http://172.17.0.3:2379 --listen-client-urls http://172.17.0.3:2379,http://127.0.0.1:2379 \</span><br><span class="line">	--initial-cluster etcd1=http://172.17.0.2:2380,etcd2=http://172.17.0.3:2380,etcd3=http://172.17.0.4:2380 \</span><br><span class="line">	--initial-cluster-state new --initial-cluster-token etcd-cluster</span><br></pre></td></tr></table></figure>
<p><code>etcd3</code> 执行命令：	</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">etcd --data-dir=data.etcd --name etcd3 \</span><br><span class="line">	--initial-advertise-peer-urls http://172.17.0.4:2380 --listen-peer-urls http://172.17.0.4:2380,http://127.0.0.1:2380 \</span><br><span class="line">	--advertise-client-urls http://172.17.0.4:2379 --listen-client-urls http://172.17.0.4:2379,http://127.0.0.1:2379 \</span><br><span class="line">	--initial-cluster etcd1=http://172.17.0.2:2380,etcd2=http://172.17.0.3:2380,etcd3=http://172.17.0.4:2380 \</span><br><span class="line">	--initial-cluster-state new --initial-cluster-token etcd-cluster	</span><br></pre></td></tr></table></figure>

<p>检查节点健康状态</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">ENDPOINT=http://172.17.0.3:2380,http://172.17.0.2:2380,http://172.17.0.4:2380</span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">etcdctl endpoint status --endpoints=<span class="variable">$ENDPOINT</span> -w table</span> </span><br><span class="line">+------------------------+------------------+---------+---------+-----------+------------+-----------+------------+--------------------+--------+</span><br><span class="line">|        ENDPOINT        |        ID        | VERSION | DB SIZE | IS LEADER | IS LEARNER | RAFT TERM | RAFT INDEX | RAFT APPLIED INDEX | ERRORS |</span><br><span class="line">+------------------------+------------------+---------+---------+-----------+------------+-----------+------------+--------------------+--------+</span><br><span class="line">| http://172.17.0.3:2380 | 660aa483274d103a |   3.5.9 |   20 kB |     false |      false |         2 |          9 |                  9 |        |</span><br><span class="line">| http://172.17.0.2:2380 | 69015be41c714f32 |   3.5.9 |   20 kB |      true |      false |         2 |          9 |                  9 |        |</span><br><span class="line">| http://172.17.0.4:2380 | ad0233873e2a0054 |   3.5.9 |   20 kB |     false |      false |         2 |          9 |                  9 |        |</span><br><span class="line">+------------------------+------------------+---------+---------+-----------+------------+-----------+------------+--------------------+--------+</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">etcdctl endpoint health --endpoints=<span class="variable">$ENDPOINT</span> -w table</span></span><br><span class="line">+------------------------+--------+------------+-------+</span><br><span class="line">|        ENDPOINT        | HEALTH |    TOOK    | ERROR |</span><br><span class="line">+------------------------+--------+------------+-------+</span><br><span class="line">| http://172.17.0.2:2380 |   true |  2.44553ms |       |</span><br><span class="line">| http://172.17.0.3:2380 |   true | 2.804559ms |       |</span><br><span class="line">| http://172.17.0.4:2380 |   true | 2.580515ms |       |</span><br><span class="line">+------------------------+--------+------------+-------+</span><br></pre></td></tr></table></figure>

<h2 id="etcdctl"><a href="#etcdctl" class="headerlink" title="etcdctl"></a>etcdctl</h2><h3 id="查看版本信息-1"><a href="#查看版本信息-1" class="headerlink" title="查看版本信息"></a>查看版本信息</h3><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">etcdctl version</span></span><br><span class="line">etcdctl version: 3.5.3</span><br><span class="line">API version: 3.5</span><br></pre></td></tr></table></figure>

<h3 id="etcd-集群管理"><a href="#etcd-集群管理" class="headerlink" title="etcd 集群管理"></a>etcd 集群管理</h3><h4 id="查看-etcd-集群成员列表"><a href="#查看-etcd-集群成员列表" class="headerlink" title="查看 etcd 集群成员列表"></a>查看 etcd 集群成员列表</h4><p>Kubernetes 中查看 <code>etcd</code> 集群成员列表使用如下命令</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">kubectl <span class="built_in">exec</span> -n kube-system -it etcd-k8s-master1 -- sh -c <span class="string">&quot;ETCDCTL_API=3 etcdctl member list --endpoints=https://127.0.0.1:2379 --cacert=/etc/kubernetes/pki/etcd/ca.crt --cert=/etc/kubernetes/pki/etcd/server.crt --key=/etc/kubernetes/pki/etcd/server.key&quot;</span></span></span><br><span class="line">3c087bf12db7a0f, started, k8s-master2, https://172.31.30.115:2380, https://172.31.30.115:2379, false</span><br><span class="line">92e04392f8ad0046, started, k8s-master3, https://172.31.29.250:2380, https://172.31.29.250:2379, false</span><br><span class="line">c71592552b3eb9bb, started, k8s-master1, https://172.31.30.123:2380, https://172.31.30.123:2379, false</span><br></pre></td></tr></table></figure>
<p>指定输出格式为 <code>table</code></p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">etcdctl member list --cacert=/etc/kubernetes/pki/etcd/ca.crt --cert=/etc/kubernetes/pki/etcd/server.crt --key=/etc/kubernetes/pki/etcd/server.key --write-out=table</span></span><br><span class="line">+------------------+---------+-------------+----------------------------+----------------------------+------------+</span><br><span class="line">|        ID        | STATUS  |     NAME    |         PEER ADDRS         |        CLIENT ADDRS        | IS LEARNER |</span><br><span class="line">+------------------+---------+-------------+----------------------------+----------------------------+------------+</span><br><span class="line">|  3c087bf12db7a0f | started | k8s-master2 | https://172.31.30.115:2380 | https://172.31.30.115:2379 |      false |</span><br><span class="line">| 92e04392f8ad0046 | started | k8s-master3 | https://172.31.29.250:2380 | https://172.31.29.250:2379 |      false |</span><br><span class="line">| c71592552b3eb9bb | started | k8s-master1 | https://172.31.30.123:2380 | https://172.31.30.123:2379 |      false |</span><br><span class="line">+------------------+---------+-------------+----------------------------+----------------------------+------------+</span><br></pre></td></tr></table></figure>

<p>输出内容说明如下：</p>
<ul>
<li><code>3c087bf12db7a0f</code> : 集群中每一个成员的唯一 ID。</li>
<li><code>started</code> : 集群成员的当前状态。<code>started</code> 表示活动的。</li>
<li><code>k8s-master2</code> : <code>etcd</code> 集群成员的名字，通常与其主机名或节点名相对应</li>
<li><code>https://172.31.30.115:2380</code> : <code>Peer URLs</code>，其他 <code>etcd</code> 成员用于与该成员通信的 URL。默认为 本地 IP 的 2380 端口</li>
<li><code>https://172.31.30.123:2379</code> : <code>Client URLs</code> ，客户端用于与 <code>etcd</code> 成员通信的 URL。默认为 本地 IP 的 2379 端口</li>
<li><code>Is Learner</code> : 表示该成员是否是一个 <code>learner</code>。Learner 是 <code>etcd</code> 的一个新功能，允许一个成员作为非投票成员加入集群，直到它准备好成为一个完全参与的成员。<code>false</code> 表示它们都不是 <code>learners</code></li>
</ul>
<h4 id="检查集群状态"><a href="#检查集群状态" class="headerlink" title="检查集群状态"></a>检查集群状态</h4><p>检查单个节点的集群配置状态</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">etcdctl --write-out=table endpoint status --cacert=/etc/kubernetes/pki/etcd/ca.crt --cert=/etc/kubernetes/pki/etcd/server.crt --key=/etc/kubernetes/pki/etcd/server.key</span></span><br><span class="line">+----------------+------------------+---------+---------+-----------+------------+-----------+------------+--------------------+--------+</span><br><span class="line">|    ENDPOINT    |        ID        | VERSION | DB SIZE | IS LEADER | IS LEARNER | RAFT TERM | RAFT INDEX | RAFT APPLIED INDEX | ERRORS |</span><br><span class="line">+----------------+------------------+---------+---------+-----------+------------+-----------+------------+--------------------+--------+</span><br><span class="line">| 127.0.0.1:2379 | c71592552b3eb9bb |   3.5.3 |  106 MB |     false |      false |        16 |  228198001 |          228198001 |        |</span><br><span class="line">+----------------+------------------+---------+---------+-----------+------------+-----------+------------+--------------------+--------+</span><br></pre></td></tr></table></figure>
<p>查看所有节点的集群配置状态</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">ENDPOINTS=https://172.31.30.115:2379,https://172.31.29.250:2379,https://172.31.30.123:2379</span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">etcdctl --write-out=table --endpoints=<span class="variable">$ENDPOINTS</span> endpoint status</span> </span><br><span class="line">+----------------------------+------------------+---------+---------+-----------+------------+-----------+------------+--------------------+--------+</span><br><span class="line">|          ENDPOINT          |        ID        | VERSION | DB SIZE | IS LEADER | IS LEARNER | RAFT TERM | RAFT INDEX | RAFT APPLIED INDEX | ERRORS |</span><br><span class="line">+----------------------------+------------------+---------+---------+-----------+------------+-----------+------------+--------------------+--------+</span><br><span class="line">| https://172.31.30.115:2379 |  3c087bf12db7a0f |   3.5.3 |  106 MB |      true |      false |        16 |  228199920 |          228199920 |        |</span><br><span class="line">| https://172.31.29.250:2379 | 92e04392f8ad0046 |   3.5.3 |  106 MB |     false |      false |        16 |  228199920 |          228199920 |        |</span><br><span class="line">| https://172.31.30.123:2379 | c71592552b3eb9bb |   3.5.3 |  106 MB |     false |      false |        16 |  228199920 |          228199920 |        |</span><br><span class="line">+----------------------------+------------------+---------+---------+-----------+------------+-----------+------------+--------------------+--------+</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">etcdctl --write-out=table --endpoints=<span class="variable">$ENDPOINTS</span> endpoint health</span></span><br><span class="line">+----------------------------+--------+------------+-------+</span><br><span class="line">|          ENDPOINT          | HEALTH |    TOOK    | ERROR |</span><br><span class="line">+----------------------------+--------+------------+-------+</span><br><span class="line">| https://172.31.30.115:2379 |   true | 7.927976ms |       |</span><br><span class="line">| https://172.31.30.123:2379 |   true | 8.011055ms |       |</span><br><span class="line">| https://172.31.29.250:2379 |   true | 8.349179ms |       |</span><br><span class="line">+----------------------------+--------+------------+-------+</span><br></pre></td></tr></table></figure>
          <!--noindex-->
            <div class="post-button">
              <a class="btn" href="202310051003/#more" rel="contents">
                阅读全文 &raquo;
              </a>
            </div>
          <!--/noindex-->
        
      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://csms.tech/202209140931/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="images/avatar.gif">
      <meta itemprop="name" content="COSMOS">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="L B T">
      <meta itemprop="description" content="得 能 莫 忘">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | L B T">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="202209140931/" class="post-title-link" itemprop="url">Linux 升级内核</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2022-09-14 09:32:00" itemprop="dateCreated datePublished" datetime="2022-09-14T09:32:00+08:00">2022-09-14</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2025-03-11 10:03:00" itemprop="dateModified" datetime="2025-03-11T10:03:00+08:00">2025-03-11</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">上层目录</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="categories/Linux/" itemprop="url" rel="index"><span itemprop="name">Linux</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p><strong>适用以下版本</strong></p>
<ul>
<li>Centos 7 内核升级</li>
<li>Centos 8 或 Rocky Linux 8 内核升级</li>
</ul>
<p><strong>环境息息</strong></p>
<ul>
<li>Centos7 3.10.0-1062.9.1.el7.x86_64</li>
<li>Rocky Linux 8</li>
</ul>
<h1 id="升级步骤"><a href="#升级步骤" class="headerlink" title="升级步骤"></a>升级步骤</h1><h2 id="安装-centos-kernel"><a href="#安装-centos-kernel" class="headerlink" title="安装 centos-kernel"></a>安装 centos-kernel</h2><p><strong>如果是 Centos 7 ，参考以下命令安装 <code>centos-kernel</code> 源</strong></p>
<blockquote>
<p><code>elrepo-kernel</code> 中已经没有 Centos 7 相关的内核安装包</p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">yum install centos-release</span><br></pre></td></tr></table></figure>

<h2 id="安装-elrepo-源"><a href="#安装-elrepo-源" class="headerlink" title="安装 elrepo 源"></a>安装 elrepo 源</h2><p><strong>如果是 Centos 8 或 Rocky Linux 8，参考以下命令安装 <code>elrepo</code> 源</strong></p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">rpm --import https://www.elrepo.org/RPM-GPG-KEY-elrepo.org</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">rpm --import https://www.elrepo.org/RPM-GPG-KEY-v2-elrepo.org</span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">yum install https://www.elrepo.org/elrepo-release-8.el8.elrepo.noarch.rpm</span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">yum --disablerepo=<span class="string">&quot;*&quot;</span> --enablerepo=<span class="string">&quot;elrepo-kernel&quot;</span> list available</span></span><br><span class="line">Last metadata expiration check: 0:00:14 ago on Fri 28 Feb 2025 11:42:09 AM HKT.</span><br><span class="line">Available Packages</span><br><span class="line">bpftool.x86_64                                                                5.4.290-1.el8.elrepo                                              elrepo-kernel</span><br><span class="line">kernel-lt.x86_64                                                              5.4.290-1.el8.elrepo                                              elrepo-kernel</span><br><span class="line">kernel-lt-core.x86_64                                                         5.4.290-1.el8.elrepo                                              elrepo-kernel</span><br><span class="line">kernel-lt-devel.x86_64                                                        5.4.290-1.el8.elrepo                                              elrepo-kernel</span><br><span class="line">kernel-lt-doc.noarch                                                          5.4.290-1.el8.elrepo                                              elrepo-kernel</span><br><span class="line">kernel-lt-headers.x86_64                                                      5.4.290-1.el8.elrepo                                              elrepo-kernel</span><br><span class="line">kernel-lt-modules.x86_64                                                      5.4.290-1.el8.elrepo                                              elrepo-kernel</span><br><span class="line">kernel-lt-modules-extra.x86_64                                                5.4.290-1.el8.elrepo                                              elrepo-kernel</span><br><span class="line">kernel-lt-tools.x86_64                                                        5.4.290-1.el8.elrepo                                              elrepo-kernel</span><br><span class="line">kernel-lt-tools-libs.x86_64                                                   5.4.290-1.el8.elrepo                                              elrepo-kernel</span><br><span class="line">kernel-lt-tools-libs-devel.x86_64                                             5.4.290-1.el8.elrepo                                              elrepo-kernel</span><br><span class="line">kernel-ml.x86_64                                                              6.13.5-1.el8.elrepo                                               elrepo-kernel</span><br><span class="line">kernel-ml-core.x86_64                                                         6.13.5-1.el8.elrepo                                               elrepo-kernel</span><br><span class="line">kernel-ml-devel.x86_64                                                        6.13.5-1.el8.elrepo                                               elrepo-kernel</span><br><span class="line">kernel-ml-doc.noarch                                                          6.13.5-1.el8.elrepo                                               elrepo-kernel</span><br><span class="line">kernel-ml-headers.x86_64                                                      6.13.5-1.el8.elrepo                                               elrepo-kernel</span><br><span class="line">kernel-ml-modules.x86_64                                                      6.13.5-1.el8.elrepo                                               elrepo-kernel</span><br><span class="line">kernel-ml-modules-extra.x86_64                                                6.13.5-1.el8.elrepo                                               elrepo-kernel</span><br><span class="line">kernel-ml-tools.x86_64                                                        6.13.5-1.el8.elrepo                                               elrepo-kernel</span><br><span class="line">kernel-ml-tools-libs.x86_64                                                   6.13.5-1.el8.elrepo                                               elrepo-kernel</span><br><span class="line">kernel-ml-tools-libs-devel.x86_64                                             6.13.5-1.el8.elrepo                                               elrepo-kernel</span><br><span class="line">perf.x86_64                                                                   6.13.5-1.el8.elrepo                                               elrepo-kernel</span><br><span class="line">python3-perf.x86_64                                                           6.13.5-1.el8.elrepo                                               elrepo-kernel</span><br></pre></td></tr></table></figure>
          <!--noindex-->
            <div class="post-button">
              <a class="btn" href="202209140931/#more" rel="contents">
                阅读全文 &raquo;
              </a>
            </div>
          <!--/noindex-->
        
      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://csms.tech/20241127142554/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="images/avatar.gif">
      <meta itemprop="name" content="COSMOS">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="L B T">
      <meta itemprop="description" content="得 能 莫 忘">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | L B T">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="20241127142554/" class="post-title-link" itemprop="url">Linux 性能分析工具 strace</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2024-11-27 11:11:00" itemprop="dateCreated datePublished" datetime="2024-11-27T11:11:00+08:00">2024-11-27</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2025-03-10 16:03:00" itemprop="dateModified" datetime="2025-03-10T16:03:00+08:00">2025-03-10</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">上层目录</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="categories/Linux/" itemprop="url" rel="index"><span itemprop="name">Linux</span></a>
        </span>
          ，
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="categories/Linux/%E6%80%A7%E8%83%BD%E5%88%86%E6%9E%90/" itemprop="url" rel="index"><span itemprop="name">性能分析</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css"><p><code>strace</code> 命令示例，详细使用说明请参考 <code>man strace</code></p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">strace <span class="built_in">ls</span></span></span><br><span class="line">execve(&quot;/usr/bin/ls&quot;, [&quot;ls&quot;], 0x7ffe75aa9350 /* 12 vars */) = 0</span><br><span class="line">brk(NULL)                               = 0x556c51ed9000</span><br><span class="line">arch_prctl(0x3001 /* ARCH_??? */, 0x7ffc20fecaf0) = -1 EINVAL (Invalid argument)</span><br><span class="line">mmap(NULL, 8192, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_ANONYMOUS, -1, 0) = 0x7f2b1b0a2000</span><br><span class="line">access(&quot;/etc/ld.so.preload&quot;, R_OK)      = -1 ENOENT (No such file or directory)</span><br><span class="line">openat(AT_FDCWD, &quot;/etc/ld.so.cache&quot;, O_RDONLY|O_CLOEXEC) = 3</span><br><span class="line">newfstatat(3, &quot;&quot;, &#123;st_mode=S_IFREG|0644, st_size=34211, ...&#125;, AT_EMPTY_PATH) = 0</span><br><span class="line">mmap(NULL, 34211, PROT_READ, MAP_PRIVATE, 3, 0) = 0x7f2b1b099000</span><br><span class="line">close(3)                                = 0</span><br><span class="line">openat(AT_FDCWD, &quot;/lib/x86_64-linux-gnu/libselinux.so.1&quot;, O_RDONLY|O_CLOEXEC) = 3</span><br><span class="line">read(3, &quot;\177ELF\2\1\1\0\0\0\0\0\0\0\0\0\3\0&gt;\0\1\0\0\0\0\0\0\0\0\0\0\0&quot;..., 832) = 832</span><br><span class="line">...</span><br></pre></td></tr></table></figure>

<p><code>strace</code> 跟踪输出中包含</p>
<ul>
<li><strong>Syscall Name</strong> ，如 <code>execve</code> 、 <code>openat</code> 等</li>
<li><strong>Arguments</strong> ， 系统调用使用的参数，如 <code>&quot;/usr/bin/ls&quot;</code> 、 <code>AT_FDCWD, &quot;/etc/ld.so.cache&quot;, O_RDONLY|O_CLOEXEC</code></li>
<li><strong>Return Value</strong> ，系统调用的返回值以及简要说明信息， 如 <code>= -1 EINVAL (Invalid argument)</code> 、 <code>-1 ENOENT (No such file or directory)</code> 、 <code>= 0</code></li>
</ul>
<h1 id="strace-命令常用选项"><a href="#strace-命令常用选项" class="headerlink" title="strace 命令常用选项"></a>strace 命令常用选项</h1><table>
<thead>
<tr>
<th>选项</th>
<th>说明</th>
<th>示例</th>
</tr>
</thead>
<tbody><tr>
<td><code>-o filename</code><br/><code>--output=filename</code></td>
<td>将跟踪内容写入指定文件而不是 STDOUT（默认值）</td>
<td></td>
</tr>
<tr>
<td><code>-p pid</code><br/><code>--attach=pid</code></td>
<td>追踪 PIDs 对应的进程，<code>Ctrl + C</code> 结束追踪。 <strong>支持 <code>,</code> 、 空格 （ <code> </code> ） 、 TAB 键（ <code>\t</code> ）分割的多个 PID</strong></td>
<td></td>
</tr>
<tr>
<td><code>-e expr</code></td>
<td>追踪表达式匹配的系统调用，表达式语法请参考 <code>man strace</code></td>
<td></td>
</tr>
<tr>
<td><code>-c</code><br/><code>--summary-only</code></td>
<td>仅输出调用的统计数据，不输出常规跟踪内容</td>
<td></td>
</tr>
<tr>
<td><code>-C</code><br/><code>--summary</code></td>
<td>输出常规跟踪内容后，输出统计信息</td>
<td></td>
</tr>
</tbody></table>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://csms.tech/202308311109/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="images/avatar.gif">
      <meta itemprop="name" content="COSMOS">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="L B T">
      <meta itemprop="description" content="得 能 莫 忘">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | L B T">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="202308311109/" class="post-title-link" itemprop="url">Ansible 使用介绍</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2023-08-31 11:09:16" itemprop="dateCreated datePublished" datetime="2023-08-31T11:09:16+08:00">2023-08-31</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2025-03-06 14:03:00" itemprop="dateModified" datetime="2025-03-06T14:03:00+08:00">2025-03-06</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">上层目录</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="categories/Linux/" itemprop="url" rel="index"><span itemprop="name">Linux</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="环境信息"><a href="#环境信息" class="headerlink" title="环境信息"></a>环境信息</h1><ul>
<li>Centos 7</li>
<li>ansible-core 2.16</li>
<li>Docker image python:3.12.3</li>
</ul>
<h1 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h1><p><a target="_blank" rel="noopener" href="https://docs.ansible.com/ansible/latest/reference_appendices/release_and_maintenance.html#ansible-core-target-node-python-support"><code>ansible-core</code> 版本及 Python 版本支持对应关系</a></p>
<table>
<thead>
<tr>
<th>ansible-core Version</th>
<th>Control Node Python</th>
<th>Target Python &#x2F; PowerShell</th>
</tr>
</thead>
<tbody><tr>
<td>2.16</td>
<td>Python 3.10 - 3.12</td>
<td>Python 2.7<br/>Python 3.6 - 3.12<br/>Powershell 3 - 5.1</td>
</tr>
</tbody></table>
<p>为了环境部署方便灵活，可以选择使用 <code>python:3.12.3</code> 的 Docker 镜像，以其为基础环境安装 <code>ansible-core 2.16</code> 或者直接使用 <code>ansible</code> 镜像启动。</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">docker run --<span class="built_in">rm</span> -it python:3.12.3 bash</span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="built_in">cat</span> /etc/os-release</span> </span><br><span class="line">PRETTY_NAME=&quot;Debian GNU/Linux 12 (bookworm)&quot;</span><br><span class="line">NAME=&quot;Debian GNU/Linux&quot;</span><br><span class="line">VERSION_ID=&quot;12&quot;</span><br><span class="line">VERSION=&quot;12 (bookworm)&quot;</span><br><span class="line">VERSION_CODENAME=bookworm</span><br><span class="line">ID=debian</span><br><span class="line">HOME_URL=&quot;https://www.debian.org/&quot;</span><br><span class="line">SUPPORT_URL=&quot;https://www.debian.org/support&quot;</span><br><span class="line">BUG_REPORT_URL=&quot;https://bugs.debian.org/&quot;</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">python --version</span></span><br><span class="line">Python 3.12.3</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">pip install ansible</span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">pip list</span></span><br><span class="line">Package      Version</span><br><span class="line">------------ -------</span><br><span class="line">ansible      9.5.1</span><br><span class="line">ansible-core 2.16.6</span><br><span class="line">cffi         1.16.0</span><br><span class="line">cryptography 42.0.7</span><br><span class="line">Jinja2       3.1.4</span><br><span class="line">MarkupSafe   2.1.5</span><br><span class="line">packaging    24.0</span><br><span class="line">pip          24.0</span><br><span class="line">pycparser    2.22</span><br><span class="line">PyYAML       6.0.1</span><br><span class="line">resolvelib   1.0.1</span><br><span class="line">setuptools   69.5.1</span><br><span class="line">wheel        0.43.0</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">ansible --version</span></span><br><span class="line">ansible [core 2.16.6]</span><br><span class="line">  config file = None</span><br><span class="line">  configured module search path = [&#x27;/root/.ansible/plugins/modules&#x27;, &#x27;/usr/share/ansible/plugins/modules&#x27;]</span><br><span class="line">  ansible python module location = /usr/local/lib/python3.12/site-packages/ansible</span><br><span class="line">  ansible collection location = /root/.ansible/collections:/usr/share/ansible/collections</span><br><span class="line">  executable location = /usr/local/bin/ansible</span><br><span class="line">  python version = 3.12.3 (main, May 14 2024, 07:23:41) [GCC 12.2.0] (/usr/local/bin/python)</span><br><span class="line">  jinja version = 3.1.4</span><br><span class="line">  libyaml = True</span><br></pre></td></tr></table></figure>

<h1 id="Ansible-配置说明"><a href="#Ansible-配置说明" class="headerlink" title="Ansible 配置说明"></a>Ansible 配置说明</h1><p>Ansible 主配置文件为 <code>/etc/ansible/ansible.cfg</code>，<em><strong>其中的配置都可以被 <code>ansible-playbook</code> 或者命令行参数覆盖</strong></em>。</p>
<blockquote>
<p>ansible 默认会读取环境变量 <code>ANSIBLE_CONFIG</code> 指定的配置文件，当前路径下的 <code>ansible.cfg</code>，以及用户家目录下的 <code>.ansible.cfg</code>，以及 <code>/etc/ansible/ansible.cfg</code> 作为配置文件，已第一个找到的为准</p>
</blockquote>
<p>常用配置说明</p>
<table>
<thead>
<tr>
<th>配置项</th>
<th>说明</th>
<th>示例</th>
</tr>
</thead>
<tbody><tr>
<td><code>inventory</code></td>
<td>指定 inventory （主机列表）文件的路径，默认为 <code>/etc/ansible/hosts</code></td>
<td></td>
</tr>
<tr>
<td><code>remote_user</code></td>
<td>（未指定用户时）连接远程主机时使用的用户</td>
<td></td>
</tr>
<tr>
<td><code>remote_port</code></td>
<td>连接远程主机时使用的(默认)端口</td>
<td></td>
</tr>
<tr>
<td><code>host_key_checking</code></td>
<td>默认启用。检查主机密钥可以防止服务器欺骗和中间人攻击。<br/>如果主机重新安装并且在 <code>know_hosts</code> 中拥有不同的密钥，ansible 会提示确认密钥。<br/>如果要禁用此行为，可以配置为 <code>False</code></td>
<td></td>
</tr>
<tr>
<td><code>ask_pass</code></td>
<td>默认为 False。当设置为 True 时，ansible 要求输入远端服务器的密码，即使配置了免密登录</td>
<td></td>
</tr>
<tr>
<td><code>log_path</code></td>
<td>日志文件，默认 <code>/var/log/ansible.log </code></td>
<td></td>
</tr>
<tr>
<td><code>pattern</code></td>
<td>当没有给出 <code>pattern</code> 时的默认 <code>pattern</code>，默认值是 <code>*</code> 即所有主机</td>
<td></td>
</tr>
</tbody></table>
<p>配置示例</p>
<figure class="highlight shell"><figcaption><span>/etc/ansible/ansible.cfg</span></figcaption><table><tr><td class="code"><pre><span class="line">[defaults]</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">设置默认的 inventory 文件路径</span></span><br><span class="line">inventory = /etc/ansible/hosts</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">关闭主机密钥检查，方便新主机的快速添加</span></span><br><span class="line">host_key_checking = False</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">设置默认的远程用户</span></span><br><span class="line">remote_user = ansible</span><br></pre></td></tr></table></figure>

<h1 id="Inventory-配置说明"><a href="#Inventory-配置说明" class="headerlink" title="Inventory 配置说明"></a>Inventory 配置说明</h1><p>默认的 inventory 配置文件路径为 <code>/etc/ansible/hosts</code>，主要用来配置 Managed Hosts 列表 <sup id="fnref:3"><a href="#fn:3" rel="footnote"><span class="hint--top hint--error hint--medium hint--rounded hint--bounce" aria-label="[How to build your inventory](https://docs.ansible.com/ansible/latest/inventory_guide/intro_inventory.html#how-to-build-your-inventory)">[3]</span></a></sup></p>
<p>在命令行中，可以使用选项 <code>-i &lt;path&gt;</code> 指定不同的 <code>inventory</code> 或者可以在 <code>ansible</code> 配置文件 <code>ansible.cfg</code> 中使用指令 <code>inventory</code> 指定 <code>inventory</code> 文件位置。 </p>
<blockquote>
<p>命令行中可以使用 <code>-i &lt;path1&gt; -i &lt;path2&gt; ...</code> 指定多个 <code>inventory</code>  </p>
</blockquote>
<p><code>inventory</code> 文件支持多种格式，最常见的是 <code>INI</code> 和 <code>YAML</code> 格式。</p>
<ul>
<li>Ansible 默认创建了 2 个组：<ul>
<li><code>all</code> : 包含所有主机</li>
<li><code>ungrouped</code> : 包含所有不在其他组（<code>all</code> 除外）中的所有主机。<blockquote>
<p>任何一个主机都会至少在 2 个组中，要么 <strong>在 <code>all</code> 和某个组中</strong>，要么 <strong>在 <code>all</code> 和 <code>ungrouped</code> 组</strong>。</p>
</blockquote>
</li>
</ul>
</li>
<li><strong>一个主机可以包含在多个组中</strong></li>
<li><strong><code>parent/child</code> 组</strong>，<code>child</code> 组被包含在 <code>parent</code> 组中。<ul>
<li>INI 配置格式中，使用 <code>:children</code> 后缀配置 <code>parent</code></li>
<li>YAML 配置格式中，使用 <code>children:</code> 配置 <code>parent</code><blockquote>
<ul>
<li>任何在 <code>child</code> 组中的主机自动成为 <code>parent</code> 组中的一员</li>
<li>一个组可以包括多个 <code>parent</code> 和 <code>child</code> 组，<em><strong>但是不能形成循环关系</strong></em></li>
<li>一个主机可以在多个组中，但是在运行时，只能有一个实例存在，Ansible 会自动将属于多个组的主机合并。</li>
</ul>
</blockquote>
</li>
</ul>
</li>
<li><strong>主机范围匹配</strong>。如果有格式相似的主机，可以通过<strong>范围格式</strong>使用一条指令来添加多台主机。<ul>
<li>INI 配置格式中，使用以下格式  <figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">[webservers]</span><br><span class="line">www[01:50].example.com</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="comment"># 指定步长增长</span></span></span><br><span class="line">www[01:50:2].example.com</span><br><span class="line">      </span><br><span class="line">db-[a:f].example.com</span><br></pre></td></tr></table></figure></li>
<li>YAML 配置格式中，使用以下格式  <figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">...</span></span><br><span class="line">  webservers:</span><br><span class="line">    hosts:</span><br><span class="line">      www[01:50].example.com:</span><br><span class="line">      </span><br><span class="line">      ## 指定步长增长</span><br><span class="line">      www[01:50:2].example.com:</span><br><span class="line">      db-[a:f].example.com:</span><br></pre></td></tr></table></figure>
<blockquote>
<p><strong>范围格式</strong> 的第一项和最后一项也包括在内。即匹配 <code>www01</code> 和 <code>www50</code></p>
</blockquote>
</li>
</ul>
</li>
</ul>
<h2 id="Inventory-多配置文件支持"><a href="#Inventory-多配置文件支持" class="headerlink" title="Inventory 多配置文件支持"></a>Inventory 多配置文件支持</h2><p>在主机数量较多，或者组织结构较复杂的情况下，使用单个 Inventory 配置文件会导致主机管理较为复杂。将单个 Inventory 配置文件按照项目或者组织或其他规则进行分割会显著降低维护复杂度。</p>
<p>Inventory 多配置文件支持，可以使用以下方法之一</p>
<ul>
<li>按照项目或者组织或其他规则将主机分割到多个配置中，命令行中可以使用 <code>-i &lt;path1&gt; -i &lt;path2&gt; ...</code> 指定多个 <code>inventory</code></li>
<li>按照项目或者组织或其他规则将主机分割放置在多个文件中，并将所有文件统一放置在一个单独的目录中（如 <code>/etc/ansible/inventory/</code>），在命令行中使用选项 <code>-i /etc/ansible/inventory/</code> 或者在 Ansible 配置文件(<code>ansible.cfg</code>)中使用指令 <code>inventory</code> 配置目录。<blockquote>
<p><em><strong>注意事项</strong></em>： Ansible 使用字典顺序加载配置文件，如果在不同的配置文件中配置了 <code>parent groups</code> 和 <code>child groups</code>，那么定义 <code>child groups</code> 的配置要先用定义 <code>parent groups</code> 的文件加载，否则 Ansible 加载配置会报错： <code>Unable to parse /path/to/source_of_parent_groups as an inventory source</code> <sup id="fnref:4"><a href="#fn:4" rel="footnote"><span class="hint--top hint--error hint--medium hint--rounded hint--bounce" aria-label="[Managing inventory load order](https://docs.ansible.com/ansible/latest/inventory_guide/intro_inventory.html#managing-inventory-load-order)">[4]</span></a></sup> </p>
</blockquote>
</li>
<li>使用 <code>group_vars</code> 和 <code>host_vars</code> 目录分别存储组变量和主机变量 <sup id="fnref:7"><a href="#fn:7" rel="footnote"><span class="hint--top hint--error hint--medium hint--rounded hint--bounce" aria-label="[Organizing host and group variables](https://docs.ansible.com/ansible/latest/inventory_guide/intro_inventory.html#organizing-host-and-group-variables)">[7]</span></a></sup><blockquote>
<p><em><strong>注意事项</strong></em>： 组变量和主机变量必须使用 YAML 格式，合法的文件扩展名包括： <code>.yaml</code>、<code>yml</code>、<code>.json</code> 或者无文件扩展名</p>
</blockquote>
</li>
</ul>
<h2 id="INI-格式的-Inventory"><a href="#INI-格式的-Inventory" class="headerlink" title="INI 格式的 Inventory"></a>INI 格式的 Inventory</h2><p>主机列表中的主机可以单独出现，也可以位于某个或者多个 <strong>组(<code>[]</code> 开头的行)中</strong></p>
<figure class="highlight shell"><figcaption><span>/etc/ansible/hosts</span></figcaption><table><tr><td class="code"><pre><span class="line">ansible-demo1.local</span><br><span class="line">ansible-demo2.local</span><br><span class="line"></span><br><span class="line">[webserver]</span><br><span class="line">webserver1.local</span><br><span class="line">webserver2.local</span><br><span class="line"></span><br><span class="line">[nginxserver]</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">匹配多个主机：nginx1.local， nginx2.local， nginx3.local， nginx4.local</span></span><br><span class="line">nginx[1:4].local variable1=value1 variable2=value2</span><br><span class="line">nginx-bak.local ansible_ssh_host=10.10.0.1 ansible_ssh_port=22 ansible_ssh_user=root ansible_ssh_pass=PASSWORD</span><br><span class="line">127.0.0.1 http_port=80 maxRequestPerChild=808</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>


<p>连接主机使用的常用配置说明 <sup id="fnref:6"><a href="#fn:6" rel="footnote"><span class="hint--top hint--error hint--medium hint--rounded hint--bounce" aria-label="[Connecting to hosts: behavioral inventory parameters](https://docs.ansible.com/ansible/latest/inventory_guide/intro_inventory.html#connecting-to-hosts-behavioral-inventory-parameters)">[6]</span></a></sup></p>
<table>
<thead>
<tr>
<th>配置项</th>
<th>说明</th>
<th>示例</th>
</tr>
</thead>
<tbody><tr>
<td><code>ansible_host</code></td>
<td>远程主机地址</td>
<td></td>
</tr>
<tr>
<td><code>ansible_port</code></td>
<td>远程主机端口</td>
<td></td>
</tr>
<tr>
<td><code>ansible_user</code></td>
<td>连接远程主机的 ssh 用户<br/>Ansible 默认使用 control node 上执行 <code>ansible</code> 的用户名来连接远程主机 <sup id="fnref:9"><a href="#fn:9" rel="footnote"><span class="hint--top hint--error hint--medium hint--rounded hint--bounce" aria-label="[Setting a remote user](https://docs.ansible.com/ansible/latest/inventory_guide/connection_details.html#setting-a-remote-user)">[9]</span></a></sup></td>
<td></td>
</tr>
<tr>
<td><code>ansible_password</code></td>
<td>连接远程主机的 ssh 用户密码，建议使用 key 连接</td>
<td></td>
</tr>
<tr>
<td><code>ansible_ssh_private_key_file</code></td>
<td>连接远程主机的 ssh 私钥文件路径</td>
<td></td>
</tr>
<tr>
<td><code>ansible_become</code> <br/> <code>ansible_sudo</code>   <br/> <code>ansible_su</code></td>
<td>用户权限提升</td>
<td></td>
</tr>
<tr>
<td><code>ansible_become_method</code></td>
<td>用户权限提升(escalation)的方式</td>
<td></td>
</tr>
<tr>
<td><code>ansible_become_user</code> <br/> <code>ansible_sudo_user</code>     <br/> <code>ansible_su_user</code></td>
<td>用户权限提升(escalation)后的用户</td>
<td></td>
</tr>
<tr>
<td><code>ansible_become_password</code> <br/> <code>ansible_sudo_password</code> <br/> <code>ansible_su_password</code></td>
<td><code>sudo</code> 密码(这种方式并不安全,强烈建议使用 <code>--ask-sudo-pass</code>)</td>
<td></td>
</tr>
<tr>
<td><code>ansible_become_exe</code><br/> <code>ansible_sudo_exe</code> <br/> <code>ansible_su_exe</code> <br/></td>
<td>设置用户权限提升(escalation)后的可执行文件</td>
<td></td>
</tr>
<tr>
<td><code>ansible_connection</code></td>
<td>与主机的连接类型.比如:<code>local</code>, <code>ssh</code> 或者 <code>paramiko</code><br/>Ansible 1.2 以前默认使用 <code>paramiko</code>。1.2 以后默认使用 <code>smart</code>,<code>smart</code> 方式会根据是否支持 <code>ControlPersist</code>, 来判断 <code>ssh</code> 方式是否可行.</td>
<td></td>
</tr>
<tr>
<td><code>ansible_shell_type</code></td>
<td>目标系统的 shell 类型.默认情况下,命令的执行使用 <code>sh</code> 语法,可设置为 <code>csh</code> 或 <code>fish</code>.</td>
<td></td>
</tr>
<tr>
<td><code>ansible_python_interpreter</code></td>
<td>目标主机的 python 路径<br/>系统中有多个 Python, 或者命令路径不是 <code>/usr/bin/python</code></td>
<td></td>
</tr>
</tbody></table>
          <!--noindex-->
            <div class="post-button">
              <a class="btn" href="202308311109/#more" rel="contents">
                阅读全文 &raquo;
              </a>
            </div>
          <!--/noindex-->
        
      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://csms.tech/202212011355/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="images/avatar.gif">
      <meta itemprop="name" content="COSMOS">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="L B T">
      <meta itemprop="description" content="得 能 莫 忘">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | L B T">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="202212011355/" class="post-title-link" itemprop="url">containerd 使用方法</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2022-12-01 13:55:17" itemprop="dateCreated datePublished" datetime="2022-12-01T13:55:17+08:00">2022-12-01</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2025-03-03 10:03:00" itemprop="dateModified" datetime="2025-03-03T10:03:00+08:00">2025-03-03</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">上层目录</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="categories/Docker/" itemprop="url" rel="index"><span itemprop="name">Docker</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css"><h1 id="环境信息"><a href="#环境信息" class="headerlink" title="环境信息"></a>环境信息</h1><ul>
<li>Centos 7</li>
<li>containerd.io-1.4.13-3</li>
</ul>
<h1 id="containerd-相关配置"><a href="#containerd-相关配置" class="headerlink" title="containerd 相关配置"></a>containerd 相关配置</h1><h2 id="默认配置文件"><a href="#默认配置文件" class="headerlink" title="默认配置文件"></a>默认配置文件</h2><p><code>containerd</code> 服务默认配置文件为 <code>/etc/containerd/config.toml</code></p>
<figure class="highlight shell"><figcaption><span>/etc/containerd/config.toml</span></figcaption><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">root = <span class="string">&quot;/var/lib/containerd&quot;</span></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">state = <span class="string">&quot;/run/containerd&quot;</span></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">subreaper = <span class="literal">true</span></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">oom_score = 0</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>Containerd 有两个不同的存储路径，一个用来保存持久化数据，一个用来保存运行时状态。 <sup id="fnref:1"><a href="#fn:1" rel="footnote"><span class="hint--top hint--error hint--medium hint--rounded hint--bounce" aria-label="[Containerd 的前世今生和保姆级入门教程](https://blog.51cto.com/u_15127639/3256557)">[1]</span></a></sup></p>
<figure class="highlight shell"><figcaption><span>/etc/containerd/config.toml</span></figcaption><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">root = <span class="string">&quot;/var/lib/containerd&quot;</span></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">state = <span class="string">&quot;/run/containerd&quot;</span></span></span><br></pre></td></tr></table></figure>
<ul>
<li><code>root</code> - 用来保存持久化数据，包括 Snapshots, Content, Metadata 以及各种插件的数据。每一个插件都有自己单独的目录，Containerd 本身不存储任何数据，它的所有功能都来自于已加载的插件。</li>
<li><code>state</code> - 用来保存临时数据，包括 <code>sockets</code>、<code>pid</code>、<code>挂载点</code>、<code>运行时状态</code> 以及不需要持久化保存的插件数据。</li>
</ul>
<figure class="highlight shell"><figcaption><span>/etc/containerd/config.toml</span></figcaption><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">oom_score = 0</span></span><br></pre></td></tr></table></figure>
<p>Containerd 是容器的守护者，一旦发生内存不足的情况，理想的情况应该是先杀死容器，而不是杀死 Containerd。所以需要调整 Containerd 的 OOM 权重，减少其被 OOM Kill 的几率。<code>oom_score</code> 其取值范围为 <code>-1000</code> 到 <code>1000</code>，如果将该值设置为 <code>-1000</code>，则进程永远不会被杀死，建议 Containerd 将该值设置为 <code>-999</code> 到 <code>0</code> 之间。如果作为 Kubernetes 的 Worker 节点，可以考虑设置为 <code>-999</code>。</p>
<h2 id="containerd-服务配置文件"><a href="#containerd-服务配置文件" class="headerlink" title="containerd 服务配置文件"></a>containerd 服务配置文件</h2><p>默认的 <code>containerd</code> 服务的配置为 <code>/usr/lib/systemd/system/containerd.service</code></p>
<figure class="highlight shell"><figcaption><span>/usr/lib/systemd/system/containerd.service</span></figcaption><table><tr><td class="code"><pre><span class="line">[Unit]</span><br><span class="line">Description=containerd container runtime</span><br><span class="line">Documentation=https://containerd.io</span><br><span class="line">After=network.target local-fs.target</span><br><span class="line"></span><br><span class="line">[Service]</span><br><span class="line">ExecStartPre=-/sbin/modprobe overlay</span><br><span class="line">ExecStart=/usr/bin/containerd</span><br><span class="line"></span><br><span class="line">Type=notify</span><br><span class="line">Delegate=yes</span><br><span class="line">KillMode=process</span><br><span class="line">Restart=always</span><br><span class="line">RestartSec=5</span><br><span class="line"></span><br><span class="line">LimitNPROC=infinity</span><br><span class="line">LimitCORE=infinity</span><br><span class="line">LimitNOFILE=1048576</span><br><span class="line"></span><br><span class="line">TasksMax=infinity</span><br><span class="line">OOMScoreAdjust=-999</span><br><span class="line"></span><br><span class="line">[Install]</span><br><span class="line">WantedBy=multi-user.target</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<ul>
<li><p><strong><code>Delegate</code></strong> - 这个选项允许 Containerd 以及运行时自己管理自己创建的容器的 cgroups。如果不设置这个选项，<code>systemd</code> 就会将进程移到自己的 cgroups 中，从而导致 Containerd 无法正确获取容器的资源使用情况。</p>
</li>
<li><p><strong><code>KillMode</code></strong> - 这个选项用来处理 Containerd 进程被杀死的方式。默认情况下，<code>systemd</code> 会在进程的 cgroup 中查找并杀死 Containerd 的所有子进程，这肯定不是我们想要的。<code>KillMode</code> 字段可以设置的值如下:</p>
<ul>
<li><strong><code>control-group</code></strong> -（默认值）当前控制组里面的所有子进程，都会被杀掉</li>
<li><strong><code>process</code></strong> - 只杀主进程。</li>
<li><strong><code>mixed</code></strong> - 主进程将收到 <code>SIGTERM</code> 信号，子进程收到 <code>SIGKILL</code> 信号</li>
<li><strong><code>none</code></strong> - 没有进程会被杀掉，只是执行服务的 stop 命令。</li>
</ul>
<p>  需要将 <code>KillMode</code> 的值设置为<code> process</code>，这样可以确保升级或重启 Containerd 时不杀死现有的容器。</p>
</li>
</ul>
<h2 id="Containerd-常用配置"><a href="#Containerd-常用配置" class="headerlink" title="Containerd 常用配置"></a>Containerd 常用配置</h2><p>Containerd 默认配置文件为 <code>/etc/containerd/config.toml</code>，未在配置文件中配置的则使用默认配置，为了方便修改，可以使用以下命令将默认配置写入配置文件中</p>
<figure class="highlight shell"><figcaption><span>/etc/containerd/config.toml</span></figcaption><table><tr><td class="code"><pre><span class="line">containerd config default | sudo tee /etc/containerd/config.toml</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>在作为 Kubernetes 的 CRI 时，需要修改以下配置：</p>
<ul>
<li><strong>启用 CRI 功能</strong> 。Containerd 默认禁用了 CRI 功能（<code>disabled_plugins = [&#39;cri&#39;]</code>），要启用 <code>cri</code> ，将其注释或删除</li>
<li><strong>配置 <code>cgroup v2</code>，</strong> Kubernetes 的很多功能需要 <code>cgroup v2</code> 支持，Kubernetes 节点通常使用 <code>cgroup v2</code>，要配置 <code>containerd</code> 使用 <code>cgroup v2</code>，修改配置文件的 <code>plugins.&quot;io.containerd.grpc.v1.cri&quot;.containerd.runtimes.runc.options</code> 部分，将 <code>SystemdCgroup</code> 配置为 <code>true</code> 后重启 <code>containerd</code> 服务<figure class="highlight shell"><figcaption><span>/etc/containerd/config.toml</span></figcaption><table><tr><td class="code"><pre><span class="line">[plugins.&quot;io.containerd.grpc.v1.cri&quot;.containerd.runtimes.runc.options]</span><br><span class="line">  BinaryName = &quot;&quot;</span><br><span class="line">  CriuImagePath = &quot;&quot;</span><br><span class="line">  CriuPath = &quot;&quot;</span><br><span class="line">  CriuWorkPath = &quot;&quot;</span><br><span class="line">  IoGid = 0</span><br><span class="line">  IoUid = 0</span><br><span class="line">  NoNewKeyring = false</span><br><span class="line">  NoPivotRoot = false</span><br><span class="line">  Root = &quot;&quot;</span><br><span class="line">  ShimCgroup = &quot;&quot;</span><br><span class="line">  SystemdCgroup = true</span><br><span class="line">  </span><br></pre></td></tr></table></figure></li>
</ul>
<h1 id="客户端工具-ctr-使用"><a href="#客户端工具-ctr-使用" class="headerlink" title="客户端工具 ctr 使用"></a>客户端工具 ctr 使用</h1><h2 id="ctr-管理镜像"><a href="#ctr-管理镜像" class="headerlink" title="ctr 管理镜像"></a>ctr 管理镜像</h2><h3 id="镜像下载"><a href="#镜像下载" class="headerlink" title="镜像下载"></a>镜像下载</h3><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">ctr image pull docker.io/library/nginx:alpine</span><br></pre></td></tr></table></figure>

<h3 id="列出本地镜像"><a href="#列出本地镜像" class="headerlink" title="列出本地镜像"></a>列出本地镜像</h3><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">ctr image <span class="built_in">ls</span></span></span><br><span class="line">REF                            TYPE                                                      DIGEST                                                                  SIZE    PLATFORMS                                                                                LABELS </span><br><span class="line">docker.io/library/nginx:alpine application/vnd.docker.distribution.manifest.list.v2+json sha256:455c39afebd4d98ef26dd70284aa86e6810b0485af5f4f222b19b89758cabf1e 9.8 MiB linux/386,linux/amd64,linux/arm/v6,linux/arm/v7,linux/arm64/v8,linux/ppc64le,linux/s390x -</span><br></pre></td></tr></table></figure>
<h3 id="将镜像挂载到本地目录"><a href="#将镜像挂载到本地目录" class="headerlink" title="将镜像挂载到本地目录"></a>将镜像挂载到本地目录</h3><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">ctr image mount docker.io/library/nginx:alpine /mnt</span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="built_in">ls</span> /mnt</span></span><br><span class="line">bin  docker-entrypoint.d   etc   lib    mnt  proc  run   srv  tmp  var</span><br><span class="line">dev  docker-entrypoint.sh  home  media  opt  root  sbin  sys  usr</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>卸载已挂载的镜像</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">ctr image unmount /mnt</span><br></pre></td></tr></table></figure>

<h2 id="ctr-管理-容器"><a href="#ctr-管理-容器" class="headerlink" title="ctr 管理 容器"></a>ctr 管理 容器</h2><h3 id="创建容器"><a href="#创建容器" class="headerlink" title="创建容器"></a>创建容器</h3><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">ctr container create docker.io/library/nginx:alpine nginx</span><br></pre></td></tr></table></figure>
<p>容器创建后，并没有开始运行，只是分配了容器运行所需的资源及配置的数据结构，这意味着 <code>namespaces</code>、<code>rootfs</code> 和容器的配置都已经初始化成功了，只是用户进程(这里是 <code>nginx</code>)还没有启动，容器（进程）状态的变化由 <code>Task</code> 对象实现，通过命令 <code>ctr task</code> 来管理。</p>
<p>启动 <code>ctr container create</code> 创建的容器</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">ctr task start nginx</span><br></pre></td></tr></table></figure>
<p>以上命令启动之前创建的容器 <code>nginx</code>，未指定其他参数时，容器中的进程在系统前台运行，如需后台运行，可以使用选项 <code>-d</code></p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">ctr task start nginx -d</span><br></pre></td></tr></table></figure>

<p>也可以直接使用 <code>run</code> 命令，创建并启动容器</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">ctr run --rm -d docker.io/library/nginx:alpine nginx1</span><br></pre></td></tr></table></figure>

<h3 id="列出容器"><a href="#列出容器" class="headerlink" title="列出容器"></a>列出容器</h3><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">ctr container ls</span><br></pre></td></tr></table></figure>

<p>查看容器中进程的状态</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">ctr task <span class="built_in">ls</span></span></span><br><span class="line">TASK      PID     STATUS    </span><br><span class="line">nginx1    5495    RUNNING</span><br></pre></td></tr></table></figure>
<p>查看容器中运行的所有的进程</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">ctr task ps nginx1</span></span><br><span class="line">PID     INFO</span><br><span class="line">5495    -</span><br><span class="line">5531    -</span><br><span class="line">5532    -</span><br><span class="line">5533    -</span><br><span class="line">5534    -</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p><strong>这里的 PID 是宿主机看到的 PID，不是容器中看到的 PID。</strong></p>
<h3 id="查看容器详细信息"><a href="#查看容器详细信息" class="headerlink" title="查看容器详细信息"></a>查看容器详细信息</h3><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">ctr container info nginx</span><br></pre></td></tr></table></figure>

<h3 id="删除容器"><a href="#删除容器" class="headerlink" title="删除容器"></a>删除容器</h3><p>停止&#x2F;删除容器中的进程</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">ctr task delete nginx -f</span><br><span class="line"></span><br><span class="line">ctr task pause nginx</span><br></pre></td></tr></table></figure>
<p>以上命令<strong>删除&#x2F;停止容器中的进程，但是并不删除容器</strong>，执行以上命令后再执行以下命令，可删除容器</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">ctr container delete nginx</span><br></pre></td></tr></table></figure>
<p><strong>ctr 没有 stop 容器的功能，只能暂停或者杀死容器。</strong></p>
<h3 id="进入容器"><a href="#进入容器" class="headerlink" title="进入容器"></a>进入容器</h3><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">ctr task exec -t --exec-id 1 nginx1 sh</span><br></pre></td></tr></table></figure>
<p>执行 <code>ctr task exec</code> 进入容器，必须制定 <code>--exec-id</code>，值可以随便指定。</p>
<h3 id="namespace-管理"><a href="#namespace-管理" class="headerlink" title="namespace 管理"></a>namespace 管理</h3><p>Containerd 相比于 Docker ，多了 Namespace 的概念，使用以下命令，查看所有的 Namespace</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">ctr ns <span class="built_in">ls</span></span></span><br><span class="line">NAME    LABELS </span><br><span class="line">default        </span><br><span class="line">moby     </span><br></pre></td></tr></table></figure>
<p><code>docker</code> 默认使用 <code>moby</code> 的 Namespace，要使用 <code>ctr</code> 命令查看 <code>docker</code> 创建的容器，需要使用选项 <code>-n moby</code> 指定命名空间，否则 <code>ctr</code> 默认使用 <code>default</code> 命名空间，无法看到 <code>moby</code> 命名空间中的资源</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">ctr -n moby container ls</span><br><span class="line">CONTAINER                                                           IMAGE    RUNTIME                           </span><br><span class="line">17b16c3699cdb88a1ff80d8a7c84724eff393c42186775b58418c90bd178600f    -        io.containerd.runtime.v1.linux    </span><br><span class="line">27fc19226baa91251d63a375a7b1309122334cfb5ceb39aeb67ab1701b708464    -        io.containerd.runtime.v1.linux</span><br></pre></td></tr></table></figure>

<p><em><strong>Kubernetes 默认使用 <code>k8s.io</code> 命名空间</strong></em>。</p>
<p><code>ctr</code> 没有配置或者环境变量可以来配置默认的 Namespace，在 Kubernetes 场景中，可以使用 <code>alias</code> 命令配置 <code>ctr</code>，使其自动指向 <code>k8s.io</code> 的 Namespace</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">alias ctr=&#x27;ctr -n k8s.io&#x27;</span><br></pre></td></tr></table></figure>

<h1 id="nerdctl"><a href="#nerdctl" class="headerlink" title="nerdctl"></a>nerdctl</h1><p><code>nerdctl</code> 是为 Containerd 开发的完全兼容 Docker 命令行的工具，它可以使用和 <code>docker</code> 命令一样的语法来操作 <code>containerd</code> 中的容器。</p>
<p><a target="_blank" rel="noopener" href="https://github.com/containerd/nerdctl?tab=readme-ov-file"><code>nerdctl</code> 官方说明文档</a></p>
<p>如果要使用 <code>nerdctl</code> 调试 Kubernetes 环境中的容器，需要指定 Namespace，示例如下：</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">nerdctl --namespace k8s.io ps -a</span></span><br></pre></td></tr></table></figure>

<p>如果是在 Kubernetes 环境中使用，为方便起见，可以添加环境变量：</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="built_in">alias</span> nerdctl=<span class="string">&#x27;nerdctl --namespace k8s.io&#x27;</span></span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">nerdctl ps</span></span><br><span class="line">CONTAINER ID    IMAGE                                              COMMAND                   CREATED       STATUS    PORTS    NAMES</span><br><span class="line">4de4c59a8913    registry.k8s.io/kube-controller-manager:v1.32.0    &quot;kube-controller-man…&quot;    2 days ago    Up                 k8s://kube-system/kube-controller-manager-k8s-master/kube-controller-manager</span><br><span class="line">6a9f17dffdb5    registry.k8s.io/pause:3.6                          &quot;/pause&quot;                  2 days ago    Up                 k8s://kube-system/kube-controller-manager-k8s-master</span><br><span class="line">3ae8ed830b63    registry.k8s.io/kube-scheduler:v1.32.0             &quot;kube-scheduler --au…&quot;    2 days ago    Up                 k8s://kube-system/kube-scheduler-k8s-master/kube-scheduler</span><br><span class="line">0cb15e8f5ac7    registry.k8s.io/pause:3.6                          &quot;/pause&quot;                  2 days ago    Up                 k8s://kube-system/kube-scheduler-k8s-master</span><br><span class="line">60ea2cfc01c8    registry.k8s.io/pause:3.6                          &quot;/pause&quot;                  2 days ago    Up                 k8s://kube-system/kube-apiserver-k8s-master</span><br><span class="line">eaf781314f4a    registry.k8s.io/pause:3.6                          &quot;/pause&quot;                  2 days ago    Up                 k8s://kube-system/etcd-k8s-master</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h1 id="脚注"><a href="#脚注" class="headerlink" title="脚注"></a>脚注</h1><div id="footnotes"><hr><div id="footnotelist"><ol style="list-style: none; padding-left: 0; margin-left: 40px"><li id="fn:1"><span style="display: inline-block; vertical-align: top; padding-right: 10px; margin-left: -40px">1.</span><span style="display: inline-block; vertical-align: top; margin-left: 10px;"><a target="_blank" rel="noopener" href="https://blog.51cto.com/u_15127639/3256557">Containerd 的前世今生和保姆级入门教程</a><a href="#fnref:1" rev="footnote"> ↩</a></span></li></ol></div></div>
      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://csms.tech/20240904170014/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="images/avatar.gif">
      <meta itemprop="name" content="COSMOS">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="L B T">
      <meta itemprop="description" content="得 能 莫 忘">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | L B T">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="20240904170014/" class="post-title-link" itemprop="url">Linux nftables 防火墙</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2024-09-04 17:09:00" itemprop="dateCreated datePublished" datetime="2024-09-04T17:09:00+08:00">2024-09-04</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2025-02-28 17:02:00" itemprop="dateModified" datetime="2025-02-28T17:02:00+08:00">2025-02-28</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">上层目录</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="categories/Linux/" itemprop="url" rel="index"><span itemprop="name">Linux</span></a>
        </span>
          ，
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="categories/Linux/%E5%B8%B8%E7%94%A8%E6%9C%8D%E5%8A%A1/" itemprop="url" rel="index"><span itemprop="name">常用服务</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p><code>nftables</code> 是一个 <code>netfilter</code> 项目，旨在替换现有的 <code>&#123;ip,ip6,arp,eb&#125;tables</code> 框架，为 <code>&#123;ip,ip6&#125;tables</code> 提供一个新的包过滤框架、一个新的用户空间实用程序（<code>nft</code>）和一个兼容层(<code>iptables-nft</code>)。它使用现有的钩子、链接跟踪系统、用户空间排队组件和 <code>netfilter</code> 日志子系统。</p>
<blockquote>
<p><em>在 Linux 内核版本高于 3.13 时可用</em></p>
</blockquote>
<p>它由三个主要组件组成：</p>
<ul>
<li>内核实现: 内核提供了一个 <code>netlink</code> 配置接口以及运行时规则集评估</li>
<li><code>libnl netlink</code> : <code>libnl</code> 包含了与内核通信的基本函数</li>
<li><code>nftables</code> : 用户空间前端。<code>nftables</code> 的用户空间实用程序 <code>nft</code> 评估大多数规则集并传递到内核。规则存储在链中，链存储在表中。</li>
</ul>
<p><strong>与 <code>iptables</code> 不同点</strong></p>
<ul>
<li><code>nftables</code> 在用户空间中运行，<code>iptables</code> 中的每个模块都运行在内核（空间）中</li>
<li><strong>表和链是完全可配置的</strong>。在 <code>nftables</code> 中，表是没有特定语义的链的容器。<code>iptables</code> 附带了具有预定义数量的基链的表，即使您只需要其中之一，所有链都已注册，未使用的基础链也会损害性能。</li>
<li><strong>可以在一个规则中指定多个操作</strong>。在 <code>iptables</code> 中，您只能指定一个目标。这是一个长期存在的局限性，用户可以通过跳到自定义链来解决，但代价是使规则集结构稍微复杂一些。</li>
<li><strong>每个链和规则没有内置计数器</strong>。在 <code>nftables</code> 中，这些是可选的，因此您可以按需启用计数器。由于 <code>iptables</code> 内置了一个数据包计数器，所以即使这些内置的链是空的，也会带来性能损耗</li>
<li><strong>更好地支持动态规则集更新</strong>。在 <code>nftables</code> 中，如果添加新规则，则剩余的现有规则将保持不变，因为规则集以链表形式表示，这与整体式 blob 表示相反，后者在执行规则集更新时内部状态信息的维护很复杂。</li>
<li><strong>简化的双堆栈 IPv4&#x2F;IPv6 管理</strong>，通过新的 <code>inet</code> 系列，可让您注册同时查看 IPv4 和 IPv6 流量的基链。 因此，您不再需要依赖脚本来复制规则集。</li>
</ul>
<p><strong>服务名称默认为 <code>nftables</code>，默认配置文件为 <code>/etc/nftables.conf</code></strong> ，其中已经包含一个名为 <code>inet filter</code> 的简单 <code>ipv4/ipv6</code> 防火墙列表。</p>
<figure class="highlight shell"><figcaption><span>/etc/nftables.conf</span></figcaption><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">!/usr/sbin/nft -f</span></span><br><span class="line"></span><br><span class="line">flush ruleset</span><br><span class="line"></span><br><span class="line">table inet filter &#123;</span><br><span class="line">	chain input &#123;</span><br><span class="line">		type filter hook input priority 0;</span><br><span class="line">	&#125;</span><br><span class="line">	chain forward &#123;</span><br><span class="line">		type filter hook forward priority 0;</span><br><span class="line">	&#125;</span><br><span class="line">	chain output &#123;</span><br><span class="line">		type filter hook output priority 0;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><code>nftables</code> 服务的 <code>systemd</code> 配置文件如下：</p>
<figure class="highlight shell"><figcaption><span>/lib/systemd/system/nftables.service</span></figcaption><table><tr><td class="code"><pre><span class="line">[Unit]</span><br><span class="line">Description=nftables</span><br><span class="line">Documentation=man:nft(8) http://wiki.nftables.org</span><br><span class="line">Wants=network-pre.target</span><br><span class="line">Before=network-pre.target shutdown.target</span><br><span class="line">Conflicts=shutdown.target</span><br><span class="line">DefaultDependencies=no</span><br><span class="line"></span><br><span class="line">[Service]</span><br><span class="line">Type=oneshot</span><br><span class="line">RemainAfterExit=yes</span><br><span class="line">StandardInput=null</span><br><span class="line">ProtectSystem=full</span><br><span class="line">ProtectHome=true</span><br><span class="line">ExecStart=/usr/sbin/nft -f /etc/nftables.conf</span><br><span class="line">ExecReload=/usr/sbin/nft -f /etc/nftables.conf</span><br><span class="line">ExecStop=/usr/sbin/nft flush ruleset</span><br><span class="line"></span><br><span class="line">[Install]</span><br><span class="line">WantedBy=sysinit.target</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><code>nftables</code> 使用的内核模块如下，加载这些模块，服务才能正常运行</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">lsmod | grep nf</span></span><br><span class="line">nf_log_syslog          20480  1</span><br><span class="line">nft_chain_nat          16384  17</span><br><span class="line">nf_nat                 49152  3 xt_nat,nft_chain_nat,xt_MASQUERADE</span><br><span class="line">nf_conntrack_netlink    49152  0</span><br><span class="line">nft_counter            16384  142</span><br><span class="line">nf_reject_ipv4         16384  1 ipt_REJECT</span><br><span class="line">nf_conntrack          172032  6 xt_conntrack,nf_nat,xt_state,xt_nat,nf_conntrack_netlink,xt_MASQUERADE</span><br><span class="line">nf_defrag_ipv6         24576  1 nf_conntrack</span><br><span class="line">nf_defrag_ipv4         16384  1 nf_conntrack</span><br><span class="line">nft_compat             20480  143</span><br><span class="line">nf_tables             249856  570 nft_compat,nft_counter,nft_chain_nat</span><br><span class="line">nfnetlink              20480  5 nft_compat,nf_conntrack_netlink,nf_tables,ip_set</span><br></pre></td></tr></table></figure>
          <!--noindex-->
            <div class="post-button">
              <a class="btn" href="20240904170014/#more" rel="contents">
                阅读全文 &raquo;
              </a>
            </div>
          <!--/noindex-->
        
      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://csms.tech/202209281614/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="images/avatar.gif">
      <meta itemprop="name" content="COSMOS">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="L B T">
      <meta itemprop="description" content="得 能 莫 忘">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | L B T">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="202209281614/" class="post-title-link" itemprop="url">kubernetes 常见错误总结</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2022-09-28 16:14:41" itemprop="dateCreated datePublished" datetime="2022-09-28T16:14:41+08:00">2022-09-28</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2025-02-28 13:02:00" itemprop="dateModified" datetime="2025-02-28T13:02:00+08:00">2025-02-28</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">上层目录</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="categories/Kubernetes/" itemprop="url" rel="index"><span itemprop="name">Kubernetes</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="环境信息"><a href="#环境信息" class="headerlink" title="环境信息"></a>环境信息</h1><ul>
<li>Centos7 5.4.212-1</li>
<li>Docker 20.10.18</li>
<li>containerd.io-1.6.8</li>
<li>kubectl-1.25.0</li>
<li>kubeadm-1.25.0</li>
<li>kubelet-1.25.0</li>
</ul>
<h1 id="POD-状态异常"><a href="#POD-状态异常" class="headerlink" title="POD 状态异常"></a>POD 状态异常</h1><h2 id="CrashLoopBackOff"><a href="#CrashLoopBackOff" class="headerlink" title="CrashLoopBackOff"></a>CrashLoopBackOff</h2><p><strong>错误场景</strong> ： </p>
<p><code>Pod</code> 状态显示 <code>CrashLoopBackOff</code></p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">kubectl get pods</span></span><br><span class="line">NAME                                     READY   STATUS             RESTARTS       AGE</span><br><span class="line">test-centos7-7cc5dc6987-jz486            0/1     CrashLoopBackOff   8 (111s ago)   17m</span><br></pre></td></tr></table></figure>
<p>查看 <code>Pod</code> 详细信息</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">kubectl describe pod test-centos7-7cc5dc6987-jz486</span></span><br><span class="line">...</span><br><span class="line">Events:</span><br><span class="line">  Type     Reason     Age                  From               Message</span><br><span class="line">  ----     ------     ----                 ----               -------</span><br><span class="line">  Normal   Scheduled  18m                  default-scheduler  Successfully assigned default/test-centos7-7cc5dc6987-jz486 to ops-kubernetes3</span><br><span class="line">  Normal   Pulled     16m (x5 over 18m)    kubelet            Container image &quot;centos:centos7.9.2009&quot; already present on machine</span><br><span class="line">  Normal   Created    16m (x5 over 18m)    kubelet            Created container centos7</span><br><span class="line">  Normal   Started    16m (x5 over 18m)    kubelet            Started container centos7</span><br><span class="line">  Warning  BackOff    3m3s (x71 over 18m)  kubelet            Back-off restarting failed container</span><br></pre></td></tr></table></figure>
<p>结果显示，<code>Reason</code> 为 <code>BackOff</code>，<code>Message</code> 显示 <code>Back-off restarting failed container</code></p>
<p><strong>可能原因</strong> ：</p>
<p><code>Back-off restarting failed container</code> 的原因，通常是因为，容器内 PID 为 1 的进程退出导致（通常用户在构建镜像执行 <code>CMD</code> 时，启动的程序，均是 PID 为1）<sup id="fnref:1"><a href="#fn:1" rel="footnote"><span class="hint--top hint--error hint--medium hint--rounded hint--bounce" aria-label="[Back-off restarting failed container 怎么办](https://cloud.tencent.com/developer/article/1931089)">[1]</span></a></sup></p>
<p>容器进程退出（命令执行结束或者进程异常结束），则容器生命周期结束。kubernetes 控制器检查到容器退出，会持续重启容器。针对此种情况，需要检查镜像，是否不存在常驻进程，或者常驻进程异常。</p>
<p>针对此种情况，可以单独使用 <code>docker</code> 客户端部署镜像，查看镜像的运行情况，如果部署后，容器中的进程立马结束或退出，则容器也会随之结束。</p>
<p>定位中也可以使用 <code>kubectl describe pod</code> 命令检查 Pod 的退出状态码。Kubernetes 中的 Pod ExitCode 状态码是容器退出时返回的退出状态码，这个状态码通常用来指示容器的执行结果，以便 Kubernetes 和相关工具可以根据它来采取后续的操作。以下是一些常见的 ExitCode 状态码说明：</p>
<ul>
<li><code>ExitCode 0</code> : 这表示容器正常退出，没有错误。这通常是期望的结果。</li>
<li><code>ExitCode 1</code> ： 通常表示容器以非正常方式退出，可能是由于应用程序内部错误或异常导致的。通常是容器中 pid 为 1 的进程错误而失败</li>
<li><code>ExitCode 非零</code> ： 任何非零的状态码都表示容器退出时发生了错误。ExitCode 的具体值通常是自定义的，容器内的应用程序可以根据需要返回不同的状态码来表示不同的错误情况。你需要查看容器内应用程序的文档或日志来了解具体的含义。</li>
<li><code>ExitCode 137</code> ： 通常表示容器因为被操作系统终止（例如，<code>OOM-killer</code>）而非正常退出。这可能是由于内存不足等资源问题导致的。</li>
<li><code>ExitCode 139</code> ： 通常表示容器因为接收到了一个信号而非正常退出。这个信号通常是 <code>SIGSEGV</code>（段错误），表示应用程序试图访问无效的内存。</li>
<li><code>ExitCode 143</code> ： 通常表示容器因为接收到了 <code>SIGTERM</code> 信号而正常退出。这是 Kubernetes 在删除 Pod 时发送的信号，容器应该在接收到该信号后做一些清理工作然后退出。</li>
<li><code>ExitCode 130</code> ： 通常表示容器因为接收到了 <code>SIGINT</code> 信号而正常退出。这是当用户在命令行中按下 <code>Ctrl+C</code> 时发送的信号。</li>
<li><code>ExitCode 255</code> ：通常表示未知错误，或者容器无法启动。这个状态码通常是容器运行时的问题，比如容器镜像不存在或者启动命令有问题。</li>
</ul>
          <!--noindex-->
            <div class="post-button">
              <a class="btn" href="202209281614/#more" rel="contents">
                阅读全文 &raquo;
              </a>
            </div>
          <!--/noindex-->
        
      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://csms.tech/20250228101014/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="images/avatar.gif">
      <meta itemprop="name" content="COSMOS">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="L B T">
      <meta itemprop="description" content="得 能 莫 忘">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | L B T">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="20250228101014/" class="post-title-link" itemprop="url">Github 相关操作</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2025-02-28 10:02:00" itemprop="dateCreated datePublished" datetime="2025-02-28T10:02:00+08:00">2025-02-28</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">上层目录</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="categories/Tools/" itemprop="url" rel="index"><span itemprop="name">Tools</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css"><h1 id="PAT-认证"><a href="#PAT-认证" class="headerlink" title="PAT 认证"></a>PAT 认证</h1><p>Github 为了安全考虑，在 Shell 中禁止使用帐号名称登陆，提供了更为安全的 PAT（Personal Access Token），PAT 的权限和创建它的用户权限相同，并且可以使用 <code>Fine-grained personal access tokens</code> 实现更细粒度的权限控制</p>
<p>参考以下步骤创建 PAT：</p>
<ol>
<li><p>登录 GitHub。</p>
</li>
<li><p>点击右上角头像，进入 <code>Settings</code> 。</p>
</li>
<li><p>在左侧菜单中选择 <code>Developer settings</code> 。</p>
</li>
<li><p>选择 <code>Personal access tokens</code> ，然后点击 <code>Generate new token</code> 。</p>
</li>
<li><p>生成令牌并复制。</p>
</li>
</ol>
<h1 id="gh"><a href="#gh" class="headerlink" title="gh"></a>gh</h1><p>Github 命令行工具 <code>gh</code> 常用操作</p>
<h2 id="Login"><a href="#Login" class="headerlink" title="Login"></a>Login</h2><p>参考以下示例使用命令 <code>gh auth login</code> 登陆 Github</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">gh auth login</span></span><br><span class="line">? Where do you use GitHub? GitHub.com</span><br><span class="line">? What is your preferred protocol for Git operations on this host? HTTPS</span><br><span class="line">? Authenticate Git with your GitHub credentials? Yes</span><br><span class="line">? How would you like to authenticate GitHub CLI? Paste an authentication token</span><br><span class="line">Tip: you can generate a Personal Access Token here https://github.com/settings/tokens</span><br><span class="line">The minimum required scopes are &#x27;repo&#x27;, &#x27;read:org&#x27;, &#x27;workflow&#x27;.</span><br><span class="line">? Paste your authentication token: *********************************************************************************************</span><br><span class="line">- gh config set -h github.com git_protocol https</span><br><span class="line">✓ Configured git protocol</span><br><span class="line">! Authentication credentials saved in plain text</span><br><span class="line">✓ Logged in as user1</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><strong>查看 Github 认证状态（<code>gh auth status</code>）</strong></p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">gh auth status</span></span><br><span class="line">github.com</span><br><span class="line">  ✓ Logged in to github.com account user1 (/root/.config/gh/hosts.yml)</span><br><span class="line">  - Active account: true</span><br><span class="line">  - Git operations protocol: https</span><br><span class="line">  - Token: github_pat_11BP5YWMA0XuC4iSW26eBN_***********************************************************</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="pull"><a href="#pull" class="headerlink" title="pull"></a>pull</h2><p>参考以下示例使用命令 <code>gh repo clone user1/resp1</code> clone 代码到本地</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">gh repo <span class="built_in">clone</span> user1/resp1</span></span><br><span class="line">Cloning into &#x27;resp1&#x27;...</span><br><span class="line">remote: Enumerating objects: 27, done.</span><br><span class="line">remote: Counting objects: 100% (27/27), done.</span><br><span class="line">remote: Compressing objects: 100% (25/25), done.</span><br><span class="line">remote: Total 27 (delta 12), reused 0 (delta 0), pack-reused 0 (from 0)</span><br><span class="line">Receiving objects: 100% (27/27), 9.10 KiB | 9.10 MiB/s, done.</span><br><span class="line">Resolving deltas: 100% (12/12), done.</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>如果报错： <code>GraphQL: Resource not accessible by personal access token (repository.defaultBranchRef)</code> ，则说明 PAT 权限不足。</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://csms.tech/202208041317/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="images/avatar.gif">
      <meta itemprop="name" content="COSMOS">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="L B T">
      <meta itemprop="description" content="得 能 莫 忘">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | L B T">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="202208041317/" class="post-title-link" itemprop="url">docker 安装及常用命令介绍</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2022-08-04 13:13:13" itemprop="dateCreated datePublished" datetime="2022-08-04T13:13:13+08:00">2022-08-04</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2025-02-27 16:02:00" itemprop="dateModified" datetime="2025-02-27T16:02:00+08:00">2025-02-27</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">上层目录</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="categories/Docker/" itemprop="url" rel="index"><span itemprop="name">Docker</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="环境信息"><a href="#环境信息" class="headerlink" title="环境信息"></a>环境信息</h1><ul>
<li>Centos 7.9.2009</li>
<li>docker-ce-19.03.15</li>
<li>docker-20.10.9</li>
</ul>
<h1 id="Docker-安装"><a href="#Docker-安装" class="headerlink" title="Docker 安装"></a>Docker 安装</h1><h2 id="yum-安装-docker"><a href="#yum-安装-docker" class="headerlink" title="yum 安装 docker"></a>yum 安装 docker</h2><p>安装 yum 源，<a target="_blank" rel="noopener" href="https://docs.docker.com/engine/install/centos/">docker官方 centos 安装文档</a>  </p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">yum install -y yum-utils</span><br><span class="line">yum-config-manager --add-repo https://download.docker.com/linux/centos/docker-ce.repo</span><br></pre></td></tr></table></figure>

<p>安装 <code>docker</code></p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">yum install docker-ce docker-ce-cli containerd.io docker-compose-plugin</span><br></pre></td></tr></table></figure>

<h2 id="yum-离线安装-docker"><a href="#yum-离线安装-docker" class="headerlink" title="yum 离线安装 docker"></a>yum 离线安装 docker</h2><p><a href="#%E5%8F%82%E8%80%83%E9%93%BE%E6%8E%A5">参考链接</a>下载rpm安装包</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">wget https://download.docker.com/linux/centos/7/x86_64/stable/Packages/docker-ce-19.03.15-3.el7.x86_64.rpm</span><br><span class="line">wget https://download.docker.com/linux/centos/7/x86_64/stable/Packages/docker-ce-cli-19.03.15-3.el7.x86_64.rpm</span><br><span class="line">wget https://download.docker.com/linux/centos/7/x86_64/stable/Packages/containerd.io-1.4.13-3.1.el7.x86_64.rpm</span><br><span class="line">wget https://download.docker.com/linux/centos/7/x86_64/stable/Packages/docker-compose-plugin-2.3.3-3.el7.x86_64.rpm</span><br></pre></td></tr></table></figure>
<p>安装 docker</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">yum localinstall -y containerd.io-1.4.13-3.1.el7.x86_64.rpm \</span><br><span class="line">                    docker-ce-cli-19.03.15-3.el7.x86_64.rpm \</span><br><span class="line">                    docker-ce-19.03.15-3.el7.x86_64.rpm \</span><br><span class="line">                    docker-compose-plugin-2.3.3-3.el7.x86_64.rpm</span><br></pre></td></tr></table></figure>

<p>以上 2 条命令可以使用以下 1 条命令完成</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">yum localinstall -y https://download.docker.com/linux/centos/7/x86_64/stable/Packages/docker-ce-19.03.15-3.el7.x86_64.rpm \</span><br><span class="line">                    https://download.docker.com/linux/centos/7/x86_64/stable/Packages/docker-ce-cli-19.03.15-3.el7.x86_64.rpm \</span><br><span class="line">                    https://download.docker.com/linux/centos/7/x86_64/stable/Packages/containerd.io-1.4.13-3.1.el7.x86_64.rpm \</span><br><span class="line">                    https://download.docker.com/linux/centos/7/x86_64/stable/Packages/docker-compose-plugin-2.3.3-3.el7.x86_64.rpm</span><br></pre></td></tr></table></figure>

<p><strong>Docker 26 安装，适用于 <code>Centos 8</code>、<code>Rocky Linux 8</code> 等</strong></p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">yum localinstall -y https://download.docker.com/linux/centos/8/x86_64/stable/Packages/docker-ce-26.1.3-1.el8.x86_64.rpm https://download.docker.com/linux/centos/8/x86_64/stable/Packages/docker-ce-cli-26.1.3-1.el8.x86_64.rpm https://download.docker.com/linux/centos/8/x86_64/stable/Packages/containerd.io-1.6.32-3.1.el8.x86_64.rpm https://download.docker.com/linux/centos/8/x86_64/stable/Packages/docker-compose-plugin-2.6.0-3.el8.x86_64.rpm</span><br></pre></td></tr></table></figure>

<p>启动docker</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">systemctl enable docker --now</span><br></pre></td></tr></table></figure>
          <!--noindex-->
            <div class="post-button">
              <a class="btn" href="202208041317/#more" rel="contents">
                阅读全文 &raquo;
              </a>
            </div>
          <!--/noindex-->
        
      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://csms.tech/202208181117/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="images/avatar.gif">
      <meta itemprop="name" content="COSMOS">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="L B T">
      <meta itemprop="description" content="得 能 莫 忘">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | L B T">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="202208181117/" class="post-title-link" itemprop="url">vim</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2022-08-18 09:23:46" itemprop="dateCreated datePublished" datetime="2022-08-18T09:23:46+08:00">2022-08-18</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2025-02-27 15:02:00" itemprop="dateModified" datetime="2025-02-27T15:02:00+08:00">2025-02-27</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">上层目录</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="categories/Linux/" itemprop="url" rel="index"><span itemprop="name">Linux</span></a>
        </span>
          ，
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="categories/Linux/%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4/" itemprop="url" rel="index"><span itemprop="name">常用命令</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="环境信息"><a href="#环境信息" class="headerlink" title="环境信息"></a>环境信息</h1><ul>
<li>Centos 7</li>
</ul>
<h1 id="vim-配置"><a href="#vim-配置" class="headerlink" title="vim 配置"></a>vim 配置</h1><p><code>vim</code> 启动时会读取 <code>/etc/vimrc</code>（全局配置） 和 <code>~/.vimrc</code> （用户配置）</p>
<p>常用配置如下，使用 <code>&quot;</code> 注释</p>
<figure class="highlight shell"><figcaption><span>/etc/vimrc</span></figcaption><table><tr><td class="code"><pre><span class="line">&quot; 自动缩进 </span><br><span class="line">set ai</span><br><span class="line">set autoindent</span><br><span class="line"></span><br><span class="line">&quot; 保存历史命令数量</span><br><span class="line">set history=50</span><br><span class="line"></span><br><span class="line">&quot; 右下角显示当前鼠标位置（行列数）</span><br><span class="line">set ruler</span><br><span class="line"></span><br><span class="line">&quot; 鼠标位置所在行显示下划线</span><br><span class="line">set cursorline</span><br><span class="line"></span><br><span class="line">&quot; 开启语法高亮</span><br><span class="line">syntax on</span><br><span class="line"></span><br><span class="line">&quot; 高亮搜索结果</span><br><span class="line">set hlsearch</span><br><span class="line"></span><br><span class="line">&quot; 搜索时不区分大小写</span><br><span class="line">set ignorecase</span><br><span class="line"></span><br><span class="line">&quot; 将 tab 转换为空格</span><br><span class="line">set expandtab</span><br><span class="line"></span><br><span class="line">&quot; tab 转换为4个空格</span><br><span class="line">set tabstop=4</span><br><span class="line"></span><br><span class="line">&quot; 删除时，可以一次删除4个空格</span><br><span class="line">set softtabstop=4</span><br><span class="line"></span><br><span class="line">&quot; 显示行数</span><br><span class="line">set nu</span><br><span class="line"></span><br><span class="line">&quot; 禁用格式化指令。</span><br><span class="line">set paste</span><br></pre></td></tr></table></figure>
          <!--noindex-->
            <div class="post-button">
              <a class="btn" href="202208181117/#more" rel="contents">
                阅读全文 &raquo;
              </a>
            </div>
          <!--/noindex-->
        
      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://csms.tech/202304191340/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="images/avatar.gif">
      <meta itemprop="name" content="COSMOS">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="L B T">
      <meta itemprop="description" content="得 能 莫 忘">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | L B T">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="202304191340/" class="post-title-link" itemprop="url">linux namespace 简介</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2023-04-19 13:41:02" itemprop="dateCreated datePublished" datetime="2023-04-19T13:41:02+08:00">2023-04-19</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2025-02-20 15:02:00" itemprop="dateModified" datetime="2025-02-20T15:02:00+08:00">2025-02-20</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">上层目录</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="categories/Linux/" itemprop="url" rel="index"><span itemprop="name">Linux</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css"><h1 id="环境信息"><a href="#环境信息" class="headerlink" title="环境信息"></a>环境信息</h1><ul>
<li>Centos 7 5.4.239-1</li>
</ul>
<p>Linux 的 namespace 的作用是 <strong>隔离内核资</strong> ，目前主要实现了以下 namespace</p>
<ul>
<li><code>mount namespace</code> - 文件系统挂载点</li>
<li><code>UTS namespace</code> - 主机名</li>
<li><code>IPC namespace</code> - POSIX 进程间通信消息队列</li>
<li><code>PID namespace</code> - 进程 pid 数字空间</li>
<li><code>network namespace</code> - network</li>
<li><code>user namespace</code> - user ID 数字空间</li>
<li><code>cgroup</code> - 资源使用控制</li>
<li><code>time</code> - 隔离时钟（Clock）</li>
</ul>
<p>其中，除了 <code>network namespace</code>，其他 namespace 的操作需要使用 C 语言调用系统 API 实现。<code>network namespace</code> 的增删改查功能已经集成到了 Linux 的 <code>ip</code> 工具集的 <code>netns</code> 子命令中</p>
<p>Linux 里面的 namespace 给处在其中的进程造成 2 个错觉：</p>
<ol>
<li>它是系统里面唯一的进程</li>
<li>它独享系统的所有资源</li>
</ol>
<p>默认情况下，Linux 里面的所有进程处在和宿主机相同的 namespace ，即初始 namespace 里，默认享有全局系统资源。</p>
<p><strong><code>lsns</code> 命令可以查看当前系统上存在哪些 Namespace</strong></p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">lsns</span></span><br><span class="line">        NS TYPE   NPROCS     PID USER             COMMAND</span><br><span class="line">4026531834 time      251       1 root             /lib/systemd/systemd --system --deserialize 52</span><br><span class="line">4026531835 cgroup    224       1 root             /lib/systemd/systemd --system --deserialize 52</span><br><span class="line">4026531836 pid       224       1 root             /lib/systemd/systemd --system --deserialize 52</span><br><span class="line">4026531837 user      686       1 root             /lib/systemd/systemd --system --deserialize 52</span><br><span class="line">4026531838 uts       221       1 root             /lib/systemd/systemd --system --deserialize 52</span><br><span class="line">4026531839 ipc       224       1 root             /lib/systemd/systemd --system --deserialize 52</span><br><span class="line">4026531840 net       229       1 root             /lib/systemd/systemd --system --deserialize 52</span><br><span class="line">4026531841 mnt       213       1 root             /lib/systemd/systemd --system --deserialize 52</span><br><span class="line">4026531862 mnt         1      61 root             kdevtmpfs</span><br><span class="line">4026532219 mnt         1 1426338 root             /lib/systemd/systemd-udevd</span><br><span class="line">4026532220 uts         1 1426338 root             /lib/systemd/systemd-udevd</span><br><span class="line">4026532230 mnt         1 2124756 root             /lib/systemd/systemd-logind</span><br><span class="line">4026532231 uts         1 2124756 root             /lib/systemd/systemd-logind</span><br><span class="line">4026532232 mnt         1 1426274 systemd-timesync /lib/systemd/systemd-timesyncd</span><br><span class="line">4026532233 mnt         1 1426257 root             /usr/sbin/irqbalance --foreground</span><br><span class="line">4026532326 mnt         1 2134793 root             /usr/sbin/NetworkManager --no-daemon</span><br><span class="line">4026532593 cgroup      7  937225 root             python manage.py runserver 0.0.0.0:8080</span><br><span class="line">4026532603 mnt         1 1416468 472              grafana server --homepath=/usr/share/grafana --config=/etc/grafana/grafana.ini --packaging=docker cfg:defau</span><br><span class="line">4026532604 uts         1 1416468 472              grafana server --homepath=/usr/share/grafana --config=/etc/grafana/grafana.ini --packaging=docker cfg:defau</span><br><span class="line">4026532605 ipc         1 1416468 472              grafana server --homepath=/usr/share/grafana --config=/etc/grafana/grafana.ini --packaging=docker cfg:defau</span><br><span class="line">4026532606 pid         1 1416468 472              grafana server --homepath=/usr/share/grafana --config=/etc/grafana/grafana.ini --packaging=docker cfg:defau</span><br><span class="line">4026532607 net         1 1416468 472              grafana server --homepath=/usr/share/grafana --config=/etc/grafana/grafana.ini --packaging=docker cfg:defau</span><br><span class="line">4026532664 cgroup      1 1416468 472              grafana server --homepath=/usr/share/grafana --config=/etc/grafana/grafana.ini --packaging=docker cfg:defau</span><br><span class="line">4026532665 mnt         1 1416534 1001             /opt/bitnami/blackbox-exporter/bin/blackbox_exporter --config.file=/etc/blackbox/blackbox.yml</span><br><span class="line">4026532666 uts         1 1416534 1001             /opt/bitnami/blackbox-exporter/bin/blackbox_exporter --config.file=/etc/blackbox/blackbox.yml</span><br><span class="line">4026532667 ipc         1 1416534 1001             /opt/bitnami/blackbox-exporter/bin/blackbox_exporter --config.file=/etc/blackbox/blackbox.yml</span><br><span class="line">4026532668 pid         1 1416534 1001             /opt/bitnami/blackbox-exporter/bin/blackbox_exporter --config.file=/etc/blackbox/blackbox.yml</span><br><span class="line">4026532669 net         1 1416534 1001             /opt/bitnami/blackbox-exporter/bin/blackbox_exporter --config.file=/etc/blackbox/blackbox.yml</span><br></pre></td></tr></table></figure>

<p>想要查看某个进程都在哪些 namespace 中，可以找到进程 ID （PID），通过查看以下内容或者 namespace 信息</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">ps -elf | grep nginx</span></span><br><span class="line">4 S root     32679 32659  0  80   0 -  2248 sigsus Apr07 ?        00:00:00 nginx: master process nginx -g daemon off;</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">ll /proc/32679/ns/</span></span><br><span class="line">total 0</span><br><span class="line">lrwxrwxrwx 1 root root 0 Apr 19 13:51 cgroup -&gt; cgroup:[4026531835]</span><br><span class="line">lrwxrwxrwx 1 root root 0 Apr 19 13:51 ipc -&gt; ipc:[4026534784]</span><br><span class="line">lrwxrwxrwx 1 root root 0 Apr 19 13:51 mnt -&gt; mnt:[4026534583]</span><br><span class="line">lrwxrwxrwx 1 root root 0 Apr 19 13:51 net -&gt; net:[4026534787]</span><br><span class="line">lrwxrwxrwx 1 root root 0 Apr 19 13:51 pid -&gt; pid:[4026534878]</span><br><span class="line">lrwxrwxrwx 1 root root 0 Apr 19 13:51 pid_for_children -&gt; pid:[4026534878]</span><br><span class="line">lrwxrwxrwx 1 root root 0 Apr 19 13:51 user -&gt; user:[4026531837]</span><br><span class="line">lrwxrwxrwx 1 root root 0 Apr 19 13:51 uts -&gt; uts:[4026534877]</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>通过以上命令，可以看到 <code>nginx</code> 进程所属的 namespace，要查看系统初始 namespace ，可以查看 PID 为 1 的进程的 namespace 信息</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">ll /proc/1/ns/</span></span><br><span class="line">total 0</span><br><span class="line">lrwxrwxrwx 1 root root 0 Apr 19 13:53 cgroup -&gt; cgroup:[4026531835]</span><br><span class="line">lrwxrwxrwx 1 root root 0 Apr 19 13:53 ipc -&gt; ipc:[4026531839]</span><br><span class="line">lrwxrwxrwx 1 root root 0 Apr 19 13:53 mnt -&gt; mnt:[4026531840]</span><br><span class="line">lrwxrwxrwx 1 root root 0 Apr 19 13:53 net -&gt; net:[4026531992]</span><br><span class="line">lrwxrwxrwx 1 root root 0 Apr 19 13:53 pid -&gt; pid:[4026531836]</span><br><span class="line">lrwxrwxrwx 1 root root 0 Apr 19 13:53 pid_for_children -&gt; pid:[4026531836]</span><br><span class="line">lrwxrwxrwx 1 root root 0 Apr 19 13:53 user -&gt; user:[4026531837]</span><br><span class="line">lrwxrwxrwx 1 root root 0 Apr 19 13:53 uts -&gt; uts:[4026531838]</span><br></pre></td></tr></table></figure>

<blockquote>
<p>链接文件的内容的格式为 ns 类型: [inode number]。这里的 <code>inode number</code> 则用来标识一个 namespace，我们也可以把它理解为 namespace 的 ID。如果两个进程的某个 namespace 文件指向同一个链接文件，说明其相关资源在同一个 namespace 中。 <sup id="fnref:1"><a href="#fn:1" rel="footnote"><span class="hint--top hint--error hint--medium hint--rounded hint--bounce" aria-label="[不能不知道的三个docker容器隔离核心技术：namespace、cgroups、rootfs](https://zhuanlan.zhihu.com/p/374503196)">[1]</span></a></sup></p>
</blockquote>
<h1 id="脚注"><a href="#脚注" class="headerlink" title="脚注"></a>脚注</h1><div id="footnotes"><hr><div id="footnotelist"><ol style="list-style: none; padding-left: 0; margin-left: 40px"><li id="fn:1"><span style="display: inline-block; vertical-align: top; padding-right: 10px; margin-left: -40px">1.</span><span style="display: inline-block; vertical-align: top; margin-left: 10px;"><a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/374503196">不能不知道的三个docker容器隔离核心技术：namespace、cgroups、rootfs</a><a href="#fnref:1" rev="footnote"> ↩</a></span></li></ol></div></div>
      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




  <nav class="pagination">
    <span class="page-number current">1</span><a class="page-number" href="page/2/">2</a><span class="space">&hellip;</span><a class="page-number" href="page/13/">13</a><a class="extend next" rel="next" title="下一页" aria-label="下一页" href="page/2/"><i class="fa fa-angle-right"></i></a>
  </nav>

</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">


<div class="copyright">
  &copy; 
  <span itemprop="copyrightYear">2025</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">COSMOS</span>
</div>
<div class="busuanzi-count">
    <span class="post-meta-item" id="busuanzi_container_site_uv">
      <span class="post-meta-item-icon">
        <i class="fa fa-user"></i>
      </span>
      <span class="site-uv" title="总访客量">
        <span id="busuanzi_value_site_uv"></span>
      </span>
    </span>
    <span class="post-meta-item" id="busuanzi_container_site_pv">
      <span class="post-meta-item-icon">
        <i class="fa fa-eye"></i>
      </span>
      <span class="site-pv" title="总访问量">
        <span id="busuanzi_value_site_pv"></span>
      </span>
    </span>
</div>

    </div>
  </footer>

  
  <div class="reading-progress-bar"></div>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


  
  <script size="300" alpha="0.3" zIndex="-1" src="https://cdnjs.cloudflare.com/ajax/libs/ribbon.js/1.0.2/ribbon.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
<script src="js/comments.js"></script><script src="js/utils.js"></script><script src="js/motion.js"></script><script src="js/next-boot.js"></script>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/hexo-generator-searchdb/1.4.1/search.js" integrity="sha256-1kfA5uHPf65M5cphT2dvymhkuyHPQp5A53EGZOnOLmc=" crossorigin="anonymous"></script>
<script src="js/third-party/search/local-search.js"></script>




  <script src="js/third-party/pace.js"></script>

  
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>




<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/gitalk/1.8.0/gitalk.css" integrity="sha256-AJnUHL7dBv6PGaeyPQJcgQPDjt/Hn/PvYZde1iqfp8U=" crossorigin="anonymous">

<script class="next-config" data-name="gitalk" type="application/json">{"enable":true,"github_id":"fl9999","repo":"fl9999.github.io","client_id":"a11bf6f7860762b725b5","client_secret":"a99046105f8bddc72ec718d54dc3fd7f22070821","admin_user":"fl9999","distraction_free_mode":true,"proxy":"https://cors-anywhere.azm.workers.dev/https://github.com/login/oauth/access_token","language":null,"js":{"url":"https://cdnjs.cloudflare.com/ajax/libs/gitalk/1.8.0/gitalk.min.js","integrity":"sha256-MVK9MGD/XJaGyIghSVrONSnoXoGh3IFxLw0zfvzpxR4="},"path_md5":"d41d8cd98f00b204e9800998ecf8427e"}</script>
<script src="js/third-party/comments/gitalk.js"></script>

</body>
</html>
