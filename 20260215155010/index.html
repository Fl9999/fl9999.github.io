<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222" media="(prefers-color-scheme: light)">
<meta name="theme-color" content="#222" media="(prefers-color-scheme: dark)"><meta name="generator" content="Hexo 6.2.0">

  <link rel="apple-touch-icon" sizes="180x180" href="../images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="../images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="../images/favicon-16x16-next.png">
  <link rel="mask-icon" href="../images/logo.svg" color="#222">

<link rel="stylesheet" href="../css/main.css">



<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.2.1/css/all.min.css" integrity="sha256-Z1K5uhUaJXA7Ll0XrZ/0JhX4lAtZFpT6jkKrEDT0drU=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pace/1.2.4/themes/blue/pace-theme-minimal.css">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/pace/1.2.4/pace.min.js" integrity="sha256-gqd7YTjg/BtfqWSwsJOvndl0Bxc8gFImLEkXQT8+qj0=" crossorigin="anonymous"></script>

<script class="next-config" data-name="main" type="application/json">{"hostname":"csms.tech","root":"/","images":"../images","scheme":"Gemini","darkmode":true,"version":"8.14.2","exturl":false,"sidebar":{"position":"left","display":"always","padding":18,"offset":12},"copycode":{"enable":true,"style":null},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":"gitalk","storage":true,"lazyload":true,"nav":null,"activeClass":"gitalk"},"stickytabs":false,"motion":{"enable":true,"async":true,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeIn","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"æœç´¢...","empty":"æ²¡æœ‰æ‰¾åˆ°ä»»ä½•æœç´¢ç»“æœï¼š${query}","hits_time":"æ‰¾åˆ° ${hits} ä¸ªæœç´¢ç»“æœï¼ˆç”¨æ—¶ ${time} æ¯«ç§’ï¼‰","hits":"æ‰¾åˆ° ${hits} ä¸ªæœç´¢ç»“æœ"},"path":"../search.xml","localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false}}</script><script src="../js/config.js"></script>

    <meta name="description" content="AWS OpenSearch æ˜¯ä¸€ä¸ªå®Œå…¨å¼€æºçš„æœç´¢å’Œåˆ†æå¼•æ“ï¼Œç”¨äºæ—¥å¿—åˆ†æã€å®æ—¶åº”ç”¨ç¨‹åºç›‘æ§å’Œç‚¹å‡»æµåˆ†æç­‰ç”¨ä¾‹ã€‚ AWS OpenSearchï¼ˆAOSï¼‰ å’Œ Elasticsearch å¯¹æ¯”     OpenSearch Elasticsearch    èƒŒæ™¯ AWS ä¸»å¯¼çš„å¼€æºåˆ†æ”¯ Elastic å…¬å¸ä¸»å¯¼   æˆæƒ Apache 2.0 SSPL + Elastic License   å•†ä¸šæ§">
<meta property="og:type" content="article">
<meta property="og:title" content="AWS OpenSearch(AOS) æœåŠ¡">
<meta property="og:url" content="http://csms.tech/20260215155010/index.html">
<meta property="og:site_name" content="L B T">
<meta property="og:description" content="AWS OpenSearch æ˜¯ä¸€ä¸ªå®Œå…¨å¼€æºçš„æœç´¢å’Œåˆ†æå¼•æ“ï¼Œç”¨äºæ—¥å¿—åˆ†æã€å®æ—¶åº”ç”¨ç¨‹åºç›‘æ§å’Œç‚¹å‡»æµåˆ†æç­‰ç”¨ä¾‹ã€‚ AWS OpenSearchï¼ˆAOSï¼‰ å’Œ Elasticsearch å¯¹æ¯”     OpenSearch Elasticsearch    èƒŒæ™¯ AWS ä¸»å¯¼çš„å¼€æºåˆ†æ”¯ Elastic å…¬å¸ä¸»å¯¼   æˆæƒ Apache 2.0 SSPL + Elastic License   å•†ä¸šæ§">
<meta property="og:locale" content="zh_CN">
<meta property="article:published_time" content="2026-02-15T03:37:49.000Z">
<meta property="article:modified_time" content="2026-02-15T09:40:36.000Z">
<meta property="article:author" content="COSMOS">
<meta property="article:tag" content="AWS">
<meta name="twitter:card" content="summary">


<link rel="canonical" href="http://csms.tech/20260215155010/">



<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"zh-CN","comments":true,"permalink":"http://csms.tech/20260215155010/","path":"20260215155010/","title":"AWS OpenSearch(AOS) æœåŠ¡"}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>AWS OpenSearch(AOS) æœåŠ¡ | L B T</title>
  








  <noscript>
    <link rel="stylesheet" href="../css/noscript.css">
  </noscript>
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <div class="column">
      <header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="åˆ‡æ¢å¯¼èˆªæ " role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <p class="site-title">L B T</p>
      <i class="logo-line"></i>
    </a>
      <p class="site-subtitle" itemprop="description">è®° å½• è¿‡ å» çš„ ç» éªŒ</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger" aria-label="æœç´¢" role="button">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="../index.html" rel="section"><i class="fa fa-earth-americas fa-fw"></i>é¦–é¡µ</a></li><li class="menu-item menu-item-categories"><a href="../categories/" rel="section"><i class="fa fa-folder-tree fa-fw"></i>æ€»ç›®å½•<span class="badge">54</span></a></li><li class="menu-item menu-item-linux"><a href="../categories/Linux" rel="section"><i class="fa fa-brands fa-linux fa-fw"></i>Linux</a></li><li class="menu-item menu-item-python"><a href="../categories/Python" rel="section"><i class="fa fa-brands fa-python fa-fw"></i>Python</a></li><li class="menu-item menu-item-docker"><a href="../categories/Docker" rel="section"><i class="fa fa-brands fa-docker fa-fw"></i>Docker</a></li><li class="menu-item menu-item-kubernetes"><a href="../categories/Kubernetes" rel="section"><i class="fa fa-dharmachakra fa-fw"></i>Kubernetes</a></li><li class="menu-item menu-item-tags"><a href="../tags/" rel="section"><i class="fa fa-tornado fa-fw"></i>æ ‡ç­¾<span class="badge">79</span></a></li><li class="menu-item menu-item-archives"><a href="../archives/" rel="section"><i class="fa fa-rectangle-list fa-fw"></i>åˆ—è¡¨<span class="badge">312</span></a></li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>æœç´¢
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup"><div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off" maxlength="80"
           placeholder="æœç´¢..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close" role="button">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div class="search-result-container no-result">
  <div class="search-result-icon">
    <i class="fa fa-spinner fa-pulse fa-5x"></i>
  </div>
</div>

    </div>
  </div>

</header>
        
  
  <aside class="sidebar">

    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          æ–‡ç« æ€»ç›®å½•
        </li>
        <li class="sidebar-nav-overview">
          ç«™ç‚¹æ¦‚è§ˆ
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
            <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%88%9B%E5%BB%BA-OpenSearch-%E5%9F%9F-AOS"><span class="nav-number">1.</span> <span class="nav-text">åˆ›å»º OpenSearch åŸŸ (AOS)</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#EKS-1-34-%E9%83%A8%E7%BD%B2-Fluent-Bit-%E5%86%99%E5%85%A5%E6%97%A5%E5%BF%97%E5%88%B0-AOS"><span class="nav-number">2.</span> <span class="nav-text">EKS 1.34 éƒ¨ç½² Fluent Bit å†™å…¥æ—¥å¿—åˆ° AOS</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#Fluent-Bit-%E6%97%A5%E5%BF%97%E6%9C%AA%E5%86%99%E5%85%A5-AOS-%E6%8E%92%E6%9F%A5%E6%B5%81%E7%A8%8B"><span class="nav-number">2.1.</span> <span class="nav-text">Fluent Bit æ—¥å¿—æœªå†™å…¥ AOS æ’æŸ¥æµç¨‹</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Fluent-Bit-%E9%85%8D%E7%BD%AE%E8%AF%B4%E6%98%8E"><span class="nav-number">3.</span> <span class="nav-text">Fluent Bit é…ç½®è¯´æ˜</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#SERVICE-%E9%85%8D%E7%BD%AE%E8%AF%A6%E8%A7%A3"><span class="nav-number">3.1.</span> <span class="nav-text">SERVICE é…ç½®è¯¦è§£</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#INPUT-%E9%85%8D%E7%BD%AE%E8%AF%A6%E8%A7%A3"><span class="nav-number">3.2.</span> <span class="nav-text">INPUT é…ç½®è¯¦è§£</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#FILTER-%E9%85%8D%E7%BD%AE%E8%AF%A6%E8%A7%A3"><span class="nav-number">3.3.</span> <span class="nav-text">FILTER é…ç½®è¯¦è§£</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#OUTPUT-%E9%85%8D%E7%BD%AE%E8%AF%A6%E8%A7%A3"><span class="nav-number">3.4.</span> <span class="nav-text">OUTPUT é…ç½®è¯¦è§£</span></a></li></ol></li></ol></div>
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">COSMOS</p>
  <div class="site-description" itemprop="description">å¾— èƒ½ è« å¿˜</div>
</div>
<div class="site-state-wrap animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="../archives/">
          <span class="site-state-item-count">312</span>
          <span class="site-state-item-name">æ–‡ç« </span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
          <a href="../categories/">
        <span class="site-state-item-count">54</span>
        <span class="site-state-item-name">ç›®å½•</span></a>
      </div>
      <div class="site-state-item site-state-tags">
          <a href="../tags/">
        <span class="site-state-item-count">79</span>
        <span class="site-state-item-name">æ ‡ç­¾</span></a>
      </div>
  </nav>
</div>

        </div>
      </div>
        <div class="back-to-top animated" role="button" aria-label="è¿”å›é¡¶éƒ¨">
          <i class="fa fa-arrow-up"></i>
          <span>0%</span>
        </div>
    </div>

    
  </aside>


    </div>

    <div class="main-inner post posts-expand">


  


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://csms.tech/20260215155010/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="../images/avatar.gif">
      <meta itemprop="name" content="COSMOS">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="L B T">
      <meta itemprop="description" content="å¾— èƒ½ è« å¿˜">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="AWS OpenSearch(AOS) æœåŠ¡ | L B T">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          AWS OpenSearch(AOS) æœåŠ¡
        </h1>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">å‘è¡¨äº</span>
      

      <time title="åˆ›å»ºæ—¶é—´ï¼š2026-02-15 11:37:49 / ä¿®æ”¹æ—¶é—´ï¼š17:40:36" itemprop="dateCreated datePublished" datetime="2026-02-15T11:37:49+08:00">2026-02-15</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">ä¸Šå±‚ç›®å½•</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="../categories/%E4%BA%91%E5%B9%B3%E5%8F%B0/" itemprop="url" rel="index"><span itemprop="name">äº‘å¹³å°</span></a>
        </span>
          ï¼Œ
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="../categories/%E4%BA%91%E5%B9%B3%E5%8F%B0/AWS/" itemprop="url" rel="index"><span itemprop="name">AWS</span></a>
        </span>
    </span>

  
    <span class="post-meta-item" title="é˜…è¯»æ¬¡æ•°" id="busuanzi_container_page_pv">
      <span class="post-meta-item-icon">
        <i class="far fa-eye"></i>
      </span>
      <span class="post-meta-item-text">é˜…è¯»æ¬¡æ•°ï¼š</span>
      <span id="busuanzi_value_page_pv"></span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
        <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css"><p>AWS OpenSearch æ˜¯ä¸€ä¸ªå®Œå…¨å¼€æºçš„æœç´¢å’Œåˆ†æå¼•æ“ï¼Œç”¨äºæ—¥å¿—åˆ†æã€å®æ—¶åº”ç”¨ç¨‹åºç›‘æ§å’Œç‚¹å‡»æµåˆ†æç­‰ç”¨ä¾‹ã€‚</p>
<p>AWS OpenSearchï¼ˆAOSï¼‰ å’Œ Elasticsearch å¯¹æ¯”</p>
<table>
<thead>
<tr>
<th></th>
<th>OpenSearch</th>
<th>Elasticsearch</th>
</tr>
</thead>
<tbody><tr>
<td>èƒŒæ™¯</td>
<td>AWS ä¸»å¯¼çš„å¼€æºåˆ†æ”¯</td>
<td>Elastic å…¬å¸ä¸»å¯¼</td>
</tr>
<tr>
<td>æˆæƒ</td>
<td>Apache 2.0</td>
<td>SSPL + Elastic License</td>
</tr>
<tr>
<td>å•†ä¸šæ§åˆ¶</td>
<td>ç¤¾åŒºé©±åŠ¨</td>
<td>å…¬å¸æ§åˆ¶</td>
</tr>
<tr>
<td>K8s ç”Ÿæ€</td>
<td>éå¸¸å‹å¥½</td>
<td>ä¹Ÿæ”¯æŒ</td>
</tr>
<tr>
<td>äº‘åŸç”Ÿè¶‹åŠ¿</td>
<td>è¶Šæ¥è¶Šä¸»æµ</td>
<td>å•†ä¸šç‰ˆæ›´å¼º</td>
</tr>
<tr>
<td>æ—¥å¿—æ£€ç´¢</td>
<td>å¾ˆå¼º</td>
<td>å¾ˆå¼º</td>
</tr>
<tr>
<td>å‘é‡æœç´¢</td>
<td>æœ‰</td>
<td>æ›´æˆç†Ÿ</td>
</tr>
<tr>
<td>ML åŠŸèƒ½</td>
<td>æœ‰</td>
<td>æ›´å¼º</td>
</tr>
<tr>
<td>APM</td>
<td>åŸºç¡€</td>
<td>å•†ä¸šç‰ˆæ›´å¼º</td>
</tr>
<tr>
<td>æ’ä»¶ç”Ÿæ€</td>
<td>å°‘ä¸€äº›</td>
<td>æ›´ä¸°å¯Œ</td>
</tr>
</tbody></table>
<p>åŸæœ¬æ˜¯åŒä¸€ä¸ªé¡¹ç›®</p>
<p>2021 å¹´å› æˆæƒé—®é¢˜åˆ†å‰</p>
<p>ğŸ‘‰ 7.10 æ˜¯æœ€åä¸€ä¸ªçº¯å¼€æº Elasticsearch ç‰ˆæœ¬<br>ä¹‹å AWS fork å‡ºï¼š</p>
<p>ğŸ”¹ OpenSearch</p>
<p>è€ŒåŸå‚ç»§ç»­å‘å±•ï¼š</p>
<p>ğŸ”¹ Elasticsearch</p>
<p>åœ¨ AWS ä¸Šï¼ŒAmazon æ‰˜ç®¡æœåŠ¡é»˜è®¤æ˜¯ OpenSearchã€‚</p>
<h1 id="åˆ›å»º-OpenSearch-åŸŸ-AOS"><a href="#åˆ›å»º-OpenSearch-åŸŸ-AOS" class="headerlink" title="åˆ›å»º OpenSearch åŸŸ (AOS)"></a>åˆ›å»º OpenSearch åŸŸ (AOS)</h1><p>OpenSearch æœåŠ¡åŸŸæ˜¯ OpenSearch é›†ç¾¤çš„åŒä¹‰è¯.åŸŸæ˜¯åŒ…å«æ‚¨æŒ‡å®šçš„è®¾ç½®ã€å®ä¾‹ç±»å‹ã€å®ä¾‹è®¡æ•°å’Œå­˜å‚¨èµ„æºçš„é›†ç¾¤ã€‚<br>ç™»å½•æ§åˆ¶å°ï¼šå‰å¾€ Amazon OpenSearch Serviceã€‚ <strong>Domains -&gt; Create domain</strong> ã€‚ </p>
<ul>
<li>å¡«å†™ <strong>åŸŸï¼ˆDomainï¼‰åç§°</strong></li>
<li>é€‰æ‹© <strong>æ ‡å‡†åˆ›å»º</strong></li>
<li>é€‰æ‹©å®ä¾‹ç±»å‹å’Œæ•°é‡</li>
<li>ç½‘ç»œé€‰é¡¹åŒ…å« 2 ç§ï¼Œåˆ›å»ºé›†ç¾¤åä¸èƒ½å†å˜æ›´ï¼š<ul>
<li>VPC è®¿é—®ï¼Œæ­¤ä¸­æ–¹å¼åˆ›å»ºçš„ Domain åªæ”¯æŒ VPC å†…éƒ¨è®¿é—®ï¼Œä¸æ”¯æŒäº’è”ç½‘å…¬å¼€è®¿é—®ï¼Œå¦‚æœè¦äº’è”ç½‘è®¿é—®ï¼Œå¯ä»¥é€šè¿‡åœ¨ VPC å†…éƒ¨ä½¿ç”¨ Nginx ä»£ç†ã€‚</li>
<li>å…¬å¼€è®¿é—®æƒé™ï¼Œå…è®¸äº’è”ç½‘è®¿é—®</li>
</ul>
</li>
</ul>
<p>ä½¿ç”¨ <strong>å…¬å¼€è®¿é—®æƒé™</strong> éƒ¨ç½²çš„ AOSï¼Œå¯ä»¥ç›´æ¥ä½¿ç”¨ OpenSearch æ§åˆ¶é¢æ¿ URL åœ¨äº’è”ç½‘è®¿é—®ã€‚å¦‚æœè¦æ§åˆ¶è®¿é—®ï¼Œå¯ä»¥ä½¿ç”¨ä»¥ä¸‹æ–¹æ³•ï¼š</p>
<ul>
<li><p>ä¿®æ”¹ <strong>é›†ç¾¤è®¿é—®ç­–ç•¥ (Access Policy)</strong></p>
<ol>
<li>è¿›å…¥ Amazon OpenSearch Service æ§åˆ¶å°ï¼Œç‚¹å‡»è¿›å…¥ä½ çš„ Domain (ç½‘åŸŸ)ã€‚</li>
<li>ç‚¹å‡» Security configuration (å®‰å…¨é…ç½®) é€‰é¡¹å¡ã€‚</li>
<li>æ»šåŠ¨åˆ° Access policy (è®¿é—®ç­–ç•¥) éƒ¨åˆ†ã€‚</li>
<li>åœ¨ JSON ç¼–è¾‘æ¡†ä¸­ï¼Œæ·»åŠ åŸºäº IpAddress çš„ Conditionã€‚ <figure class="highlight json"><table><tr><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;Version&quot;</span><span class="punctuation">:</span> <span class="string">&quot;2012-10-17&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;Statement&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">    <span class="punctuation">&#123;</span></span><br><span class="line">      <span class="attr">&quot;Effect&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Allow&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;Principal&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;AWS&quot;</span><span class="punctuation">:</span> <span class="string">&quot;*&quot;</span></span><br><span class="line">      <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;Action&quot;</span><span class="punctuation">:</span> <span class="string">&quot;es:*&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;Resource&quot;</span><span class="punctuation">:</span> <span class="string">&quot;arn:aws:es:ap-southeast-1:ä½ çš„è´¦å·ID:domain/ä½ çš„åŸŸ/*&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;Condition&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;IpAddress&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">          <span class="attr">&quot;aws:SourceIp&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">            <span class="string">&quot;1.2.3.4/32&quot;</span><span class="punctuation">,</span>     <span class="comment">// ä½ åŠå…¬å®¤çš„å…¬ç½‘å‡ºå£ IP</span></span><br><span class="line">            <span class="string">&quot;5.6.7.8/32&quot;</span>      <span class="comment">// EKS èŠ‚ç‚¹çš„å…¬ç½‘å‡ºå£ IP (NAT Gateway EIP)</span></span><br><span class="line">          <span class="punctuation">]</span></span><br><span class="line">        <span class="punctuation">&#125;</span></span><br><span class="line">      <span class="punctuation">&#125;</span></span><br><span class="line">    <span class="punctuation">&#125;</span></span><br><span class="line">  <span class="punctuation">]</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure></li>
</ol>
</li>
</ul>
<h1 id="EKS-1-34-éƒ¨ç½²-Fluent-Bit-å†™å…¥æ—¥å¿—åˆ°-AOS"><a href="#EKS-1-34-éƒ¨ç½²-Fluent-Bit-å†™å…¥æ—¥å¿—åˆ°-AOS" class="headerlink" title="EKS 1.34 éƒ¨ç½² Fluent Bit å†™å…¥æ—¥å¿—åˆ° AOS"></a>EKS 1.34 éƒ¨ç½² Fluent Bit å†™å…¥æ—¥å¿—åˆ° AOS</h1><p>åœ¨ EKS 1.34ï¼ˆè‡ªåŠ¨æ¨¡å¼&#x2F;Auto Modeï¼‰ä¸­éƒ¨ç½² Fluent Bit å¹¶å†™å…¥æ‰˜ç®¡çš„ OpenSearch (AOS) æ˜¯ä¸€ä¸ªéå¸¸é«˜æ•ˆçš„ç»„åˆã€‚EKS Auto ä¼šè‡ªåŠ¨å¤„ç†èŠ‚ç‚¹é…ç½®ï¼Œä½†æ—¥å¿—é‡‡é›†é€»è¾‘ä¾ç„¶éµå¾ª IRSA (IAM Roles for Service Accounts) æœºåˆ¶ã€‚</p>
<p>ä»¥ä¸‹æ˜¯å®Œæ•´çš„éƒ¨ç½²æŒ‡å—</p>
<ol>
<li><p><strong>å‡†å¤‡ AOS è®¿é—®ç­–ç•¥ (Access Policy)</strong></p>
<p> ç¡®ä¿ä½ çš„ AOS é›†ç¾¤å…è®¸æ¥è‡ª EKS çš„è®¿é—®ã€‚å¦‚æœ AOS å’Œ EKS å†…ç½‘èƒ½äº’é€šï¼Œå»ºè®®ä½¿ç”¨ AOS å†…ç½‘é€šä¿¡ï¼Œå¯ä»¥èŠ‚çœæµé‡è´¹ç”¨ã€‚</p>
<p> åœ¨ AOS æ§åˆ¶å°çš„ Access Policy ä¸­æ·»åŠ ï¼š</p>
 <figure class="highlight json"><table><tr><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;Effect&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Allow&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;Principal&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span> <span class="attr">&quot;AWS&quot;</span><span class="punctuation">:</span> <span class="string">&quot;*&quot;</span> <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;Action&quot;</span><span class="punctuation">:</span> <span class="string">&quot;es:*&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;Resource&quot;</span><span class="punctuation">:</span> <span class="string">&quot;arn:aws:es:ap-southeast-1:è´¦å·ID:domain/åŸŸå/*&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;Condition&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;IpAddress&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span> <span class="attr">&quot;aws:SourceIp&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="string">&quot;NAT_GATEWAY_EIP/32&quot;</span><span class="punctuation">,</span> <span class="string">&quot;ä½ çš„åŠå…¬å®¤IP/32&quot;</span><span class="punctuation">]</span> <span class="punctuation">&#125;</span></span><br><span class="line">  <span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure></li>
<li><p><strong>EKS ä¸­åˆ›å»º IAM è§’è‰² (IRSA)</strong> ã€‚Fluent Bit éœ€è¦æƒé™å‘ AOS å†™å…¥æ•°æ®ã€‚ä½¿ç”¨ <code>eksctl</code> æ˜¯æœ€ç®€å•çš„æ–¹æ³•ï¼š</p>
 <figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">æ›¿æ¢å˜é‡</span></span><br><span class="line">CLUSTER_NAME=&quot;your-eks-auto-cluster&quot;</span><br><span class="line">REGION=&quot;ap-southeast-1&quot;</span><br><span class="line">POLICY_ARN=&quot;arn:aws:iam::aws:policy/AmazonOpenSearchServiceFullAccess&quot; # å»ºè®®ç”Ÿäº§ç¯å¢ƒç”¨ç²¾ç®€æƒé™</span><br><span class="line"></span><br><span class="line">eksctl create iamserviceaccount \</span><br><span class="line">    --name fluent-bit-sa \</span><br><span class="line">    --namespace logging \</span><br><span class="line">    --cluster $CLUSTER_NAME \</span><br><span class="line">    --region $REGION \</span><br><span class="line">    --attach-policy-arn $POLICY_ARN \</span><br><span class="line">    --approve \</span><br><span class="line">    --override-existing-serviceaccounts</span><br></pre></td></tr></table></figure>
</li>
<li><p><strong>éƒ¨ç½² Fluent Bit (Helm)</strong></p>
 <figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">helm repo add eks https://aws.github.io/eks-charts</span><br><span class="line">helm repo update</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p> <strong>åˆ›å»º values.yaml</strong></p>
 <figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="attr">serviceAccount:</span></span><br><span class="line">  <span class="attr">create:</span> <span class="literal">false</span></span><br><span class="line">  <span class="attr">name:</span> <span class="string">fluent-bit-sa</span></span><br><span class="line"></span><br><span class="line"><span class="attr">image:</span></span><br><span class="line">  <span class="attr">repository:</span> <span class="string">public.ecr.aws/aws-observability/aws-for-fluent-bit</span></span><br><span class="line">  <span class="attr">tag:</span> <span class="number">2.32</span><span class="number">.2</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># æ˜¾å¼å…³é—­é»˜è®¤çš„è¾“å‡º</span></span><br><span class="line"><span class="attr">cloudWatchLogs:</span></span><br><span class="line">  <span class="attr">enabled:</span> <span class="literal">false</span></span><br><span class="line"><span class="attr">firehose:</span></span><br><span class="line">  <span class="attr">enabled:</span> <span class="literal">false</span></span><br><span class="line"><span class="attr">kinesis:</span></span><br><span class="line">  <span class="attr">enabled:</span> <span class="literal">false</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># å…³é”®ä¿®æ­£ï¼šåœ¨è¯¥ Chart ä¸­ï¼Œè‡ªå®šä¹‰è¾“å‡ºéœ€è¦å†™åœ¨ additionalOutputs ä¸‹</span></span><br><span class="line"><span class="attr">additionalOutputs:</span> <span class="string">|</span></span><br><span class="line"><span class="string">    [OUTPUT]</span></span><br><span class="line"><span class="string">        Name            opensearch</span></span><br><span class="line"><span class="string">        Match           kube.*</span></span><br><span class="line"><span class="string">        Host            search-aos-dashboard-singapore-logs-5piwcj3oxpdojos7cxfeelgbku.ap-southeast-1.es.amazonaws.com</span></span><br><span class="line"><span class="string">        Port            443</span></span><br><span class="line"><span class="string">        TLS             On</span></span><br><span class="line"><span class="string">        AWS_Auth        On</span></span><br><span class="line"><span class="string">        AWS_Region      ap-southeast-1</span></span><br><span class="line"><span class="string">        Logstash_Format On</span></span><br><span class="line"><span class="string">        Logstash_Prefix eks-logs</span></span><br><span class="line"><span class="string">        Replace_Dots    On</span></span><br><span class="line"><span class="string">        Suppress_Type_Name On</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="comment"># å¦‚æœä½ éœ€è¦ä¿®æ”¹é»˜è®¤çš„ Filterï¼ˆæ¯”å¦‚ Buffer_Sizeï¼‰ï¼Œè¯¥ Chart é€šå¸¸ä¸æ”¯æŒç›´æ¥è¦†ç›–</span></span><br><span class="line"><span class="comment"># ä½ å¯èƒ½éœ€è¦é€šè¿‡å…¨é‡è‡ªå®šä¹‰é…ç½®æ–‡ä»¶çš„æ–¹å¼ï¼Œæˆ–è€…æ¥å—é»˜è®¤çš„ Kubernetes Filter è®¾ç½®</span></span><br></pre></td></tr></table></figure>

<p> éƒ¨ç½²</p>
 <figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">helm install fluent-bit eks/aws-for-fluent-bit -f values.yaml -n logging</span><br></pre></td></tr></table></figure>
</li>
<li><p>æœ¬ç¤ºä¾‹ä¸­ AWS Opensearch ä½¿ç”¨äº† <strong>ç»†ç²’åº¦è®¿é—®æ§åˆ¶ (Fine-Grained Access Control)</strong> ï¼Œå› æ­¤ <strong>IAM è§’è‰²è¿˜å¿…é¡»åœ¨ OpenSearch å†…éƒ¨è¿›è¡Œâ€œèº«ä»½æ˜ å°„â€</strong> ã€‚</p>
<p> <strong>åœ¨ OpenSearch Dashboard æ˜ å°„ Backend Role (æœ€æ ¸å¿ƒ)</strong></p>
<ol>
<li>ç™»å½•ä½ çš„ OpenSearch Dashboardã€‚</li>
<li>ç‚¹å‡»å·¦ä¾§ä¾§è¾¹æ ï¼š<strong>Security (å®‰å…¨) -&gt; Roles (è§’è‰²)</strong> ã€‚</li>
<li>åœ¨åˆ—è¡¨ä¸­æœç´¢å¹¶ç‚¹å‡» <code>all_access</code>ï¼ˆä¸ºäº†æµ‹è¯•å»ºè®®å…ˆç”¨è¿™ä¸ªï¼Œç”Ÿäº§ç¯å¢ƒå»ºè®®ç”¨ <code>logstash</code> è§’è‰²ï¼‰ã€‚</li>
<li>ç‚¹å‡»é¡¶éƒ¨çš„ <strong>Mapped users (æ˜ å°„çš„ç”¨æˆ·)</strong> æ ‡ç­¾é¡µã€‚</li>
<li>ç‚¹å‡» <strong>Manage mapping (ç®¡ç†æ˜ å°„)</strong></li>
<li>åœ¨ <strong>Backend roles (åç«¯è§’è‰²)</strong> è¾“å…¥æ¡†ä¸­ï¼Œç²˜è´´ä½ çš„ IAM Role ARNï¼š<code>arn:aws:iam::&lt;ACCOUNT_ID&gt;:role/addon-iamserviceaccount-logging--Role1-hXqpDva2jMoy</code><blockquote>
<p>IAM Role ARN å¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤æŸ¥è¯¢ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"># kubectl get sa fluent-bit-sa -n logging -o yaml</span><br><span class="line">apiVersion: v1</span><br><span class="line">kind: ServiceAccount</span><br><span class="line">metadata:</span><br><span class="line"> annotations:</span><br><span class="line">   eks.amazonaws.com/role-arn: arn:aws:iam::&lt;ACCOUNT_ID&gt;:role/eksctl-addon-iamserviceaccount-logging--Role1-hXqpDva2jMoy</span><br><span class="line"> creationTimestamp: &quot;2026-02-15T08:27:50Z&quot;</span><br><span class="line"> labels:</span><br><span class="line">   app.kubernetes.io/managed-by: eksctl</span><br><span class="line"> name: fluent-bit-sa</span><br><span class="line"> namespace: logging</span><br><span class="line"> resourceVersion: &quot;27178999&quot;</span><br><span class="line"> uid: 3031f611-f501-4fa3-be44-3d73cb81fb1c</span><br></pre></td></tr></table></figure></blockquote>
</li>
</ol>
</li>
</ol>
<h2 id="Fluent-Bit-æ—¥å¿—æœªå†™å…¥-AOS-æ’æŸ¥æµç¨‹"><a href="#Fluent-Bit-æ—¥å¿—æœªå†™å…¥-AOS-æ’æŸ¥æµç¨‹" class="headerlink" title="Fluent Bit æ—¥å¿—æœªå†™å…¥ AOS æ’æŸ¥æµç¨‹"></a>Fluent Bit æ—¥å¿—æœªå†™å…¥ AOS æ’æŸ¥æµç¨‹</h2><ol>
<li><p>é¦–å…ˆæ£€æŸ¥ FluentBit æ—¥å¿—ä¿¡æ¯ï¼Œçœ‹å…¶ä¸­æ˜¯å¦æœ‰æŠ¥é”™ä¿¡æ¯</p>
 <figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">kubectl logs -n logging -l app.kubernetes.io/name=aws-for-fluent-bit | grep -iE &quot;opensearch|error|exception&quot;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
</li>
<li><p>å¦‚æœæ²¡æœ‰æŠ¥é”™ä¿¡æ¯ï¼Œå¯ä»¥ä¿®æ”¹ Fluentbit æ—¥å¿—çº§åˆ«ï¼Œè¾“å‡ºæ›´è¯¦ç»†æ—¥å¿—ï¼Œç¼–è¾‘ Configmap <code>fluent-bit-aws-for-fluent-bit</code> ï¼Œ<code>[SERVICE]</code> éƒ¨åˆ†æ·»åŠ æˆ–ä¿®æ”¹ <code>Log_Level debug</code> ã€‚é‡å¯ Pod åå†æ¬¡æ£€æŸ¥æ—¥å¿—ã€‚å®šä½å®Œé—®é¢˜åè®°å¾—æ”¹å›åŸæ¥çš„æ—¥å¿—çº§åˆ«</p>
 <figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">kubectl get configmap -n logging</span></span><br><span class="line">NAME                            DATA   AGE</span><br><span class="line">fluent-bit-aws-for-fluent-bit   1      86m</span><br><span class="line">kube-root-ca.crt                1      97m</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">kubectl edit configmap -n logging fluent-bit-aws-for-fluent-bit</span></span><br><span class="line">configmap/fluent-bit-aws-for-fluent-bit edited</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">kubectl delete pod -n logging fluent-bit-aws-for-fluent-bit-jjbfx</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>é‡æ–°æ£€æŸ¥æ—¥å¿—ä¿¡æ¯ï¼Œå¯ä»¥æœç´¢å…³é”®å­—ï¼Œå¦‚è¾“å‡ºåˆ° AWS Opensearch</p>
 <figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">kubectl logs  -n logging -l app.kubernetes.io/name=aws-for-fluent-bit | grep -i opense</span></span><br><span class="line">[2026/02/15 10:12:27] [ warn] [engine] failed to flush chunk &#x27;1-1771150346.332440544.flb&#x27;, retry in 11 seconds: task_id=6, input=tail.0 &gt; output=opensearch.0 (out_id=0)</span><br><span class="line">[2026/02/15 10:12:27] [debug] [output:opensearch:opensearch.0] HTTP Status=403 URI=/_bulk</span><br><span class="line">[2026/02/15 10:12:27] [error] [output:opensearch:opensearch.0] HTTP status=403 URI=/_bulk, response:</span><br><span class="line">[2026/02/15 10:12:27] [ warn] [engine] failed to flush chunk &#x27;1-1771150346.251003257.flb&#x27;, retry in 7 seconds: task_id=1, input=tail.0 &gt; output=opensearch.0 (out_id=0)</span><br><span class="line">[2026/02/15 10:12:27] [debug] [output:opensearch:opensearch.0] HTTP Status=403 URI=/_bulk</span><br><span class="line">[2026/02/15 10:12:27] [error] [output:opensearch:opensearch.0] HTTP status=403 URI=/_bulk, response:</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p> ä»é”™è¯¯ä¿¡æ¯å¯è§æ˜¯å› ä¸ºè¯·æ±‚ Opensearch è¿”å›äº† 403ã€‚è¯´æ˜ <strong>ç½‘ç»œæ˜¯é€šçš„ï¼Œä½† OpenSearch æ‹’ç»äº† Fluent Bit çš„å†™å…¥è¯·æ±‚ã€‚</strong></p>
<p> æœ¬ç¤ºä¾‹ä¸­ AWS Opensearch ä½¿ç”¨äº† <strong>ç»†ç²’åº¦è®¿é—®æ§åˆ¶ (Fine-Grained Access Control)</strong> ï¼Œå› æ­¤ <strong>IAM è§’è‰²è¿˜å¿…é¡»åœ¨ OpenSearch å†…éƒ¨è¿›è¡Œâ€œèº«ä»½æ˜ å°„â€</strong> ã€‚</p>
<ol>
<li><strong>åœ¨ OpenSearch Dashboard æ˜ å°„ Backend Role (æœ€æ ¸å¿ƒ)</strong><ol>
<li>ç™»å½•ä½ çš„ OpenSearch Dashboardã€‚</li>
<li>ç‚¹å‡»å·¦ä¾§ä¾§è¾¹æ ï¼š<strong>Security (å®‰å…¨) -&gt; Roles (è§’è‰²)</strong> ã€‚</li>
<li>åœ¨åˆ—è¡¨ä¸­æœç´¢å¹¶ç‚¹å‡» <code>all_access</code>ï¼ˆä¸ºäº†æµ‹è¯•å»ºè®®å…ˆç”¨è¿™ä¸ªï¼Œç”Ÿäº§ç¯å¢ƒå»ºè®®ç”¨ <code>logstash</code> è§’è‰²ï¼‰ã€‚</li>
<li>ç‚¹å‡»é¡¶éƒ¨çš„ <strong>Mapped users (æ˜ å°„çš„ç”¨æˆ·)</strong> æ ‡ç­¾é¡µã€‚</li>
<li>ç‚¹å‡» <strong>Manage mapping (ç®¡ç†æ˜ å°„)</strong></li>
<li>åœ¨ <strong>Backend roles (åç«¯è§’è‰²)</strong> è¾“å…¥æ¡†ä¸­ï¼Œç²˜è´´ä½ çš„ IAM Role ARNï¼š<code>arn:aws:iam::&lt;ACCOUNT_ID&gt;:role/addon-iamserviceaccount-logging--Role1-hXqpDva2jMoy</code></li>
</ol>
</li>
</ol>
</li>
</ol>
<h1 id="Fluent-Bit-é…ç½®è¯´æ˜"><a href="#Fluent-Bit-é…ç½®è¯´æ˜" class="headerlink" title="Fluent Bit é…ç½®è¯´æ˜"></a>Fluent Bit é…ç½®è¯´æ˜</h1><p>Fluent Bit æ˜¯ä¸€ä¸ªè½»é‡çº§ã€é«˜æ€§èƒ½çš„æ—¥å¿—æ”¶é›†ä¸è½¬å‘å·¥å…·ï¼Œå¸¸ç”¨äº Kubernetes &#x2F; EKS &#x2F; Docker &#x2F; Linux æœåŠ¡å™¨ åœºæ™¯ã€‚</p>
<p>æ ¸å¿ƒç†å¿µå°±æ˜¯ï¼š<strong>Input â†’ Filter â†’ Output</strong></p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">æ—¥å¿—æ–‡ä»¶ / å®¹å™¨ stdout</span><br><span class="line">        â†“</span><br><span class="line">     INPUT</span><br><span class="line">        â†“</span><br><span class="line">     FILTER</span><br><span class="line">        â†“</span><br><span class="line">     OUTPUT</span><br><span class="line">        â†“</span><br><span class="line">   ES / Loki / Kafka / S3 / etc</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p><strong>Fluent Bit çš„æ ¸å¿ƒé…ç½®åˆ†ä¸º 4 å¤§å—</strong> ï¼š</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">[SERVICE]</span><br><span class="line">[INPUT]</span><br><span class="line">[FILTER]</span><br><span class="line">[OUTPUT]</span><br></pre></td></tr></table></figure>

<h2 id="SERVICE-é…ç½®è¯¦è§£"><a href="#SERVICE-é…ç½®è¯¦è§£" class="headerlink" title="SERVICE é…ç½®è¯¦è§£"></a>SERVICE é…ç½®è¯¦è§£</h2><p>å®šä¹‰äº†æ•´ä¸ª Fluent Bit è¿è¡Œæ—¶çš„å…¨å±€è¡Œä¸ºã€‚</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">[SERVICE]</span><br><span class="line">    Flush         1</span><br><span class="line">    Daemon        Off</span><br><span class="line">    Log_Level     info</span><br><span class="line">    Parsers_File  parsers.conf</span><br><span class="line">    HTTP_Server   On</span><br><span class="line">    HTTP_Listen   0.0.0.0</span><br><span class="line">    HTTP_Port     2020</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<table>
<thead>
<tr>
<th>å‚æ•°</th>
<th>ä½œç”¨</th>
</tr>
</thead>
<tbody><tr>
<td>Flush</td>
<td>Fluent Bit å¼•æ“æ¯éš” 1 ç§’ä¼šå°†æ”¶é›†åˆ°çš„æ—¥å¿—ä»ç¼“å†²åŒºï¼ˆBufferï¼‰å‘é€åˆ°æŒ‡å®šçš„è¾“å‡ºç«¯ï¼ˆå¦‚ OpenSearchï¼‰</td>
</tr>
<tr>
<td>Daemon</td>
<td>æ˜¯å¦ä»¥å®ˆæŠ¤è¿›ç¨‹ï¼ˆåå°ï¼‰æ¨¡å¼è¿è¡Œ, å®¹å™¨ç›¸å…³åœºæ™¯ä¸­è®¾ä¸º Off</td>
</tr>
<tr>
<td>Log_Level</td>
<td>Fluent Bit æœåŠ¡çš„æ—¥å¿—çº§åˆ«ï¼ˆ <code>debug/info/warn/error</code> ï¼‰</td>
</tr>
<tr>
<td>Parsers_File</td>
<td>æŒ‡å®šè§£æè§„åˆ™æ–‡ä»¶ï¼Œè¿™äº›è§„åˆ™ç”¨äºå°†åŸå§‹çš„å­—ç¬¦ä¸²æ—¥å¿—è§£æä¸ºç»“æ„åŒ–çš„ JSON å­—æ®µã€‚</td>
</tr>
<tr>
<td>HTTP_Server</td>
<td>ç›‘æ§æ¥å£ï¼Œå¯åŠ¨ä¸€ä¸ªå†…å»ºçš„è½»é‡çº§ HTTP æœåŠ¡ã€‚ <code>http://&lt;FLUENT_BIT_POD_IP&gt;:2020/api/v1/metrics</code> è·å–è¿è¡ŒæŒ‡æ ‡</td>
</tr>
<tr>
<td>storage.path</td>
<td>å¼€å¯ç£ç›˜ç¼“å­˜ã€‚æ–‡ä»¶ç³»ç»Ÿç¼“å†²ï¼ˆFilesystem Bufferingï¼‰ æœºåˆ¶ ï¼Œä¸»è¦ä½œç”¨æ˜¯é˜²æ­¢æ—¥å¿—ä¸¢å¤±ã€‚å¦‚æœ OpenSearch æš‚æ—¶æ— æ³•è¿æ¥ï¼ˆæ¯”å¦‚ç½‘ç»œæ³¢åŠ¨æˆ–æ­£åœ¨æ›´æ–°ï¼‰ï¼ŒFluent Bit ä¼šå°†æ—¥å¿—ä»å†…å­˜è½¬å­˜åˆ°ç£ç›˜ï¼Œç­‰æ¢å¤åå†è¡¥å‘ã€‚</td>
</tr>
<tr>
<td>storage.sync</td>
<td>å°†æ•°æ®åˆ·æ–°åˆ°ç£ç›˜çš„åŒæ­¥æ¨¡å¼<br/>- <code>normal</code>  ï¼Œä½¿ç”¨ç³»ç»Ÿçš„å†™ç¼“å­˜ï¼Œåœ¨ä¿è¯æ€§èƒ½çš„åŒæ—¶æä¾›åŸºæœ¬çš„æ•°æ®ä¿æŠ¤ã€‚ <br/>-  <code>full</code> ï¼Œåˆ™å¼ºåˆ¶æ¯æ¬¡å†™å…¥éƒ½åŒæ­¥åˆ°ç‰©ç†ç£ç›˜ï¼Œå®‰å…¨æ€§æœ€é«˜ä½† IO æ€§èƒ½æŸè€—æå¤§ã€‚ç”Ÿäº§ç¯å¢ƒé€šå¸¸æ¨è normalã€‚</td>
</tr>
<tr>
<td>storage.checksum</td>
<td>æ˜¯å¦å¯¹å­˜å‚¨çš„æ•°æ®å—è¿›è¡Œæ ¡éªŒå’Œï¼ˆChecksumï¼‰æ£€æŸ¥.<br/>å¼€å¯åï¼ˆonï¼‰å¯ä»¥æ£€æµ‹ç£ç›˜æ•°æ®æŸåï¼Œä½†ä¼šå¢åŠ  CPU å¼€é”€ã€‚å¦‚æœåº•å±‚å­˜å‚¨ä»‹è´¨ï¼ˆå¦‚ AWS EBS æˆ–èŠ‚ç‚¹æœ¬åœ°ç›˜ï¼‰æœ¬èº«éå¸¸å¯é ï¼Œé€šå¸¸è®¾ç½®ä¸º off ä»¥æå‡æ€§èƒ½ã€‚</td>
</tr>
<tr>
<td>storage.backlog.mem_limit</td>
<td>å¤„ç†ç§¯å‹æ•°æ®æ—¶çš„å†…å­˜é™åˆ¶ã€‚</td>
</tr>
</tbody></table>
<p>ç”Ÿäº§å»ºè®®ï¼š</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">storage.path              /var/log/flb-storage/</span><br><span class="line">storage.sync              normal</span><br><span class="line">storage.checksum          off</span><br><span class="line">storage.backlog.mem_limit 256M</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="INPUT-é…ç½®è¯¦è§£"><a href="#INPUT-é…ç½®è¯¦è§£" class="headerlink" title="INPUT é…ç½®è¯¦è§£"></a>INPUT é…ç½®è¯¦è§£</h2><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">[INPUT]</span><br><span class="line">    Name              tail</span><br><span class="line">    Path              /var/log/containers/*.log</span><br><span class="line">    Parser            docker</span><br><span class="line">    Tag               kube.*</span><br><span class="line">    Refresh_Interval  5</span><br><span class="line">    Mem_Buf_Limit     50MB</span><br><span class="line">    Skip_Long_Lines   On</span><br><span class="line">    DB                /var/log/flb_kube.db</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<table>
<thead>
<tr>
<th>å‚æ•°</th>
<th>ä½œç”¨</th>
</tr>
</thead>
<tbody><tr>
<td>Path</td>
<td>ç›‘å¬æ–‡ä»¶</td>
</tr>
<tr>
<td>Tag</td>
<td>æ‰“æ ‡ç­¾ï¼ˆåé¢åŒ¹é…ç”¨ï¼‰</td>
</tr>
<tr>
<td>Mem_Buf_Limit</td>
<td>é˜²æ­¢çˆ†å†…å­˜</td>
</tr>
<tr>
<td>DB</td>
<td>è®°å½•è¯»å–ä½ç½®ï¼ˆæ–­ç‚¹ç»­ä¼ ï¼‰</td>
</tr>
<tr>
<td>Skip_Long_Lines</td>
<td>å¦‚ä½•å¤„ç†è¶…è¿‡ç¼“å†²åŒºå¤§å°ï¼ˆé»˜è®¤é€šå¸¸ä¸º 32KBï¼‰çš„è¶…é•¿å•è¡Œæ—¥å¿—, é˜²æ­¢ Fluent Bit Pod å› ä¸ºå†…å­˜ä¸è¶³ï¼ˆOOMï¼‰è€Œå´©æºƒã€‚<br/> <code>On</code> : ä¸¢å¼ƒè¯¥è¡Œ <br/>å®ƒå— <code>Buffer_Chunk_Size</code> å’Œ <code>Buffer_Max_Size</code> çš„çº¦æŸ</td>
</tr>
</tbody></table>
<h2 id="FILTER-é…ç½®è¯¦è§£"><a href="#FILTER-é…ç½®è¯¦è§£" class="headerlink" title="FILTER é…ç½®è¯¦è§£"></a>FILTER é…ç½®è¯¦è§£</h2><p>Kubernetes å…ƒæ•°æ®å¢å¼ºé…ç½®ç¤ºä¾‹</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">[FILTER]</span><br><span class="line">    Name                kubernetes</span><br><span class="line">    Match               kube.*</span><br><span class="line">    Kube_URL            https://kubernetes.default.svc:443</span><br><span class="line">    Merge_Log           On</span><br><span class="line">    K8S-Logging.Parser  On</span><br><span class="line">    K8S-Logging.Exclude Off</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="OUTPUT-é…ç½®è¯¦è§£"><a href="#OUTPUT-é…ç½®è¯¦è§£" class="headerlink" title="OUTPUT é…ç½®è¯¦è§£"></a>OUTPUT é…ç½®è¯¦è§£</h2><p>è¾“å‡ºåˆ° Elasticsearch</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">[OUTPUT]</span><br><span class="line">    Name  es</span><br><span class="line">    Match kube.*</span><br><span class="line">    Host  elasticsearch.logging.svc</span><br><span class="line">    Port  9200</span><br><span class="line">    Index kube-logs</span><br><span class="line">    Logstash_Format On</span><br><span class="line">    Retry_Limit False</span><br><span class="line"></span><br></pre></td></tr></table></figure>
    </div>

    
    
    

    <footer class="post-footer">
          <div class="post-tags">
              <a href="../tags/AWS/" rel="tag"><i class="fa fa-tag"></i> AWS</a>
          </div>

        

          <div class="post-nav">
            <div class="post-nav-item">
                <a href="../20260212133320/" rel="prev" title="ArgoCD éƒ¨ç½²ä½¿ç”¨">
                  <i class="fa fa-chevron-left"></i> ArgoCD éƒ¨ç½²ä½¿ç”¨
                </a>
            </div>
            <div class="post-nav-item">
            </div>
          </div>
    </footer>
  </article>
</div>






    <div class="comments gitalk-container"></div>
</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">


<div class="copyright">
  &copy; 
  <span itemprop="copyrightYear">2026</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">COSMOS</span>
</div>
<div class="busuanzi-count">
    <span class="post-meta-item" id="busuanzi_container_site_uv">
      <span class="post-meta-item-icon">
        <i class="fa fa-user"></i>
      </span>
      <span class="site-uv" title="æ€»è®¿å®¢é‡">
        <span id="busuanzi_value_site_uv"></span>
      </span>
    </span>
    <span class="post-meta-item" id="busuanzi_container_site_pv">
      <span class="post-meta-item-icon">
        <i class="fa fa-eye"></i>
      </span>
      <span class="site-pv" title="æ€»è®¿é—®é‡">
        <span id="busuanzi_value_site_pv"></span>
      </span>
    </span>
</div>

    </div>
  </footer>

  
  <div class="reading-progress-bar"></div>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


  
  <script size="300" alpha="0.3" zIndex="-1" src="https://cdnjs.cloudflare.com/ajax/libs/ribbon.js/1.0.2/ribbon.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
<script src="../js/comments.js"></script><script src="../js/utils.js"></script><script src="../js/motion.js"></script><script src="../js/next-boot.js"></script>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/hexo-generator-searchdb/1.4.1/search.js" integrity="sha256-1kfA5uHPf65M5cphT2dvymhkuyHPQp5A53EGZOnOLmc=" crossorigin="anonymous"></script>
<script src="../js/third-party/search/local-search.js"></script>




  <script src="../js/third-party/pace.js"></script>

  
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>




<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/gitalk/1.8.0/gitalk.css" integrity="sha256-AJnUHL7dBv6PGaeyPQJcgQPDjt/Hn/PvYZde1iqfp8U=" crossorigin="anonymous">

<script class="next-config" data-name="gitalk" type="application/json">{"enable":true,"github_id":"fl9999","repo":"fl9999.github.io","client_id":"a11bf6f7860762b725b5","client_secret":"a99046105f8bddc72ec718d54dc3fd7f22070821","admin_user":"fl9999","distraction_free_mode":true,"proxy":"https://cors-anywhere.azm.workers.dev/https://github.com/login/oauth/access_token","language":null,"js":{"url":"https://cdnjs.cloudflare.com/ajax/libs/gitalk/1.8.0/gitalk.min.js","integrity":"sha256-MVK9MGD/XJaGyIghSVrONSnoXoGh3IFxLw0zfvzpxR4="},"path_md5":"d41d8cd98f00b204e9800998ecf8427e"}</script>
<script src="../js/third-party/comments/gitalk.js"></script>

</body>
</html>
